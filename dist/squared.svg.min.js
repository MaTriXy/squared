!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(((e=e||self).squared=e.squared||{},e.squared.svg={}))}(this,function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e){this.wrapped=e}function n(e){var t,n;function a(t,n){try{var s=e[t](n),o=s.value,u=o instanceof r;Promise.resolve(u?o.wrapped:o).then(function(e){u?a("next",e):i(s.done?"return":"normal",e)},function(e){a("throw",e)})}catch(e){i("throw",e)}}function i(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?a(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise(function(i,s){var o={key:e,arg:r,resolve:i,reject:s,next:null};n?n=n.next=o:(t=n=o,a(e,r))})},"function"!=typeof e.return&&(this.return=void 0)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}function v(e,t,r){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=h(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(r):a.value}})(e,t,r||e)}function m(e,t,r,n){return(m="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,r,n){var a,i=h(e,t);if(i){if((a=Object.getOwnPropertyDescriptor(i,t)).set)return a.set.call(n,r),!0;if(!a.writable)return!1}if(a=Object.getOwnPropertyDescriptor(n,t)){if(!a.writable)return!1;a.value=r,Object.defineProperty(n,t,a)}else o(n,t,r);return!0})(e,t,r,n)}function p(e,t,r,n,a){if(!m(e,t,r,n||e)&&a)throw Error("failed to set property");return r}"function"==typeof Symbol&&Symbol.asyncIterator&&(n.prototype[Symbol.asyncIterator]=function(){return this}),n.prototype.next=function(e){return this._invoke("next",e)},n.prototype.throw=function(e){return this._invoke("throw",e)},n.prototype.return=function(e){return this._invoke("return",e)};function y(e,t){return d(e)||function(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}(e,t)||k()}function g(e){return function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(e){if(Array.isArray(e))return e}function b(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function k(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var A=squared.lib.dom,S=squared.lib.util;function x(e,t,r){e.style[t]=r,e.setAttribute(t,r)}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"deg",r=parseFloat(e);switch(t){case"turn":r*=360;break;case"rad":r*=180/Math.PI}return r}function E(e){return e*Math.PI/180}var w={path:1,line:2,rect:3,ellipse:4,circle:5,polyline:6,polygon:7},V={clone:function(e){return{a:e.a,b:e.b,c:e.c,d:e.d,e:e.e,f:e.f}},rotate:function(e){var t=E(e),r=Math.cos(t),n=Math.sin(t);return{a:r,b:n,c:-1*n,d:r,e:0,f:0}},skew:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{a:1,b:Math.tan(E(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),c:Math.tan(E(e)),d:1,e:0,f:0}},scale:function(){return{a:arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,b:0,c:0,d:arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e:0,f:0}},translate:function(){return{a:1,b:0,c:0,d:1,e:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,f:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0}}},R={ZERO_ONE:"(0(?:\\.\\d+)?|1(?:\\.0+)?)",DECIMAL:"(-?[\\d.]+)",LENGTH:"([\\d.]+(?:[a-z]{2,}|%)?)",DEGREE:"(?:(-?[\\d.]+)(deg|rad|turn))"},M={MATRIX:"(matrix(?:3d)?)\\(".concat(R.DECIMAL,", ").concat(R.DECIMAL,", ").concat(R.DECIMAL,", ").concat(R.DECIMAL,", ").concat(R.DECIMAL,", ").concat(R.DECIMAL,"(?:, ").concat(R.DECIMAL,")?(?:, ").concat(R.DECIMAL,")?(?:, ").concat(R.DECIMAL,")?(?:, ").concat(R.DECIMAL,")?(?:, ").concat(R.DECIMAL,")?(?:, ").concat(R.DECIMAL,")?(?:, ").concat(R.DECIMAL,")?(?:, ").concat(R.DECIMAL,")?(?:, ").concat(R.DECIMAL,")?(?:, ").concat(R.DECIMAL,")?\\)"),ROTATE:"(rotate[XY]?)\\(".concat(R.DEGREE,"\\)"),SKEW:"(skew[XY]?)\\(".concat(R.DEGREE,"(?:, ").concat(R.DEGREE,")?\\)"),SCALE:"(scale[XY]?)\\(".concat(R.DECIMAL,"(?:, ").concat(R.DECIMAL,")?\\)"),TRANSLATE:"(translate[XY]?)\\(".concat(R.LENGTH,"(?:, ").concat(R.LENGTH,")?\\)")};function _(){return S.optionalAsNumber(squared,"settings.resolutionDPI")||96}function N(e){return parseInt(A.getStyle(e).fontSize||"16")}function O(e){var t=0,r=0;if(S.isNumber(e))t=parseInt(e);else if(/-?\d+ms$/.test(e))r=parseInt(e);else if(/-?\d+s$/.test(e))t=parseInt(e);else if(/-?\d+min$/.test(e))t=60*parseInt(e);else if(/-?\d+(.\d+)?h$/.test(e))t=60*parseFloat(e)*60;else{var n=/^(?:(-?)(\d?\d):)?(?:(\d?\d):)?(\d?\d)\.?(\d?\d?\d)?$/.exec(e);n&&(n[2]&&(t+=60*parseInt(n[2])*60),n[3]&&(t+=60*parseInt(n[3])),n[4]&&(t+=parseInt(n[4])),n[5]&&(r=parseInt(n[5])*(n[5].length<3?Math.pow(10,3-n[5].length):1)),n[1]&&(t*=-1,r*=-1))}return 1e3*t+r}var G={svg:function(e){return!!e&&"svg"===e.tagName},g:function(e){return!!e&&"g"===e.tagName},use:function(e){return!!e&&"use"===e.tagName},symbol:function(e){return!!e&&"symbol"===e.tagName},shape:function(e){return void 0!==w[e.tagName]},image:function(e){return"image"===e.tagName},path:function(e){return"path"===e.tagName},line:function(e){return"line"===e.tagName},rect:function(e){return"rect"===e.tagName},circle:function(e){return"circle"===e.tagName},ellipse:function(e){return"ellipse"===e.tagName},polygon:function(e){return"polygon"===e.tagName},polyline:function(e){return"polyline"===e.tagName},clipPath:function(e){return"clipPath"===e.tagName},linearGradient:function(e){return"linearGradient"===e.tagName},radialGradient:function(e){return"radialGradient"===e.tagName}};function C(e){var t=A.cssAttribute(e,"visibility",!0);return"hidden"!==t&&"collapse"!==t&&"none"!==A.cssAttribute(e,"display",!0)}function F(e,t){x(e,"display",t?"block":"none"),x(e,"visibility",t?"visible":"hidden")}function P(e,t){if(S.isNumber(t)){var r=parseFloat(""+t);r<=0?r=0:r>=1&&(r=1),e.style.opacity=""+r,e.setAttribute("opacity",""+r)}}function L(e,t){var r=e.attributes.getNamedItem("href");if(r&&"#"===r.value.charAt(0)){var n=r.value.substring(1);if(t)for(var a=Array.from(t.querySelectorAll("*")),i=0;i<a.length;i++){var s=a[i];if(s.id===n)return s instanceof SVGElement?s:null}else{var o=document.getElementById(n);if(o&&o instanceof SVGElement)return o}}return null}function B(e,t){return{type:e,matrix:t,angle:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,method:{x:!(arguments.length>3&&void 0!==arguments[3])||arguments[3],y:!(arguments.length>4&&void 0!==arguments[4])||arguments[4]}}}function I(e,t){var r=void 0===t?A.cssInline(e,"transform"):t;if(""!==r){var n=[];for(var a in M)for(var i=RegExp(M[a],"g"),s=null;null!==(s=i.exec(r));){var o=s[1].endsWith("X"),u=s[1].endsWith("Y");if(s[1].startsWith("rotate")){var l=T(s[2],s[3]),c=V.rotate(l);o?(c.a=1,c.b=0,c.c=0):u&&(c.b=0,c.c=0,c.d=1),n[s.index]=B(SVGTransform.SVG_TRANSFORM_ROTATE,c,l,!o,!u)}else if(s[1].startsWith("skew")){var f=u?0:T(s[2],s[3]),h=u?T(s[2],s[3]):s[4]&&s[5]?T(s[4],s[5]):0,v=V.skew(f,h);o?n[s.index]=B(SVGTransform.SVG_TRANSFORM_SKEWX,v,f,!0,!1):u?n[s.index]=B(SVGTransform.SVG_TRANSFORM_SKEWY,v,h,!1,!0):(n[s.index]=B(SVGTransform.SVG_TRANSFORM_SKEWX,Object.assign({},v,{b:0}),f,!0,!1),0!==h&&(n[s.index+1]=B(SVGTransform.SVG_TRANSFORM_SKEWY,Object.assign({},v,{c:0}),h,!1,!0)))}else if(s[1].startsWith("scale")){var m=u?void 0:parseFloat(s[2]),p=V.scale(m,o?void 0:u?parseFloat(s[2]):!o&&s[3]?parseFloat(s[3]):m);n[s.index]=B(SVGTransform.SVG_TRANSFORM_SCALE,p,0,!u,!o)}else if(s[1].startsWith("translate")){var y=_(),g=N(e),d=parseFloat(S.convertPX(s[2],y,g)),b=!o&&s[3]?parseFloat(S.convertPX(s[3],y,g)):0,k=V.translate(u?0:d,u?d:b);n[s.index]=B(SVGTransform.SVG_TRANSFORM_TRANSLATE,k,0)}else if(s[1].startsWith("matrix")){var x=X(e,t);x&&(n[s.index]=B(SVGTransform.SVG_TRANSFORM_MATRIX,x))}}return n.filter(function(e){return!!e&&(e.css=!0,!0)})}}function X(e,t){var r=RegExp(M.MATRIX).exec(t||A.getStyle(e,!0).transform||"");if(r)switch(r[1]){case"matrix":return{a:parseFloat(r[2]),b:parseFloat(r[3]),c:parseFloat(r[4]),d:parseFloat(r[5]),e:parseFloat(r[6]),f:parseFloat(r[7])};case"matrix3d":return{a:parseFloat(r[2]),b:parseFloat(r[3]),c:parseFloat(r[6]),d:parseFloat(r[7]),e:parseFloat(r[14]),f:parseFloat(r[15])}}}function D(e,t){var r={x:null,y:null};if(""!==(t=t||A.cssAttribute(e,"transform-origin"))){var n,a=e.parentElement,i=0,s=0;G.svg(a)&&a.viewBox?n=a.viewBox.baseVal:a instanceof SVGGraphicsElement&&G.svg(a.viewportElement)&&a.viewportElement.viewBox&&(n=a.viewportElement.viewBox.baseVal),n&&(i=n.width,s=n.height);var o=t.split(" ");1===o.length&&o.push("center"),(o=o.slice(0,2)).includes("left")?r.x=0:o.includes("right")&&(r.x=i),o.includes("top")?r.y=0:o.includes("bottom")&&(r.y=s),["x","y"].forEach(function(t){if(null===r[t])for(var n=0;n<o.length;n++){var a=o[n];if(""!==a&&("center"===a&&(a="50%"),S.isUnit(a)?r[t]=parseInt(a.endsWith("px")?a:S.convertPX(a,_(),N(e))):S.isPercent(a)&&(r[t]=("x"===t?i:s)*(parseInt(a)/100)),null!==r[t])){o[n]="";break}}})}return r.x=r.x||0,r.y=r.y||0,r}function j(e){switch(e){case"rotate":case SVGTransform.SVG_TRANSFORM_ROTATE:return"0 0 0";case"scale":case SVGTransform.SVG_TRANSFORM_SCALE:return"1 1";case"skewX":case"skewY":case SVGTransform.SVG_TRANSFORM_SKEWX:case SVGTransform.SVG_TRANSFORM_SKEWY:return"0";case"translate":case SVGTransform.SVG_TRANSFORM_TRANSLATE:return"0 0"}return""}function q(e){return e.sort(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?function(e,t){return e>t?-1:1}:function(e,t){return e<t?-1:1})}function z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if(e.length>1){var n=q(e.slice(0))[0];if(r)if(r.length===e.length)for(var a=0;a<r.length;a++)t=Math.max(t,r[a]+n);else r=void 0;void 0===r&&(t=Math.max(t,n));for(var i=t,s=!1;!s;)for(var o=0;o<e.length;o++){if((i-(r?r[o]:0))%e[o]!=0){s=!1,i+=n;break}s=!0}return i}return e[0]}function U(e,t,r){return e.a*t+e.c*r+e.e}function W(e,t,r){return e.b*t+e.d*r+e.f}function Y(e,t){return t*Math.cos(E(e))*-1}var K=Object.freeze({SHAPES:w,MATRIX:V,REGEXP_UNIT:R,getHostDPI:_,getFontSize:N,createElement:function(e){return document.createElementNS("http://www.w3.org/2000/svg",e)},convertClockTime:O,SVG:G,isVisible:C,setVisible:F,setOpacity:P,getTargetElement:L,createTransform:B,getTransform:I,getTransformMatrix:X,getTransformOrigin:D,getTransformRotate:function(e){var t=[],r=e.attributes.getNamedItem("transform");if(r)for(var n,a=/rotate\((-?[\d.]+),?\s*(-?[\d.]+),?\s*(-?[\d.]+)\)/g;null!==(n=a.exec(r.value));)t.push({angle:parseFloat(n[1]),x:parseFloat(n[2]),y:parseFloat(n[3])});return t.length?t:[{angle:0,x:0,y:0}]},getTransformInitialValue:j,sortNumber:q,getLeastCommonMultiple:z,applyMatrixX:U,applyMatrixY:W,getRadiusX:function(e,t){return t*Math.sin(E(e))},getRadiusY:Y}),H=squared.lib.util,Z=new Map,$=function(){function e(){a(this,e)}return s(e,null,[{key:"setName",value:function(e){if(e){var t,r="";if(H.isString(e.id)){var n=H.convertWord(e.id,!0);Z.has(n)||(r=n),t=n}else t=e.tagName;var a=Z.get(t)||0;return""!==r?(Z.set(r,a),r):(Z.set(t,++a),"".concat(t,"_").concat(a))}return Z.clear(),""}},{key:"instance",value:function(e){return!!e&&G.svg(e.element)}},{key:"instanceOfContainer",value:function(t){return e.instance(t)||e.instanceOfG(t)||e.instanceOfUseSymbol(t)}},{key:"instanceOfElement",value:function(t){return e.instanceOfShape(t)||e.instanceOfImage(t)||e.instanceOfUse(t)&&!e.instanceOfUseSymbol(t)}},{key:"instanceOfG",value:function(e){return!!e&&G.g(e.element)}},{key:"instanceOfUseSymbol",value:function(t){return e.instanceOfUse(t)&&void 0!==t.symbolElement}},{key:"instanceOfShape",value:function(t){return!!t&&G.shape(t.element)||e.instanceOfUse(t)&&void 0!==t.path}},{key:"instanceOfImage",value:function(t){return!!t&&G.image(t.element)||e.instanceOfUse(t)&&void 0!==t.imageElement}},{key:"instanceOfUse",value:function(e){return!!e&&G.use(e.element)}},{key:"instanceOfSet",value:function(e){return 0===e.instanceType}},{key:"instanceOfAnimate",value:function(e){return 1===e.instanceType}},{key:"instanceOfAnimateTransform",value:function(e){return 2===e.instanceType}},{key:"instanceOfAnimateMotion",value:function(e){return 3===e.instanceType}},{key:"getContainerOpacity",value:function(e){for(var t=parseFloat(e.opacity),r=e.parent;r;){var n=parseFloat(r.opacity||"1");!isNaN(n)&&n<1&&(t*=n),r=r.parent}return t}},{key:"getContainerViewBox",value:function(e){for(var t=e;t;)switch(t.element.tagName){case"svg":case"symbol":return t;default:t=t.parent}}},{key:"convertTransformList",value:function(e){for(var t=[],r=0;r<e.numberOfItems;r++){var n=e.getItem(r);t.push(B(n.type,n.matrix,n.angle))}return t}},{key:"filterTransforms",value:function(e,t){return(t?e.filter(function(e){return!t.includes(e.type)}):e).filter(function(e){return!(e.type===SVGTransform.SVG_TRANSFORM_SCALE&&1===e.matrix.a&&1===e.matrix.d)})}},{key:"applyTransforms",value:function(t,r,n,a){for(var i=e.clonePoints(r),s=t.slice(0).reverse(),o=Array.isArray(l=s),u=0,l=o?l:l[Symbol.iterator]();;){var c;if(o){if(u>=l.length)break;c=l[u++]}else{if((u=l.next()).done)break;c=u.value}var f=c,h=0,v=0,m=0,p=0,y=0,g=0;if(n)switch(f.type){case SVGTransform.SVG_TRANSFORM_SCALE:f.method.x&&(h+=n.x),f.method.y&&(p+=n.y);break;case SVGTransform.SVG_TRANSFORM_SKEWX:f.method.y&&(v-=n.y);break;case SVGTransform.SVG_TRANSFORM_SKEWY:f.method.x&&(m-=n.x);break;case SVGTransform.SVG_TRANSFORM_ROTATE:f.method.x&&(m-=n.x,y=n.x+Y(f.angle,n.x)),f.method.y&&(v-=n.y,g=n.y+Y(f.angle,n.y))}var d=f.matrix;if(a)switch(f.type){case SVGTransform.SVG_TRANSFORM_SCALE:a.x*=d.a,a.y*=d.d;break;case SVGTransform.SVG_TRANSFORM_ROTATE:0!==f.angle&&(a.angle=(a.angle||0)+f.angle);break;case SVGTransform.SVG_TRANSFORM_TRANSLATE:a.x+=d.e,a.y+=d.f}for(var b=Array.isArray(A=i),k=0,A=b?A:A[Symbol.iterator]();;){var S;if(b){if(k>=A.length)break;S=A[k++]}else{if((k=A.next()).done)break;S=k.value}var x=S,T=x.x;if(x.x=U(d,T+h,x.y+v)+y,x.y=W(d,T+m,x.y+p)+g,f.type===SVGTransform.SVG_TRANSFORM_SCALE&&void 0!==x.rx&&void 0!==x.ry){var E=x.rx;x.rx=U(d,E+h,x.ry+v),x.ry=W(d,E+m,x.ry+p)}}}return i}},{key:"getCenterPoint",value:function(e){var t=e.map(function(e){return e.x}),r=e.map(function(e){return e.y});return{x:(H.minArray(t)+H.maxArray(t))/2,y:(H.minArray(r)+H.maxArray(r))/2}}},{key:"clonePoints",value:function(e){var t=[];if(Array.isArray(e))for(var r=Array.isArray(a=e),n=0,a=r?a:a[Symbol.iterator]();;){var i;if(r){if(n>=a.length)break;i=a[n++]}else{if((n=a.next()).done)break;i=n.value}var s=i,o={x:s.x,y:s.y};void 0!==s.rx&&void 0!==s.ry&&(o.rx=s.rx,o.ry=s.ry),t.push(o)}else for(var u=0;u<e.numberOfItems;u++){var l=e.getItem(u);t.push({x:l.x,y:l.y})}return t}},{key:"fromNumberList",value:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push({x:e[r],y:e[r+1]});return t.length%2==0?t:[]}},{key:"toNumberList",value:function(e){for(var t,r=[],n=/-?[\d.]+/g;null!==(t=n.exec(e));){var a=parseFloat(t[0]);isNaN(a)||r.push(a)}return r}},{key:"getPathPoints",value:function(e){for(var t=[],r=0,n=0,a=0;a<e.length;a++){for(var i=e[a],s=0;s<i.coordinates.length;s+=2){i.relative?(r+=i.coordinates[s],n+=i.coordinates[s+1]):(r=i.coordinates[s],n=i.coordinates[s+1]);var o={x:r,y:n};"A"===i.command.toUpperCase()&&(o.rx=i.radiusX,o.ry=i.radiusY),t.push(o)}if(i.relative){switch(i.command){case"h":case"v":var u,l=e[a-1];if(l&&"M"===l.command)(u=l.coordinates).push.apply(u,g(i.coordinates)),e.splice(a,1),a--;i.command="M";break;default:i.command=i.command.toUpperCase()}i.relative=!1}}return t}},{key:"rebindPathPoints",value:function(e,t){var r=t.slice(0);e:for(var n=Array.isArray(i=e),a=0,i=n?i:i[Symbol.iterator]();;){var s;if(n){if(a>=i.length)break;s=i[a++]}else{if((a=i.next()).done)break;s=a.value}var o=s;switch(o.command.toUpperCase()){case"M":case"L":case"H":case"V":case"C":case"S":case"Q":case"T":for(var u=0;u<o.coordinates.length;u+=2){var l=r.shift();if(!l){e=[];break e}o.coordinates[u]=l.x,o.coordinates[u+1]=l.y}break;case"A":var c=r.shift();if(!c||void 0===c.rx||void 0===c.ry){e=[];break e}o.coordinates[0]=c.x,o.coordinates[1]=c.y,o.radiusX=c.rx,o.radiusY=c.ry}}return e}},{key:"fromPathCommandList",value:function(e){for(var t="",r=Array.isArray(a=e),n=0,a=r?a:a[Symbol.iterator]();;){var i;if(r){if(n>=a.length)break;i=a[n++]}else{if((n=a.next()).done)break;i=n.value}var s=i;switch(t+=(""!==t?" ":"")+s.command,s.command.toUpperCase()){case"M":case"L":case"C":case"S":case"Q":case"T":t+=s.coordinates.join(",");break;case"H":t+=s.coordinates[0];break;case"V":t+=s.coordinates[1];break;case"A":t+="".concat(s.radiusX,",").concat(s.radiusY,",").concat(s.xAxisRotation,",").concat(s.largeArcFlag,",").concat(s.sweepFlag,",").concat(s.coordinates.join(","))}}return t}},{key:"toPathCommandList",value:function(t){var r,n=[],a=/([A-Za-z])([^A-Za-z]+)?/g;for(t=t.trim();null!==(r=a.exec(t))&&(0!==n.length||"M"===r[1].toUpperCase());){r[2]=(r[2]||"").trim();var i=e.toNumberList(r[2]),s=n[n.length-1],o=s?s.command.toUpperCase():"",u=s?s.points[s.points.length-1]:void 0,l=void 0,c=void 0,f=void 0,h=void 0,v=void 0;switch(r[1].toUpperCase()){case"M":0===n.length&&(r[1]="M");case"L":if(i.length>=2){i.length%2!=0&&i.length--;break}continue;case"H":if(u&&i.length){i[1]="h"===r[1]?0:u.y,i.length=2;break}continue;case"V":if(u&&i.length){var m=i[0];i[0]="v"===r[1]?0:u.x,i[1]=m,i.length=2;break}continue;case"Z":if(n.length){i.push.apply(i,g(n[0].coordinates.slice(0,2))),r[1]="Z";break}continue;case"C":if(i.length>=6){i.length=6;break}continue;case"S":if(i.length>=4&&("C"===o||"S"===o)){i.length=4;break}continue;case"Q":if(i.length>=4){i.length=4;break}continue;case"T":if(i.length>=2&&("Q"===o||"T"===o)){i.length=2;break}continue;case"A":if(i.length>=7){var p=y(i.splice(0,5),5);l=p[0],c=p[1],f=p[2],h=p[3],v=p[4],i.length=2;break}continue;default:continue}if(i.length>1){for(var d=[],b=/[a-z]/.test(r[1]),k=0;k<i.length;k+=2){var A=i[k],S=i[k+1];b&&u&&(u={x:A+=u.x,y:S+=u.y}),d.push({x:A,y:S})}n.push({command:r[1],relative:b,coordinates:i,points:d,radiusX:l,radiusY:c,xAxisRotation:f,largeArcFlag:h,sweepFlag:v})}}return n}}]),e}(),Q=squared.lib.dom,J=function(e){return function(t){function r(){var e;return a(this,r),(e=f(this,l(r).apply(this,arguments)))._baseVal={},e}return u(r,e),s(r,[{key:"setBaseValue",value:function(e,t){if(void 0!==t){if(this.validateType(e,t))return this._baseVal[e]=t,!0}else switch(e){case"d":return this._baseVal[e]=Q.cssAttribute(this.element,"d"),!0;case"points":var r=this.element[e];if(Array.isArray(r))return this._baseVal[e]=$.clonePoints(r),!0;break;default:var n=this.element[e];if(n&&n.baseVal)return this._baseVal[e]=n.baseVal.value,!0}return!1}},{key:"getBaseValue",value:function(e,t){return void 0!==this._baseVal[e]||this.setBaseValue(e)?this._baseVal[e]:t}},{key:"validateType",value:function(e,t){switch(e){case"d":return"string"==typeof t;case"cx":case"cy":case"r":case"rx":case"ry":case"x1":case"x2":case"y1":case"y2":case"x":case"y":case"width":case"height":return"number"==typeof t;case"points":return Array.isArray(t)}return!1}}]),r}()},ee=squared.lib.util,te=function(){function e(t){if(a(this,e),this.attributeName="",this.to="",this.begin=[0],this.duration=-1,this.paused=!1,t){this.element=t,this.setAttribute("attributeName"),this.setAttribute("to");var r=this.getAttribute("begin");"indefinite"===r?this.begin.length=0:/^[a-zA-Z]+$/.test(r)?this.paused=!0:""!==r&&(this.begin=q(r.split(";").map(function(e){return O(e)})));var n=this.getAttribute("dur");n&&"indefinite"!==n&&(this.duration=O(n))}}return s(e,[{key:"setAttribute",value:function(e,t){var r=this.getAttribute(e);r&&(void 0!==t?this[e+ee.capitalize(t)]=r===t:this[e]=r)}},{key:"getAttribute",value:function(e){var t=this.element&&this.element.attributes.getNamedItem(e);return t?t.value.trim():""}},{key:"delay",set:function(e){this.begin[0]=e},get:function(){return this.begin[0]||0}},{key:"instanceType",get:function(){return 0}}]),e}(),re={ease:"0.25 0.1 0.25 1","ease-in":"0.42 0 1 1","ease-in-out":"0.42 0 0.58 1","ease-out":"0 0 0.58 1",linear:"0 0 1 1",step:"0 1 0 1"},ne=Object.freeze({KEYSPLINE_NAME:re}),ae=squared.lib.color,ie=squared.lib.dom,se=squared.lib.util;function oe(e,t,r){return e+(t-e)*r}function ue(e){return parseFloat((1-e).toFixed(5))}var le=function(e){function r(e){var t;if(a(this,r),(t=f(this,l(r).call(this,e))).element=e,t.from="",t.by="",t.values=[],t.keyTimes=[],t.repeatDuration=-1,t.additiveSum=!1,t.accumulateSum=!1,t.fillMode=0,t.alternate=!1,t._repeatCount=1,t._reverse=!1,e){var n,i,s=t.getAttribute("values"),o=t.getAttribute("keyTimes");if(""!==s&&""!==o)(n=t.values).push.apply(n,g(se.flatMap(s.split(";"),function(e){return e.trim()}))),(i=t.keyTimes).push.apply(i,g(r.toFractionList(o))),t.values.length>1&&t.keyTimes.length===t.values.length?(0===t.keyTimes[0]&&(t.from=t.values[0]),t.to=t.values[t.values.length-1]):(t.values.length=0,t.keyTimes.length=0);var u=t.getAttribute("from");if(0===t.values.length&&""!==t.to){if(""!==u)t.from=u;else if("transform"===t.attributeName)t.from=j(t.getAttribute("type"));else if(e.parentElement){var c=se.optionalAsString(e.parentElement,"".concat(t.attributeName,".baseVal.value"));t.from=""!==c?c:ie.cssAttribute(e.parentElement,t.attributeName)}t.values.push(t.from,t.to),t.keyTimes.push(0,1),t.setAttribute("by")}""===s&&""!==u&&""!==t.to&&(t.setAttribute("additive","sum"),t.additiveSum&&t.setAttribute("accumulate","sum"));var h=t.getAttribute("repeatDur");h&&"indefinite"!==h&&(t.repeatDuration=O(h));var v=t.getAttribute("repeatCount");if(t.repeatCount="indefinite"===v?-1:parseFloat(v),t.begin.length){var m=t.getAttribute("end");if(""!==m){var p=q(m.split(";").map(function(e){return O(e)}));!p.length||1!==t.begin.length&&t.begin[t.begin.length-1]===t.end&&0!==p[0]||(t.end=p[0],t.begin=t.begin.filter(function(e){return e>=0&&e<p[0]}),t.begin.length&&-1===t.repeatCount&&(t.repeatCount=t.end/t.duration))}}"animate"===e.tagName&&t.setCalcMode(t.attributeName)}return t}return u(r,te),s(r,[{key:"setCalcMode",value:function(e){var n=this;if(this.element){var a=function(){switch(n.getAttribute("calcMode")){case"discrete":for(var t=[],a=[],i=[],s=0;s<n.keyTimes.length-1;s++){var o=r.toStepFractionList(e,"steps-start",s,n.keyTimes,n.values,_(),N(n.element));if(!o)return{v:void 0};t.push.apply(t,g(o[0])),a.push.apply(a,g(o[1])),o[0].forEach(function(){return i.push(re.step)})}t.push(n.keyTimes.pop()),a.push(n.values.pop()),n.keyTimes=t,n.values=a,n._keySplines=i;break;case"spline":n.keySplines=se.flatMap(n.getAttribute("keySplines").split(";"),function(e){return e.trim()})}}();if("object"===t(a))return a.v}}},{key:"repeatCount",set:function(e){(isNaN(e)?this._repeatCount=1:(this._repeatCount=e,-1!==e&&(this.repeatDuration=-1)),this.element)&&("freeze"===this.getAttribute("fill")&&-1!==this.repeatCount?this.fillMode|=8:se.hasBit(this.fillMode,8)&&(this.fillMode^=8))},get:function(){var e=this.duration;return-1!==e?-1===this._repeatCount&&-1===this.repeatDuration?-1:-1!==this._repeatCount&&-1!==this.repeatDuration?this._repeatCount*e<=this.repeatDuration?this._repeatCount:this.repeatDuration/e:-1!==this.repeatDuration?this.repeatDuration/e:this._repeatCount:1}},{key:"keySplines",set:function(e){if(e){var t=this.keyTimes.length-1;if(t>0&&e.length>=t&&!e.every(function(e){return""===e})){for(var r=[],n=0;n<t;n++){var a=e[n].split(" ").map(function(e){return parseFloat(e)});4===a.length&&!a.some(function(e){return isNaN(e)})&&a[0]>=0&&a[0]<=1&&a[2]>=0&&a[2]<=1?r.push(a.join(" ")):r.push(re.linear)}this._keySplines=r}}else this._keySplines=void 0},get:function(){return this._keySplines}},{key:"reverse",set:function(e){if(e!==this._reverse&&this.values.length){if(this.values.reverse(),this._keySplines){for(var t=[],r=this._keySplines.length-1;r>=0;r--){var n=this._keySplines[r].split(" ").map(function(e){return parseFloat(e)});t.push(4===n.length?"".concat(ue(n[2])," ").concat(ue(n[3])," ").concat(ue(n[0])," ").concat(ue(n[1])):re.linear)}this._keySplines=t}this._reverse=e}},get:function(){return this._reverse}},{key:"fromToType",get:function(){return 2===this.keyTimes.length&&0===this.keyTimes[0]&&1===this.keyTimes[1]}},{key:"instanceType",get:function(){return 1}}],[{key:"toStepFractionList",value:function(e,t,r,n,a){var i,s,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:96,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:16;switch(e){case"fill":case"stroke":var l=ae.parseRGBA(a[r]),c=ae.parseRGBA(a[r+1]);l&&c&&(i=[l],s=[c]);break;case"points":i=$.fromNumberList($.toNumberList(a[r])),s=$.fromNumberList($.toNumberList(a[r+1]));break;case"rotate":case"scale":case"translate":i=a[r].trim().split(/\s+/).map(function(e){return parseFloat(e)}),s=a[r+1].trim().split(/\s+/).map(function(e){return parseFloat(e)});break;default:se.isNumber(a[r])?i=[parseFloat(a[r])]:se.isUnit(a[r])&&(i=[parseFloat(se.convertPX(a[r],o,u))]),se.isNumber(a[r+1])?s=[parseFloat(a[r+1])]:se.isUnit(a[r+1])&&(s=[parseFloat(se.convertPX(a[r+1],o,u))])}if(i&&s&&i.length&&i.length===s.length){switch(t){case"steps-start":t="steps(1, start)";break;case"steps-end":t="steps(1, end)"}var f=/steps\((\d+)(?:, (start|end))?\)/.exec(t);if(f){for(var h=n[r+1]-n[r],v=parseInt(f[1]),m=100/v,p=[],y=[],g=0,d="start"===f[2]?1:0;g<v;g++){var b=n[r]+h*(g/v),k=[],A=(d>0&&g===v-1?100:m*(g+d))/100;switch(e){case"fill":case"stroke":var S=i[0],x=s[0],T=ae.convertHex(oe(S.rgba.r,x.rgba.r,A)),E=ae.convertHex(oe(S.rgba.g,x.rgba.g,A)),w=ae.convertHex(oe(S.rgba.b,x.rgba.b,A)),V=ae.convertHex(oe(S.rgba.a,x.rgba.a,A));k.push("#".concat(T+E+w+("FF"!==V?V:"")));break;case"points":for(var R=0;R<i.length;R++){var M=i[R],_=s[R];k.push("".concat(oe(M.x,_.x,A),",").concat(oe(M.y,_.y,A)))}break;default:for(var N=0;N<i.length;N++){k.push(""+oe(i[N],s[N],A))}}if(!k.length)return;p.push(b),y.push(k.join(" "))}return[p,y]}}}},{key:"toFractionList",value:function(e){var t=-1,r=se.flatMap(e.split(arguments.length>1&&void 0!==arguments[1]?arguments[1]:";"),function(e){var r=parseFloat(e);return!isNaN(r)&&r<=1&&(-1===t||r>t)?(t=r,r):-1});return r.length>1&&r.some(function(e){return-1!==e})&&0===r[0]?r:[]}}]),r}(),ce=function(e){function t(e){var r;if(a(this,t),(r=f(this,l(t).call(this,e))).element=e,r.type=0,e){var n=r.getAttribute("type");r.setType(n),r.setCalcMode(n)}return r}return u(t,le),s(t,[{key:"setType",value:function(e){switch(e){case"translate":this.type=SVGTransform.SVG_TRANSFORM_TRANSLATE;break;case"scale":this.type=SVGTransform.SVG_TRANSFORM_SCALE;break;case"rotate":this.type=SVGTransform.SVG_TRANSFORM_ROTATE;break;case"skewX":this.type=SVGTransform.SVG_TRANSFORM_SKEWX;break;case"skewY":this.type=SVGTransform.SVG_TRANSFORM_SKEWY}}},{key:"instanceType",get:function(){return 2}}],[{key:"toRotateList",value:function(e){var t=e.map(function(e){if(""===e)return[null,null,null];var t=$.toNumberList(e);return 1===t.length||3===t.length?t:[]});return t.some(function(e){return 0===e.length})?void 0:t}},{key:"toScaleList",value:function(e){var t=e.map(function(e){if(""===e)return[null,null];var t=$.toNumberList(e);return 1===t.length?[t[0],t[0]]:2===t.length?t:[]});return t.some(function(e){return 0===e.length})?void 0:t}},{key:"toTranslateList",value:function(e){var t=null,r=e.map(function(e){if(""===e)return[null,null];var r=$.toNumberList(e);return 1===r.length?[r[0],t]:2===r.length?(t=r[1],r):[]});return r.some(function(e){return 0===e.length})?void 0:r}}]),t}(),fe=squared.lib.color,he=squared.lib.dom,ve=squared.lib.util,me=function(e){return function(t){function r(){var e;return a(this,r),(e=f(this,l(r).apply(this,arguments))).fill="black",e.fillPattern="",e.fillOpacity="1",e.fillRule="nonzero",e.stroke="",e.strokeWidth="1",e.strokePattern="",e.strokeOpacity="1",e.strokeLinecap="butt",e.strokeLinejoin="miter",e.strokeMiterlimit="4",e.strokeDashArray="",e.strokeDashOffset="0",e.color="",e.clipPath="",e.clipRule="",e.parentElement=null,e}return u(r,e),s(r,[{key:"setPaint",value:function(){this.setAttribute("color"),this.setColor("fill"),this.setAttribute("fill-opacity"),this.setAttribute("fill-rule"),this.setColor("stroke"),this.setAttribute("stroke-opacity"),this.setAttribute("stroke-width"),this.setAttribute("stroke-linecap"),this.setAttribute("stroke-linejoin"),this.setAttribute("stroke-miterlimit"),this.setAttribute("stroke-dasharray"),this.setAttribute("stroke-dashoffset");var e=ve.REGEXP_PATTERN.CSS_URL.exec(this.getAttribute("clip-path"));e&&(this.clipPath=e[1]),this.setAttribute("clip-rule")}},{key:"setColor",value:function(e){var t=this.element,r=this.getAttribute(e),n=ve.REGEXP_PATTERN.CSS_URL.exec(r);if(n)this["".concat(e,"Pattern")]=n[1],r="";else if(""!==r)switch(r.toLowerCase()){case"none":case"transparent":case"rgba(0, 0, 0, 0)":r="";break;case"currentcolor":var a=fe.parseRGBA(this.color||he.cssAttribute(t,e,!0));r=a?a.valueRGB:null;break;default:var i=fe.parseRGBA(r);i&&(r=i.valueRGB)}else"fill"===e&&(r=null);null!==r&&(this[e]=r)}},{key:"setAttribute",value:function(e){var t=this.getAttribute(e);""!==t&&(this[ve.convertCamelCase(e)]=t)}},{key:"getAttribute",value:function(e){return he.cssAttribute(this.element,e)||(this.parentElement?he.cssAttribute(this.parentElement,e):"")}}]),r}()},pe=function(){function e(t){a(this,e),this.element=t}return s(e,[{key:"build",value:function(e,t){}},{key:"synchronize",value:function(e){}}]),e}(),ye=function(e){function t(e,r){var n;return a(this,t),(n=f(this,l(t).call(this,e))).element=e,n.name="",n.value="",n.transformed=null,r?n.parentElement=r:(G.g(e.parentElement)||G.use(e.parentElement))&&(n.parentElement=e.parentElement),n.init(),n}return u(t,me(J(pe))),s(t,[{key:"draw",value:function(e,r){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=this.element,i="";n&&(this.transformed=null);var s=this.parent;if(G.path(a)){if(i=this.getBaseValue("d"),s&&1!==s.aspectRatio.unit||e&&e.length){var o=$.toPathCommandList(i);if(o.length){var u=$.getPathPoints(o);if(u.length){if(e&&e.length){if("function"==typeof r){var l=y(r.call(this,a,e),2);this.transformResidual=l[0],e=l[1]}e.length&&(u=this.transformPoints(e,u),this.transformed=e)}s&&s.refitPoints(u),i=$.fromPathCommandList($.rebindPathPoints(o,u))}}}}else if(G.line(a)){var c=[{x:this.getBaseValue("x1"),y:this.getBaseValue("y1")},{x:this.getBaseValue("x2"),y:this.getBaseValue("y2")}];if(e&&e.length){if("function"==typeof r){var f=y(r.call(this,a,e),2);this.transformResidual=f[0],e=f[1]}e.length&&(c=this.transformPoints(e,c),this.transformed=e)}s&&s.refitPoints(c),i=t.getPolyline(c)}else if(G.circle(a)||G.ellipse(a)){var h,v;G.ellipse(a)?(h=this.getBaseValue("rx"),v=this.getBaseValue("ry")):v=h=this.getBaseValue("r");var m=[{x:this.getBaseValue("cx"),y:this.getBaseValue("cy"),rx:h,ry:v}];if(e&&e.length){if("function"==typeof r){var p=y(r.call(this,a,e,h,v),2);this.transformResidual=p[0],e=p[1]}e.length&&(m=this.transformPoints(e,m),this.transformed=e)}s&&s.refitPoints(m);var g=m[0];i=t.getEllipse(g.x,g.y,g.rx,g.ry)}else if(G.rect(a)){var d=this.getBaseValue("x"),b=this.getBaseValue("y"),k=this.getBaseValue("width"),A=this.getBaseValue("height");if(e&&e.length){var S=[{x:d,y:b},{x:d+k,y:b},{x:d+k,y:b+A},{x:d,y:b+A}];if("function"==typeof r){var x=y(r.call(this,a,e),2);this.transformResidual=x[0],e=x[1]}e.length&&(S=this.transformPoints(e,S),this.transformed=e),s&&s.refitPoints(S),i=t.getPolygon(S)}else s&&(d=s.refitX(d),b=s.refitY(b),k=s.refitSize(k),A=s.refitSize(A)),i=t.getRect(k,A,d,b)}else if(G.polygon(a)||G.polyline(a)){var T=this.getBaseValue("points");if(e&&e.length){if("function"==typeof r){var E=y(r.call(this,a,e),2);this.transformResidual=E[0],e=E[1]}e.length&&(T=this.transformPoints(e,T),this.transformed=e)}s&&s.refitPoints(T),i="polygon"===a.tagName?t.getPolygon(T):t.getPolyline(T)}return n&&(this.value=i),i}},{key:"transformPoints",value:function(e,t,r){return $.applyTransforms(e,t,D(this.element),r)}},{key:"init",value:function(){var e=this.element;G.path(e)?this.setBaseValue("d"):G.line(e)?(this.setBaseValue("x1"),this.setBaseValue("y1"),this.setBaseValue("x2"),this.setBaseValue("y2")):G.rect(e)?(this.setBaseValue("x"),this.setBaseValue("y"),this.setBaseValue("width"),this.setBaseValue("height")):G.circle(e)?(this.setBaseValue("cx"),this.setBaseValue("cy"),this.setBaseValue("r")):G.ellipse(e)?(this.setBaseValue("cx"),this.setBaseValue("cy"),this.setBaseValue("rx"),this.setBaseValue("ry")):(G.polygon(e)||G.polyline(e))&&this.setBaseValue("points",$.clonePoints(e.points)),this.setPaint()}},{key:"transform",get:function(){return void 0===this._transform&&(this._transform=I(this.element)||$.convertTransformList(this.element.transform.baseVal)),this._transform}}],[{key:"getLine",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return"M".concat(e,",").concat(t," L").concat(r,",").concat(n)}},{key:"getCircle",value:function(e,r,n){return t.getEllipse(e,r,n)}},{key:"getEllipse",value:function(e,t,r,n){return void 0===n&&(n=r),"M".concat(e-r,",").concat(t," a").concat(r,",").concat(n,",0,1,0,").concat(2*r,",0 a").concat(r,",").concat(n,",0,1,0,-").concat(2*r,",0")}},{key:"getRect",value:function(e,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return"M".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,",").concat(r," h").concat(e," v").concat(t," h").concat(-e," Z")}},{key:"getPolygon",value:function(e){var r=t.getPolyline(e);return""!==r?r+" Z":""}},{key:"getPolyline",value:function(e){return e.length?"M".concat(e.map(function(e){return"".concat(e.x,",").concat(e.y)}).join(" ")):""}}]),t}(),ge=squared.lib.util;function de(e,t,r){var n,a,i=e.entries(),s=Array.isArray(i),o=0;for(i=s?i:i[Symbol.iterator]();;){var u;if(s){if(o>=i.length)break;u=i[o++]}else{if((o=i.next()).done)break;u=o.value}var l=y(u,2),c=l[0],f=l[1];if(n&&r<=c){a={ordinal:c,value:f};break}r>=c&&(n={ordinal:c,value:f})}if(n&&a){var h=Te(r,n.ordinal,a.ordinal,n.value,a.value);t.set(r,h)}else n&&t.set(r,n.value)}function be(e,t){var r=new Map,n=e.entries(),a=Array.isArray(n),i=0;for(n=a?n:n[Symbol.iterator]();;){var s;if(a){if(i>=n.length)break;s=n[i++]}else{if((i=n.next()).done)break;s=i.value}var o=y(s,2),u=o[1],l=o[0]/t;if(l>0)for(var c=5;;c++){var f=parseFloat((""+l).substring(0,c));if(!r.has(f)){l=f;break}}r.set(l,u)}return r}function ke(e,r,n,a){var i,s=[],o=r.element.tagName;switch(o){case"line":i=["x1","y1","x2","y2"];break;case"rect":i=["width","height","x","y"];break;case"polyline":case"polygon":i=["points"];break;case"circle":i=["cx","cy","r"];break;case"ellipse":i=["cx","cy","rx","ry"];break;default:return}var u=function(){if(c){if(f>=l.length)return"break";h=l[f++]}else{if((f=l.next()).done)return"break";h=f.value}var e,t=y(h,2),u=t[0],v=t[1],m=[];if(i.forEach(function(e){var t=v.get(e);void 0!==t?m.push(t):a&&a[e]?m.push(a[e].value):void 0!==(t=r.getBaseValue(e))&&m.push(t)}),m.length!==i.length)return{v:void 0};switch(o){case"line":e=function(e){return[{x:e[0],y:e[1]},{x:e[2],y:e[4]}]}(m);break;case"rect":e=function(e){var t=e[0],r=e[1],n=e[2],a=e[3];return[{x:n,y:a},{x:n+t,y:a},{x:n+t,y:a+r},{x:n,y:a+r}]}(m);break;case"polygon":case"polyline":e=m[0];break;case"circle":case"ellipse":e=function(e){return[{x:e[0],y:e[1],rx:e[2],ry:e[e.length-1]}]}(m)}if(e){var p;switch(r.transformed&&r.transformed.length&&(e=$.applyTransforms(r.transformed,e,D(r.element))),n&&n.refitPoints(e),o){case"line":case"polyline":p=ye.getPolyline(e);break;case"rect":case"polygon":p=ye.getPolygon(e);break;case"circle":case"ellipse":var g=e[0];p=ye.getEllipse(g.x,g.y,g.rx,g.ry)}void 0!==p&&s.push({ordinal:u,value:p})}};var l=e.entries(),c=Array.isArray(l),f=0;e:for(l=c?l:l[Symbol.iterator]();;){var h,v=u();switch(v){case"break":break e;default:if("object"===t(v))return v.v}}return s}function Ae(e,t,r){for(var n=new Map,a=Array.isArray(s=t),i=0,s=a?s:s[Symbol.iterator]();;){var o;if(a){if(i>=s.length)break;o=s[i++]}else{if((i=s.next()).done)break;o=i.value}var u=o,l=new Map;for(var c in e){var f=e[c].get(u);void 0!==f&&l.set(c,f)}if(r)for(var h in r)!l.has(h)&&u>=r[h].ordinal&&l.set(h,r[h].value);n.set(u,l)}return n}function Se(e,t,r,n,a){return Math.round(e+(r[a]+n)*t)}function xe(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=e.alternate&&n%2!=0?e.values.slice(0).reverse():e.values;if("number"==typeof r){var i=parseFloat(a[t]);if(e.additiveSum){i+=r,e.accumulateSum||(n=0);for(var s=0;s<n;s++)for(var o=0;o<a.length;o++)i+=parseFloat(a[o])}return i}var u=[];return a[t].trim().split(/\s+/).forEach(function(e){var t=y(e.split(",").map(function(e){return parseFloat(e)}),2);u.push({x:t[0],y:t[1]})}),u}function Te(e,t,r,n,a){if("number"==typeof n&&"number"==typeof a)return n+(e-t)/(r-t)*(a-n);if(Array.isArray(n)&&Array.isArray(a)){for(var i=[],s=0;s<Math.min(n.length,a.length);s++)i.push({x:Te(e,t,r,n[s].x,a[s].x),y:Te(e,t,r,n[s].y,a[s].y)});return i}return n}function Ee(e){return!e.paused&&e.begin.length>0&&e.keyTimes.length>1&&e.duration>0}function we(e){return-1!==e.repeatCount?e.duration*e.repeatCount:Number.MAX_VALUE}function Ve(e){return e.duration*(-1!==e.repeatCount?e.repeatCount:1)}var Re=function(e){return function(r){function n(){return a(this,n),f(this,l(n).apply(this,arguments))}return u(n,e),s(n,[{key:"getAnimateShape",value:function(){for(var e=this.element,t=[],r=Array.isArray(a=this.animation),n=0,a=r?a:a[Symbol.iterator]();;){var i;if(r){if(n>=a.length)break;i=a[n++]}else{if((n=a.next()).done)break;i=n.value}var s=i;if(Ee(s))switch(s.attributeName){case"r":case"cx":case"cy":if(G.circle(e)){t.push(s);break}case"rx":case"ry":G.ellipse(e)&&t.push(s);break;case"x1":case"x2":case"y1":case"y2":G.line(e)&&t.push(s);break;case"points":(G.polyline(e)||G.polygon(e))&&t.push(s);break;case"x":case"y":case"width":case"height":G.rect(e)&&t.push(s)}}return t}},{key:"getAnimateViewRect",value:function(){for(var e=[],t=Array.isArray(n=this.animation),r=0,n=t?n:n[Symbol.iterator]();;){var a;if(t){if(r>=n.length)break;a=n[r++]}else{if((r=n.next()).done)break;a=r.value}var i=a;if(Ee(i))switch(i.attributeName){case"x":case"y":e.push(i)}}return e}},{key:"mergeAnimate",value:function(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;(e.length>1||e.some(function(e){return e.begin.length>1||!e.fromToType||e.alternate||void 0!==e.end||e.additiveSum}))&&function(){for(var i=function(e,t,r,n,a,i,o){for(var u,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=(o-(a+r.duration*i))/r.duration,f=r.keyTimes,h=-1,v=-1,m=0;m<f.length;m++){if(-1!==h&&c<=f[m]){v=m;break}c>=f[m]&&(h=m)}u=-1!==h&&-1!==v?Te(c,f[h],f[v],xe(r,h,n,i),xe(r,v,n,i)):xe(r,v=-1!==h?h+1:f.length-1,n,i);var p=o+l;if(e.get(p)!==u){for(;e.has(p);)p++;s(t,p,r.keySplines,v),e.set(p,u)}return[p,u]},s=function(e,t,r,a){if(!n){if(0===a)return;a--}var i=r&&r[a]||"";if(""!==i){var s=e.get(t)||new Set;s.add(i),e.set(t,s)}},o=e.filter(function(e){return void 0===e.element}),u=ge.minArray(o.map(function(e){return e.delay})),l=ge.maxArray(o.map(function(e){return we(e)})),c=o.filter(function(e){return ge.hasBit(e.fillMode,2)}),f={},h=0,v=Array.isArray(p=e),m=0,p=v?p:p[Symbol.iterator]();;){var d;if(v){if(m>=p.length)break;d=p[m++]}else{if((m=p.next()).done)break;d=m.value}var b=d,k=b.attributeName;void 0===f[k]&&(f[k]=new Map);for(var A=Array.isArray(x=b.begin),S=0,x=A?x:x[Symbol.iterator]();;){var T;if(A){if(S>=x.length)break;T=x[S++]}else{if((S=x.next()).done)break;T=S.value}var E=T;if(void 0===b.element||0===c.length&&E<u||we(b)>l){var w=f[k].get(E)||{duration:0,items:[]};w.items.push(b),f[k].set(E,w)}}}for(var V in f)if(f[V].size){var R=f[V],M=Number.MAX_VALUE,_=function(){if(O){if(G>=N.length)return"break";C=N[G++]}else{if((G=N.next()).done)return"break";C=G.value}var e=y(C,2),t=e[0],r=e[1];r.items.sort(function(e,t){return e.element&&void 0===t.element?-1:0});var n=r.items.length-1,a=[];do{for(var i=r.items[n],s=-1===i.repeatCount||i.fillMode>=4,o=i.duration*i.repeatCount,u=0;u<n;u++){var l=r.items[u];(s||-1!==l.repeatCount&&l.duration*l.repeatCount<=o)&&a.push(l)}if(-1!==i.repeatCount&&i.fillMode>=4&&(M=Math.min(t+o,M)),s)break}while(--n>=0);r.items=r.items.filter(function(e){return!a.includes(e)}),R.set(t,r)},N=R.entries(),O=Array.isArray(N),G=0;for(N=O?N:N[Symbol.iterator]();;){var C;if("break"===_())break}var F=new Map,P=q(Array.from(R.keys())),L=Array.isArray(P),B=0;for(P=L?P:P[Symbol.iterator]();;){var I;if(L){if(B>=P.length)break;I=P[B++]}else{if((B=P.next()).done)break;I=B.value}var X=I,D=R.get(X);if(D){var j=ge.maxArray(D.items.map(function(e){return Ve(e)}));h=Math.max(h,X+j),D.items=D.items.filter(function(e){return!c.includes(e)}),D.items.length&&(D.duration=j,D.items.reverse(),F.set(X,D))}}f[V]=F}else delete f[V];var U,W,Y={},K={},H=new Map,Z=new Map,Q=new Set,J={},ee={},te=0,re=function(e){var t;try{t=(a||r).getBaseValue(e)}catch(e){}return null!=t?t:"points"===e?[{x:0,y:0}]:0};e:{var ne=function(e){Y[e]=new Map;var r=Array.from(f[e].keys()),n=Array.from(f[e].values()),a=re(e),u=[],l=a,v=void 0,m=-1;function p(t,r){return u=u.filter(function(e){return e.value!==t}),ge.hasBit(t.fillMode,4)?(ee[e]=!0,0===(o=o.filter(function(t){return t.attributeName!==e})).length?2:1):ge.hasBit(t.fillMode,8)?(J[e]={ordinal:m,value:l},1):(r&&Y[e].set(++m,a),0)}if(c.length&&(v=c.filter(function(t){return t.attributeName===e})).length){for(var g=Array.isArray(b=v),d=0,b=g?b:b[Symbol.iterator]();;){var k;if(g){if(d>=b.length)break;k=b[d++]}else{if((d=b.next()).done)break;k=d.value}var A=k;r.unshift(A.delay),n.unshift({duration:Ve(A),items:[A]})}var S=n[0].items[0];l=xe(S,S.reverse?0:S.values.length-1,l,0),Y[e].set(0,l)}t:{for(var x=function(a){var c=n[a].items;if(0===c.length)return"continue";var f=r[a],g=-1;f<0&&(g=Math.max(0,m),m=Math.max(m,Math.abs(f)),f=0);for(var d=-1,b=0,k=function(t){var g=c[t];t===d&&(f=b,d=-1,b=0);var k=-1===g.repeatCount,S=g.duration,x=g.repeatCount,T=S;if(!k&&f+Math.min(g.end||Number.MAX_VALUE,T*=x)<=m)return A=t,"continue";var E=void 0,w=void 0;k?(E=Math.ceil((h-f)/S),w=0):(E=Math.ceil(x),w=x-Math.floor(x));var V=void 0,R=0;if(g.element){if(V=r[a+1],u.length){for(var M,_=u.length-1;_>=0;_--)if(void 0===u[_].value.element){M=u[_],u.splice(_,1);break}if(M)return d=t+1,b=f,f=M.ordinal,c.splice(t,0,M.value),A=--t,"continue"}for(var N=a+1;N<r.length;N++)R=Math.max(R,r[N]+n[N].duration)}else!function(){var e=o.findIndex(function(e){return e===g});if(void 0===v||!v.includes(g))r:for(var i=a+1;i<r.length;i++){var s=function(){if(l){if(c>=u.length)return"break";f=u[c++]}else{if((c=u.next()).done)return"break";f=c.value}var t=f;if(o.findIndex(function(e){return e===t})>e)return V=r[i],"break|nextBegin"};var u=n[i].items.filter(function(e){return void 0===e.element}),l=Array.isArray(u),c=0;n:for(u=l?u:u[Symbol.iterator]();;){var f;switch(s()){case"break":break n;case"break|nextBegin":break r}}}for(var h=a+1;h<r.length;h++){var m=n[h].items.filter(function(t){return void 0===t.element&&o.findIndex(function(e){return e===t})>e});if(m.length){var p=ge.maxArray(m.map(function(e){return Ve(e)}));R=Math.max(R,r[t]+p)}}}();var O=Math.min(V||Number.MAX_VALUE,g.end||Number.MAX_VALUE),G=void 0,C=!1;if(O>m){C=!0;var F=-1!==m;r:for(var P=function(t){for(var n=0;n<g.keyTimes.length;n++){var o=g.keyTimes[n],u=void 0,c=xe(g,n,l,t);if(t===E-1&&w>0)if(w>o){for(var h=n+1;h<g.keyTimes.length;h++)if(w<=g.keyTimes[h]){u=f+T,c=Te(w,o,g.keyTimes[h],c,xe(g,h,l,t)),w=-1;break}}else w===o&&(w=-1);if(void 0===u)if((u=Se(f,S,g.keyTimes,t,n))===O)C=t===E-1&&n===g.keyTimes.length-1;else{var v=function(n,s){var o=y(i(Y[e],H,g,l,f,t,n,s&&n===r[a+1]&&!Y[e].has(n-1)?-1:0),2);m=o[0],G=o[1]};if(u>O)return v(O,!0),C=!1,"break|threadTimeExceeded";if(F){if(f>=m)u=Math.max(f,m+1);else{if(u<m)continue;u===m?u=m+1:v(m,!1)}F=!1}else if(t>0&&0===n){if(g.additiveSum&&g.accumulateSum){s(H,u,g.keySplines,n),m=u;continue}if(u===m&&Y[e].get(u)===c){s(H,u,g.keySplines,n);continue}u=Math.max(u,m+1)}}if(u>m&&(s(H,u,g.keySplines,n),Y[e].set(u,c),m=u,G=c),!C||-1===w)return"break|threadTimeExceeded"}},L=Math.floor(Math.max(0,m-f)/S);L<E;L++){if("break|threadTimeExceeded"===P(L))break r}}if(void 0!==G&&(l=G,k||Q.add(g)),k)u.length=0,u.push({ordinal:f,value:g});else if(C){var B=p(g,r[a+1]>m+1);if(2===B)return A=t,{v:{v:"break|animationEnd"}};if(1===B)return A=t,{v:"break|attributeEnd"}}else r[a]+T>R&&u.push({ordinal:f,value:g});A=t},A=0;A<c.length;A++){var S=k(A);switch(S){case"continue":continue;default:if("object"===t(S))return S.v}}if(-1!==g){var x=new Map;m=g;var T=Y[e].entries(),E=Array.isArray(T),w=0;for(T=E?T:T[Symbol.iterator]();;){var V;if(E){if(w>=T.length)break;V=T[w++]}else{if((w=T.next()).done)break;V=w.value}var R=y(V,2),M=R[0],_=R[1];if(M>=g)for(M+=r[a];x.has(M);)M++;x.set(M,_),m=Math.max(M,m)}Y[e]=x}},T=0;T<r.length;T++){var E=x(T);switch(E){case"continue":continue;case"break|attributeEnd":break t;default:if("object"===t(E))return E.v}}if(u.length){u.reverse();var w=function(t){var r=u[t].ordinal,n=u[t].value,a=n.duration,c=m-r,f=Number.MAX_VALUE,h=function(){var t=Math.floor(c/a),o=!1;do{for(var u=0;u<n.keyTimes.length;u++){var h=Se(r,a,n.keyTimes,t,u);if(!o&&h>=m){var v=y(i(Y[e],H,n,l,r,t,m),2);m=v[0],l=v[1],o=!0}if(o){if(h>=f){if(f>m){var p=y(i(Y[e],H,n,l,r,t,f),2);m=p[0],l=p[1]}return}h>m&&(l=xe(n,u,l,t),s(H,h,n.keySplines,u),Y[e].set(h,l),m=h)}}}while(m<f&&++t)};if(-1===n.repeatCount)return c>0&&c%a!=0&&(f=r+n.duration*Math.ceil(c/a),h()),K[e]={ordinal:r,value:n},void 0===n.element&&0===(o=o.filter(function(t){return t.attributeName!==e})).length?{v:"break|animationEnd"}:"break|attributeEnd";if((f=r+n.duration*n.repeatCount)>m){h(),Q.add(n);var v=p(n,!1);if(2===v)return{v:"break|animationEnd"};if(1===v)return"break|attributeEnd"}};for(T=0;T<u.length;T++){var V=w(T);switch(V){case"break|attributeEnd":break t;default:if("object"===t(V))return V.v}}}}o=o.filter(function(t){return t.attributeName!==e})};for(var ae in f){if("break|animationEnd"===ne(ae))break e}}var ie=[];for(var se in Y)ie.push.apply(ie,g(Y[se].keys()));var oe=ge.maxArray(ie);if(Object.keys(K).length){var ue=[],fe=[];for(var he in K)ue.push(K[he].ordinal),fe.push(K[he].value.duration);fe.length>1?oe=z(fe,oe,ue):oe-ue[0]%fe[0]!=0&&(oe=fe[0]*Math.ceil(oe/fe[0]))}var ve=function(e){var t=Y[e],r=ge.maxArray(Array.from(t.keys()));if(K[e]&&r<oe){var n=K[e].ordinal,a=K[e].value,o=Array.from(t.values()).pop(),u=Math.floor((r-n)/a.duration);do{for(var l=!1,c=0;c<a.keyTimes.length;c++){var f=Se(n,a.duration,a.keyTimes,u,c);if(!l&&f>=r){var h=y(i(t,H,a,o,n,u,r),2);o=h[1],ie.push(r=h[0]),l=!0}l&&f>r&&(o=xe(a,c,o,u),s(H,f,a.keySplines,c),t.set(f,o),ie.push(r=f))}}while(r<oe&&++u)}if(void 0===K[e]&&void 0===J[e]&&!ee[e]){var v,m=Array.from(Q).reverse().find(function(t){return t.attributeName===e});if(m&&void 0===m.element){var p=m.values[0]||m.from;isNaN(v=parseFloat(p))&&0===(v=$.fromNumberList($.toNumberList(p))).length&&(v=void 0)}else v=re(e);if(void 0!==v&&JSON.stringify(t.get(r))!==JSON.stringify(v)){for(;t.has(r);)r++;t.set(r,v),ie.push(r)}}};for(var me in Y)ve(me);var pe=q(Array.from(new Set(ie))),ye={};for(var Ee in Y){for(var Re=Y[Ee],Me=new Map,_e=Array.from(Re.keys()).pop(),Ne=0;Ne<pe.length;Ne++){var Oe=pe[Ne];if(Oe<=_e){var Ge=Re.get(Oe);void 0===Ge?de(Re,Me,Oe):Me.set(Oe,Ge)}}ye[Ee]=Me}if(U=Ae(ye,pe,J),h=pe[pe.length-1],n&&(U=be(U,h)),Object.keys(K).length){var Ce=[],Fe={},Pe=[];for(var Le in K)Ce.push(K[Le].value);te=z(Ce.map(function(e){return e.duration}));for(var Be=0;Be<Ce.length;Be++){var Ie=Ce[Be],Xe=Ie.attributeName;Fe[Xe]=new Map;var De=0,je=Y[Xe]?Array.from(Y[Xe].values()).pop():re(Xe),qe=0;do{for(var ze=0;ze<Ie.keyTimes.length;ze++)De=Se(0,Ie.duration,Ie.keyTimes,qe,ze),je=xe(Ie,ze,je,qe),s(Z,De,Ie.keySplines,ze),Fe[Xe].set(De,je),Pe.push(De)}while(De<te&&++qe)}if(Ce.every(function(e){return e.alternate})){var Ue=-1;for(var We in K)for(var Ye=Array.from(Fe[We].keys()),Ke=Array.from(Fe[We].values()).reverse(),He=0;He<Ye.length;He++){Ue=te+Ye[He];var Ze=Z.get(Ye[He]);Ze&&Z.set(Ue,Ze),Fe[We].set(Ue,Ke[He]),Pe.push(Ue)}-1!==Ue&&(te=Ue)}for(var $e in Pe=q(Array.from(new Set(Pe))),Fe)for(var Qe=Fe[$e],Je=1;Je<Pe.length;Je++){var et=Pe[Je];Qe.has(et)||de(Qe,Qe,et)}W=Ae(Fe,Pe),n&&(W=be(W,te))}if(U||W){var tt=function(e){e.has("x")?nt=e.get("x"):e.set("x",nt),e.has("y")?at=e.get("y"):e.set("y",at)};ge.retainArray(r.animation,function(t){return!e.includes(t)});var rt=Array.from(new Set(e.map(function(e){return e.attributeName}))).sort().join("-"),nt=0,at=0;void 0===a&&(nt=re("x")||0,at=re("y")||0);var it=function(e,t){t||(e.repeatCount=-1),e.from=e.values[0],e.to=e.values[e.values.length-1],r.animation.push(e)};[U,W].forEach(function(e){if(e){var t=e===U,i=t?H:Z,s=t?void 0:J;if(n){var o,u=[],l=r.parent;if(a){var c=ke(e,a,l,s);if(!c)return;(o=new le).attributeName="d";for(var f=Array.isArray(m=c),v=0,m=f?m:m[Symbol.iterator]();;){var p;if(f){if(v>=m.length)break;p=m[v++]}else{if((v=m.next()).done)break;p=v.value}var g=p;o.keyTimes.push(g.ordinal),o.values.push(""+g.value);var d=i.get(g.ordinal);d?(u.push(d.values().next().value),i.delete(g.ordinal)):u.push("")}}else{(o=new ce).attributeName="transform",o.type=SVGTransform.SVG_TRANSFORM_TRANSLATE;var b=e.entries(),k=Array.isArray(b),A=0;for(b=k?b:b[Symbol.iterator]();;){var S;if(k){if(A>=b.length)break;S=b[A++]}else{if((A=b.next()).done)break;S=A.value}var x=y(S,2),T=x[0];tt(x[1]),o.keyTimes.push(T),o.values.push(l?"".concat(l.refitX(nt)," ").concat(l.refitX(at)):"".concat(nt," ").concat(at));var E=i.get(T);E?(u.push(E.values().next().value),i.delete(T)):u.push("")}}o.keySplines=u,o.duration=t?h:te,it(o,t)}else for(var w=Array.from(e.entries()),V=0,R=0;V<w.length-1;V++){var M=y(w[V],2),_=M[0],N=M[1],O=y(w[V+1],2),G=O[0],C=O[1],F=void 0,P=void 0;if(a){var L=new Map;L.set(_,N),L.set(G,C);var B=ke(L,a,r.parent,s);if(!B)continue;(F=new le).attributeName="d",F.values=B.map(function(e){return""+e.value}),P=rt}else(F=new ce).attributeName="transform",F.type=SVGTransform.SVG_TRANSFORM_TRANSLATE,F.values=[N,C].map(function(e){return tt(e),r.parent?"".concat(r.parent.refitX(nt)," ").concat(r.parent.refitX(at)):"".concat(nt," ").concat(at)}),P=rt+V;t&&(F.begin=[0===V?_:0]),F.duration=G-_,F.keyTimes=[0,1],F.sequential={ordinal:R++,value:P};var I=i.get(G);I&&(F.keySplines=[I.values().next().value],i.delete(G)),it(F,t)}}})}}()}}]),n}()},Me=squared.lib.util,_e=function(e){function t(e){var r;if(a(this,t),(r=f(this,l(t).call(this,e))).element=e,r.path="",r.mpath=null,r.rotate=0,r.rotateAuto=!1,r.rotateAutoReverse=!1,r.keyPoints=[],e){r.setAttribute("path");var n=r.getAttribute("rotate");switch(n){case"auto":r.rotateAuto=!0;break;case"auto-reverse":r.rotateAutoReverse=!0;break;default:r.rotate=Me.convertInt(n)}if(r.keyTimes.length){var i=r.getAttribute("keyPoints");if(i){var s=le.toFractionList(i);s.length===r.keyTimes.length&&(r.keyPoints=s)}}for(var o=0;o<e.children.length;o++){var u=e.children[o];if("mpath"===u.tagName){var c=L(u);if(c&&(G.shape(c)||G.use(c))){r.mpath=c;break}}}}return r}return u(t,le),s(t,[{key:"instanceType",get:function(){return 3}}]),t}(),Ne=squared.lib.dom,Oe=squared.lib.util,Ge=Ne.getKeyframeRules(),Ce={"animation-delay":"0s","animation-duration":"0s","animation-iteration-count":"1","animation-play-state":"running","animation-direction":"normal","animation-fill-mode":"none","animation-timing-function":"ease"},Fe=RegExp("cubic-bezier\\(".concat(R.ZERO_ONE,", ").concat(R.DECIMAL,", ").concat(R.ZERO_ONE,", ").concat(R.DECIMAL,"\\)"));function Pe(e,t){var r=Ne.cssAttribute(e,t);if("animation-timing-function"===t){for(var n=[];""!==r;){var a=r.indexOf(",");if(-1===a){n.push(r);break}var i=r.substring(0,a);if(i.startsWith("steps")||i.startsWith("cubic-bezier")){var s=r.indexOf(")",a)+1;i+=r.substring(a,s),a=s}n.push(i),r=r.substring(a+1).trim()}return n}return Oe.flatMap(r.split(/,/),function(e){return e.trim()})}function Le(e){return e.sort(function(e,t){return e.ordinal>=t.ordinal?1:-1})}var Be=function(e){return function(t){function r(){var e;return a(this,r),(e=f(this,l(r).apply(this,arguments))).transformed=null,e}return u(r,e),s(r,[{key:"getAnimations",value:function(e){var t=this,r=[],n=Pe(e,"animation-name");if(n.length){var a={};for(var i in Ce){var s=Pe(e,i);for(0===s.length&&s.push(Ce[i]);s.length<n.length;)s.push.apply(s,g(s.slice(0)));s.length=n.length,a[i]=s}n.forEach(function(t,n){var i=Ge.get(t);if(i){var s={},o={};for(var u in i){var l=parseInt(u)/100;for(var c in i[u]){var f=Ce[c]?o:s;void 0===f[c]&&(f[c]=[]),f[c].push({ordinal:l,value:i[u][c]})}}if(s.transform){Le(s.transform).forEach(function(t){var r=I(e,t.value);if(r){var n=function(t){if(s["transform-origin"]){var r=s["transform-origin"].find(function(e){return e.ordinal===t});if(r)return D(e,r.value)}return D(e)}(t.ordinal);r.forEach(function(e){var r,a;switch(e.type){case SVGTransform.SVG_TRANSFORM_TRANSLATE:r="translate",a="".concat(e.matrix.e," ").concat(e.matrix.f);break;case SVGTransform.SVG_TRANSFORM_SCALE:r="scale",a="".concat(e.matrix.a," ").concat(e.matrix.d);break;case SVGTransform.SVG_TRANSFORM_ROTATE:r="rotate",a="".concat(e.angle," ").concat(n.x," ").concat(n.y);break;case SVGTransform.SVG_TRANSFORM_SKEWX:r="skewX",a=""+e.angle;break;case SVGTransform.SVG_TRANSFORM_SKEWY:r="skewY",a=""+e.angle;break;default:return}void 0===s[r]&&(s[r]=[]);var i=s[r].findIndex(function(e){return e.ordinal===t.ordinal});-1!==i?s[r][i].value=a:s[r].push({ordinal:t.ordinal,value:a})})}})}delete s.transform,delete s["transform-origin"];var h=function(t){var i=s[t];Le(i);var u=void 0;switch(t){case"rotate":case"scale":case"skewX":case"skewY":case"translate":var l=new ce;l.attributeName="transform",l.setType(t),u=l,0!==i[0].ordinal&&i.unshift({ordinal:0,value:j(t)});break;default:(u=new le).attributeName=t,0!==i[0].ordinal&&i.unshift({ordinal:0,value:Ne.cssAttribute(e,t)})}u.paused="paused"===a["animation-play-state"][n],u.delay=O(a["animation-delay"][n]),u.duration=O(a["animation-duration"][n]);for(var c=a["animation-iteration-count"][n],f=a["animation-timing-function"][n],h=a["animation-direction"][n],v=a["animation-fill-mode"][n],m=[],p=[],y=[],d=function(e){if(m.push(i[e].ordinal),p.push(i[e].value),e<i.length-1){var t=o["animation-timing-function"]?o["animation-timing-function"].find(function(t){return t.ordinal===i[e].ordinal}):void 0;y.push(t?t.value:f)}},b=0;b<i.length;b++)d(b);y.every(function(e){return"linear"===e})?(u.keyTimes=m,u.values=p):function(){for(var r=[],n=[],a=[],i=0;i<y.length;i++){if(re[y[i]])y[i]=re[y[i]];else if(y[i].startsWith("steps")){var s=le.toStepFractionList(t,y[i],i,m,p,_(),N(e));if(s){r.push.apply(r,g(s[0])),n.push.apply(n,g(s[1])),s[0].forEach(function(){return a.push(re.step)});continue}y[i]=re.linear}else{var o=Fe.exec(y[i]);y[i]=o?"".concat(o[1]," ").concat(o[2]," ").concat(o[3]," ").concat(o[4]):re.ease}r.push(m[i]),n.push(p[i]),a.push(y[i])}r.push(m.pop()),n.push(p.pop()),u.keyTimes=r,u.values=n,u.keySplines=a}(),u.repeatCount="infinite"!==c?parseFloat(c):-1,"forwards"!==v&&"both"!==v||(u.fillMode|=4),"backwards"!==v&&"both"!==v||(u.fillMode|=2),u.reverse=h.endsWith("reverse"),u.alternate=(-1===u.repeatCount||u.repeatCount>1)&&h.startsWith("alternate"),r.push(u)};for(var v in s)h(v)}})}for(var o=0;o<e.children.length;o++){var u=e.children[o];switch(u.tagName){case"set":r.push(new te(u));break;case"animate":r.push(new le(u));break;case"animateTransform":r.push(new ce(u));break;case"animateMotion":r.push(new _e(u))}}return r.forEach(function(e){return e.parent=t}),r}},{key:"name",get:function(){return void 0===this._name&&(this._name=$.setName(this.element)),this._name}},{key:"transform",get:function(){return void 0===this._transform&&(this._transform=I(this.element)||$.convertTransformList(this.element.transform.baseVal)),this._transform}},{key:"animation",get:function(){return void 0===this._animation&&(this._animation=this.getAnimations(this.element)),this._animation}},{key:"visible",set:function(e){F(this.element,e)},get:function(){return C(this.element)}},{key:"opacity",set:function(e){P(this.element,e)},get:function(){return Ne.cssAttribute(this.element,"opacity")||"1"}}]),r}()},Ie=squared.lib.dom;function Xe(e){var t=e.parentElement instanceof HTMLElement;return"svg"===e.tagName&&(Ie.isUserAgent(4)&&!t||Ie.isUserAgent(16)&&t)}var De=function(e){return function(t){function r(){return a(this,r),f(this,l(r).apply(this,arguments))}return u(r,e),s(r,[{key:"setRect",value:function(){var e=this.x,t=this.y,r=this.width,n=this.height,a=this.parent;a&&(e=a.refitX(e),t=a.refitY(t),r=a.refitSize(r),n=a.refitSize(n)),this.setBaseValue("x",e),this.setBaseValue("y",t),this.setBaseValue("width",r),this.setBaseValue("height",n)}},{key:"getElement",value:function(){switch(this.element.tagName){case"svg":case"use":case"image":return this.element;default:return null}}},{key:"x",set:function(e){this._x=e},get:function(){if(void 0!==this._x)return this._x;var e=this.getElement();return e?e.x.baseVal.value:0}},{key:"y",set:function(e){this._y=e},get:function(){if(void 0!==this._y)return this._y;var e=this.getElement();return e?e.y.baseVal.value:0}},{key:"width",set:function(e){this._width=e},get:function(){if(void 0!==this._width)return this._width;var e=this.getElement();return e?Xe(e)?e.getBoundingClientRect().width:e.width.baseVal.value:0}},{key:"height",set:function(e){this._height=e},get:function(){if(void 0!==this._height)return this._height;var e=this.getElement();return e?Xe(e)?e.getBoundingClientRect().height:e.height.baseVal.value:0}}]),r}()},je=function(e){function t(e){var r;return a(this,t),(r=f(this,l(t).call(this))).element=e,r.aspectRatio={x:0,y:0,unit:1},r}return u(t,squared.lib.base.Container),s(t,[{key:"append",value:function(e){return e.parent=this,v(l(t.prototype),"append",this).call(this,e)}},{key:"build",value:function(e,t){this.clear();for(var r=0;r<this.element.children.length;r++){var n=this.element.children[r],a=void 0;if(G.svg(n))a=new squared.svg.Svg(n,!1),this.setAspectRatio(a,n);else if(G.g(n))a=new squared.svg.SvgG(n),this.setAspectRatio(a);else if(G.use(n)){var i=L(n,n.parentElement);i&&(G.symbol(i)?(a=new squared.svg.SvgUseSymbol(n,i),this.setAspectRatio(a,i)):G.image(i)?a=new squared.svg.SvgImage(n,i):G.shape(i)&&(a=new squared.svg.SvgUse(n,i)))}else G.image(n)?a=new squared.svg.SvgImage(n):G.shape(n)&&(a=new squared.svg.SvgShape(n));a&&(this.append(a),a.build(e,t))}}},{key:"synchronize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.each(function(t){return t.synchronize(e)})}},{key:"refitX",value:function(e){return e*this.aspectRatio.unit+this.aspectRatio.x}},{key:"refitY",value:function(e){return e*this.aspectRatio.unit+this.aspectRatio.y}},{key:"refitSize",value:function(e){return e*this.aspectRatio.unit}},{key:"refitPoints",value:function(e){for(var t=this.aspectRatio,r=Array.isArray(a=e),n=0,a=r?a:a[Symbol.iterator]();;){var i;if(r){if(n>=a.length)break;i=a[n++]}else{if((n=a.next()).done)break;i=n.value}var s=i;s.x=s.x*t.unit+t.x,s.y=s.y*t.unit+t.y,void 0!==s.rx&&void 0!==s.ry&&(s.rx*=t.unit,s.ry*=t.unit)}return e}},{key:"setAspectRatio",value:function(e,t){var r=$.getContainerViewBox(this);if(r){var n=e.aspectRatio;if(t){var a=t.viewBox.baseVal;if(a&&a.width>0&&a.height>0){var i=a.width/a.height,s=r.viewBox,o=s.width/s.height;o>i?n.x=(s.width-s.height*a.width/a.height)/2:o<i&&(n.y=(s.height-s.width*a.height/a.width)/2),n.unit=Math.min(s.width/a.width,s.height/a.height)}}n.x*=r.aspectRatio.unit,n.x+=r.aspectRatio.x,n.y*=r.aspectRatio.unit,n.y+=r.aspectRatio.y,n.unit*=r.aspectRatio.unit}}}]),t}(),qe=squared.lib.color,ze=squared.lib.dom;function Ue(e){var t=[];return Array.from(e.getElementsByTagName("stop")).forEach(function(e){var r=qe.parseRGBA(ze.cssAttribute(e,"stop-color"),ze.cssAttribute(e,"stop-opacity"));r&&t.push({color:r.valueRGBA,offset:ze.cssAttribute(e,"offset"),opacity:r.alpha})}),t}function We(e){for(var t={},r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];for(var i=0;i<n.length;i++){var s=n[i];e[s]&&(t[s]=e[s].baseVal.value,t["".concat(s,"AsString")]=e[s].baseVal.valueAsString)}return t}var Ye=function(e){function t(e){var r,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return a(this,t),(r=f(this,l(t).call(this,e))).element=e,r.documentRoot=n,r.patterns={clipPath:new Map,gradient:new Map},r.init(),r}return u(t,Re(De(J(Be(je))))),s(t,[{key:"build",value:function(e,r){this.setRect(),v(l(t.prototype),"build",this).call(this,e,r)}},{key:"synchronize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!this.documentRoot&&this.animation.length&&this.mergeAnimate(this.getAnimateViewRect(),e),v(l(t.prototype),"synchronize",this).call(this,e)}},{key:"init",value:function(){var e=this;[this.element].concat(g(Array.from(this.element.querySelectorAll("defs")))).forEach(function(t){t.querySelectorAll(":scope > set, :scope > animate, :scope > animateTransform, :scope > animateMotion").forEach(function(t){var r=L(t,e.element);r&&(t.parentElement&&t.parentElement.removeChild(t),r.appendChild(t))}),t.querySelectorAll("clipPath, linearGradient, radialGradient").forEach(function(t){if(t.id){var r="#".concat(t.id);G.clipPath(t)?e.patterns.clipPath.set(r,t):G.linearGradient(t)?e.patterns.gradient.set(r,Object.assign({element:t,type:"linear",colorStop:Ue(t)},We(t,"x1","x2","y1","y2"))):G.radialGradient(t)&&e.patterns.gradient.set(r,Object.assign({element:t,type:"radial",colorStop:Ue(t)},We(t,"cx","cy","r","fx","fy")))}})})}},{key:"viewBox",get:function(){return this.element.viewBox.baseVal}}]),t}(),Ke=function(e){function t(e){var r;return a(this,t),(r=f(this,l(t).call(this,e))).element=e,r.setPaint(),r}return u(t,me(Be(je))),t}(),He=squared.lib.util,Ze=function(e){function t(e,r){var n;return a(this,t),(n=f(this,l(t).call(this,e))).element=e,n.imageElement=null,r&&(n.imageElement=r),n}return u(t,De(J(Be(pe)))),s(t,[{key:"build",value:function(){this.setRect()}},{key:"extract",value:function(e){var t=$.filterTransforms(this.transform,e),r=this.x,n=this.y,a=this.width,i=this.height;if(t.length){t.reverse();for(var s=0;s<t.length;s++){var o=t[s],u=o.matrix,l=r;switch(r=U(u,l,n),n=W(u,l,n),o.type){case SVGTransform.SVG_TRANSFORM_SCALE:a*=u.a,i*=u.d;break;case SVGTransform.SVG_TRANSFORM_ROTATE:0!==o.angle&&(u.a<0&&(r+=u.a*a),u.c<0&&(r+=u.c*a),u.b<0&&(n+=u.b*i),u.d<0&&(n+=u.d*i),this.rotateOrigin?this.rotateOrigin.angle=(this.rotateOrigin.angle||0)+o.angle:this.rotateOrigin={angle:o.angle,x:0,y:0})}}this.transformed=t}this.parent&&(r=this.parent.refitX(r),n=this.parent.refitY(n),a=this.parent.refitSize(a),i=this.parent.refitSize(i)),this.translationOffset&&(r+=this.translationOffset.x,n+=this.translationOffset.y),this.setBaseValue("x",r),this.setBaseValue("y",n),this.setBaseValue("width",a),this.setBaseValue("height",i)}},{key:"x",set:function(e){p(l(t.prototype),"x",e,this,!0)},get:function(){var e=v(l(t.prototype),"x",this);return 0===e&&this.imageElement?this.imageElement.x.baseVal.value:e}},{key:"y",set:function(e){p(l(t.prototype),"y",e,this,!0)},get:function(){var e=v(l(t.prototype),"y",this);return 0===e&&this.imageElement?this.imageElement.y.baseVal.value:e}},{key:"width",set:function(e){p(l(t.prototype),"width",e,this,!0)},get:function(){var e=v(l(t.prototype),"width",this);return 0===e&&this.imageElement?this.imageElement.width.baseVal.value:e}},{key:"height",set:function(e){p(l(t.prototype),"height",e,this,!0)},get:function(){var e=v(l(t.prototype),"height",this);return 0===e&&this.imageElement?this.imageElement.height.baseVal.value:e}},{key:"href",set:function(e){var t=this.imageElement||this.element;G.image(t)&&(t.href.baseVal=e)},get:function(){var e=this.imageElement||this.element;return G.image(e)?He.resolvePath(e.href.baseVal):""}}]),t}(),$e=function(e){function t(e){var r;return a(this,t),(r=f(this,l(t).call(this,e))).element=e,r.setType(),r}return u(t,Re(Be(pe))),s(t,[{key:"setType",value:function(e){this.type=w[(e||this.element).tagName]||0}},{key:"build",value:function(e,t){var r;void 0===this._path?(r=new ye(this.element),this.path=r):r=this._path;var n=this.transform.slice(0);r.element!==this.element&&n.push.apply(n,g(r.transform)),r.draw($.filterTransforms(n,e?e[r.element.tagName]:void 0),t)}},{key:"synchronize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._path&&this.animation.length&&this.mergeAnimate(this.getAnimateShape(),e,this._path)}},{key:"path",set:function(e){this._path=e,e&&(e.parent=this.parent,e.name=this.name)},get:function(){return this._path}}]),t}(),Qe=function(e){function t(e,r){var n;return a(this,t),(n=f(this,l(t).call(this,e))).element=e,n.shapeElement=r,n.setPaint(),n.setShape(r),n}return u(t,me(De(J($e)))),s(t,[{key:"setShape",value:function(e){this.shapeElement=e,this.setType(e),this.path=void 0}},{key:"build",value:function(e,r){void 0===this.path&&(this.path=new ye(this.shapeElement,this.element)),v(l(t.prototype),"build",this).call(this,e,r)}},{key:"synchronize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.animation.length&&this.mergeAnimate(this.getAnimateViewRect(),e),v(l(t.prototype),"synchronize",this).call(this,e)}},{key:"href",set:function(e){if("#"===e.charAt(0)){var t=document.getElementById(e.substring(1));t&&G.shape(t)&&(this.setShape(t),this.element.href.baseVal=e)}},get:function(){return this.element.href.baseVal}}]),t}(),Je=function(e){function t(e,r){var n;return a(this,t),(n=f(this,l(t).call(this,e))).element=e,n.symbolElement=r,n.setPaint(),n}return u(t,me(Re(De(J(Be(je)))))),s(t,[{key:"build",value:function(e,r){this.setRect();var n=this.element;this.element=this.symbolElement,v(l(t.prototype),"build",this).call(this,e,r),this.each(function(e){e.path&&(e.path.parentElement=n,e.path.setPaint())}),this.element=n;var a=this.getBaseValue("x"),i=this.getBaseValue("y");if(0!==a||0!==i){var s={x:a,y:i};this.cascade().forEach(function(e){return e.translationOffset=s})}}},{key:"synchronize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.animation.length&&this.mergeAnimate(this.getAnimateViewRect(),e),v(l(t.prototype),"synchronize",this).call(this,e)}},{key:"viewBox",get:function(){return this.symbolElement.viewBox.baseVal}}]),t}(),et={constant:ne,util:K};e.Svg=Ye,e.SvgAnimate=le,e.SvgAnimateMotion=_e,e.SvgAnimateTransform=ce,e.SvgAnimation=te,e.SvgBaseVal=J,e.SvgBuild=$,e.SvgContainer=je,e.SvgElement=pe,e.SvgG=Ke,e.SvgImage=Ze,e.SvgPaint=me,e.SvgPath=ye,e.SvgShape=$e,e.SvgSynchronize=Re,e.SvgUse=Qe,e.SvgUseSymbol=Je,e.SvgView=Be,e.SvgViewRect=De,e.lib=et,Object.defineProperty(e,"__esModule",{value:!0})});
