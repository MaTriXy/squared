!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(((e=e||self).squared=e.squared||{},e.squared.svg={}))}(this,function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){this.wrapped=e}function a(e){var t,a;function r(t,a){try{var s=e[t](a),o=s.value,l=o instanceof n;Promise.resolve(l?o.wrapped:o).then(function(e){l?r("next",e):i(s.done?"return":"normal",e)},function(e){r("throw",e)})}catch(e){i("throw",e)}}function i(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?r(t.key,t.arg):a=null}this._invoke=function(e,n){return new Promise(function(i,s){var o={key:e,arg:n,resolve:i,reject:s,next:null};a?a=a.next=o:(t=a=o,r(e,n))})},"function"!=typeof e.return&&(this.return=void 0)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}function v(e,t,n){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var a=h(e,t);if(a){var r=Object.getOwnPropertyDescriptor(a,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function m(e,t,n,a){return(m="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,a){var r,i=h(e,t);if(i){if((r=Object.getOwnPropertyDescriptor(i,t)).set)return r.set.call(a,n),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(a,t)){if(!r.writable)return!1;r.value=n,Object.defineProperty(a,t,r)}else o(a,t,n);return!0})(e,t,n,a)}"function"==typeof Symbol&&Symbol.asyncIterator&&(a.prototype[Symbol.asyncIterator]=function(){return this}),a.prototype.next=function(e){return this._invoke("next",e)},a.prototype.throw=function(e){return this._invoke("throw",e)},a.prototype.return=function(e){return this._invoke("return",e)};function y(e,t){return p(e)||function(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||d()}function g(e){return function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(e){if(Array.isArray(e))return e}function b(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var S=squared.lib.dom,A=squared.lib.util,V="(-?[\\d.]+)",k="([\\d.]+(?:[a-z]{2,}|%)?)",x="(?:(-?[\\d.]+)(deg|rad|turn))",T={MATRIX:"(matrix(?:3d)?)\\(".concat(V,", ").concat(V,", ").concat(V,", ").concat(V,", ").concat(V,", ").concat(V,"(?:, ").concat(V,")?(?:, ").concat(V,")?(?:, ").concat(V,")?(?:, ").concat(V,")?(?:, ").concat(V,")?(?:, ").concat(V,")?(?:, ").concat(V,")?(?:, ").concat(V,")?(?:, ").concat(V,")?(?:, ").concat(V,")?\\)"),ROTATE:"(rotate[XY]?)\\(".concat(x,"\\)"),SKEW:"(skew[XY]?)\\(".concat(x,"(?:, ").concat(x,")?\\)"),SCALE:"(scale[XY]?)\\(".concat(V,"(?:, ").concat(V,")?\\)"),TRANSLATE:"(translate[XY]?)\\(".concat(k,"(?:, ").concat(k,")?\\)")},E={path:1,line:2,rect:3,ellipse:4,circle:5,polyline:6,polygon:7};function G(){return A.optionalAsNumber(squared,"settings.resolutionDPI")||96}function w(e){return parseInt(S.getStyle(e).fontSize||"16")}function R(e,t,n){e.style[t]=n,e.setAttribute(t,n)}var _={rotate:function(e){var t=K(e),n=Math.cos(t),a=Math.sin(t);return{a:n,b:a,c:-1*a,d:n,e:0,f:0}},skew:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{a:1,b:Math.tan(K(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),c:Math.tan(K(e)),d:1,e:0,f:0}},scale:function(){return{a:arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,b:0,c:0,d:arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e:0,f:0}},translate:function(){return{a:1,b:0,c:0,d:1,e:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,f:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0}}};function M(e){return void 0!==E[e.tagName]}function N(e){return"image"===e.tagName}function O(e){var t=S.cssAttribute(e,"visibility",!0);return"hidden"!==t&&"collapse"!==t&&"none"!==S.cssAttribute(e,"display",!0)}function C(e,t){R(e,"display",t?"block":"none"),R(e,"visibility",t?"visible":"hidden")}function P(e,t){if(A.isNumber(t)){var n=parseFloat(""+t);n<=0?n=0:n>=1&&(n=1),e.style.opacity=""+n,e.setAttribute("opacity",""+n)}}function F(e,t){var n=e.attributes.getNamedItem("href");if(n&&"#"===n.value.charAt(0)){var a=n.value.substring(1);if(t)for(var r=Array.from(t.querySelectorAll("*")),i=0;i<r.length;i++){var s=r[i];if(s.id===a)return s instanceof SVGGraphicsElement?s:null}else{var o=document.getElementById(a);if(o instanceof SVGGraphicsElement)return o}}return null}function L(e){var t=RegExp(T.MATRIX).exec(S.getStyle(e,!0).transform||"");if(t)switch(t[1]){case"matrix":return{a:parseFloat(t[2]),b:parseFloat(t[3]),c:parseFloat(t[4]),d:parseFloat(t[5]),e:parseFloat(t[6]),f:parseFloat(t[7])};case"matrix3d":return{a:parseFloat(t[2]),b:parseFloat(t[3]),c:parseFloat(t[6]),d:parseFloat(t[7]),e:parseFloat(t[14]),f:parseFloat(t[15])}}}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"deg",n=parseFloat(e);switch(t){case"turn":n*=360;break;case"rad":n*=180/Math.PI}return n}function q(e,t){return{type:e,matrix:t,angle:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,method:{x:!(arguments.length>3&&void 0!==arguments[3])||arguments[3],y:!(arguments.length>4&&void 0!==arguments[4])||arguments[4]}}}function j(e){var t=[],n=e.attributes.getNamedItem("transform");if(n)for(var a=/rotate\((-?[\d.]+),\s*(-?[\d.]+),\s*(-?[\d.]+)\)/g,r=null;null!==(r=a.exec(n.value));)t.push({angle:parseFloat(r[1]),x:parseFloat(r[2]),y:parseFloat(r[3])});return t.length?t:[{angle:0,x:0,y:0}]}function X(e){var t=S.cssInline(e,"transform");if(""!==t){var n=[];for(var a in T)for(var r=RegExp(T[a],"g"),i=null;null!==(i=r.exec(t));){var s=i[1].endsWith("X"),o=i[1].endsWith("Y");if(i[1].startsWith("rotate")){var l=I(i[2],i[3]),u=_.rotate(l);s?(u.a=1,u.b=0,u.c=0):o&&(u.b=0,u.c=0,u.d=1),n[i.index+1]=q(SVGTransform.SVG_TRANSFORM_ROTATE,u,l,!s,!o)}else if(i[1].startsWith("skew")){var c=o?0:I(i[2],i[3]),f=o?I(i[2],i[3]):i[4]&&i[5]?I(i[4],i[5]):0,h=_.skew(c,f);s?n[i.index]=q(SVGTransform.SVG_TRANSFORM_SKEWX,h,c,!0,!1):o?n[i.index]=q(SVGTransform.SVG_TRANSFORM_SKEWY,h,f,!1,!0):(n[i.index]=q(SVGTransform.SVG_TRANSFORM_SKEWX,Object.assign({},h,{b:0}),c,!0,!1),0!==f&&(n[i.index+1]=q(SVGTransform.SVG_TRANSFORM_SKEWY,Object.assign({},h,{c:0}),f,!1,!0)))}else if(i[1].startsWith("scale")){var v=o?void 0:parseFloat(i[2]),m=_.scale(v,s?void 0:o?parseFloat(i[2]):!s&&i[3]?parseFloat(i[3]):v);n[i.index]=q(SVGTransform.SVG_TRANSFORM_SCALE,m,0,!o,!s)}else if(i[1].startsWith("translate")){var y=G(),g=w(e),p=parseFloat(A.convertPX(i[2],y,g)),b=!s&&i[3]?parseFloat(A.convertPX(i[3],y,g)):0,d=_.translate(o?0:p,o?p:b);n[i.index]=q(SVGTransform.SVG_TRANSFORM_TRANSLATE,d,0)}else if(i[1].startsWith("matrix")){var V=L(e);V&&(n[i.index]=q(SVGTransform.SVG_TRANSFORM_MATRIX,V))}}return(n=n.filter(function(e){return e})).forEach(function(e){return e.css=!0}),n}}function z(e){var t=S.cssAttribute(e,"transform-origin",!0);if(""!==t){var n,a,r=e.parentElement;if(r instanceof SVGSVGElement)n=r.viewBox.baseVal.width,a=r.viewBox.baseVal.height;else{if(!(r instanceof SVGGElement&&r.viewportElement instanceof SVGSVGElement))return;n=r.viewportElement.viewBox.baseVal.width,a=r.viewportElement.viewBox.baseVal.height}var i=t.split(" ");1===i.length&&i.push("center"),i=i.slice(0,2);var s={x:null,y:null};if(i.includes("left")?s.x=0:i.includes("right")&&(s.x=n),i.includes("top")?s.y=0:i.includes("bottom")&&(s.y=a),["x","y"].forEach(function(t){if(null===s[t])for(var r=0;r<i.length;r++){var o=i[r];if(""!==o&&("center"===o&&(o="50%"),A.isUnit(o)?s[t]=parseInt(o.endsWith("px")?o:A.convertPX(o,G(),w(e))):A.isPercent(o)&&(s[t]=("x"===t?n:a)*(parseInt(o)/100)),null!==s[t])){i[r]="";break}}}),s.x||s.y)return s.x=s.x||0,s.y=s.y||0,s}}function U(e){return e.sort(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?function(e,t){return e>t?-1:1}:function(e,t){return e<t?-1:1})}function B(e){var t=U(e.slice());if(t.length>1){for(var n=t.splice(0,1)[0],a=n,r=!1;!r;)for(var i=Array.isArray(o=t),s=0,o=i?o:o[Symbol.iterator]();;){var l;if(i){if(s>=o.length)break;l=o[s++]}else{if((s=o.next()).done)break;l=s.value}if(!(a>=l&&a%l==0)){r=!1,a+=n;break}r=!0}return a}return t[0]}function W(e,t,n){return e.a*t+e.c*n+e.e}function Y(e,t,n){return e.b*t+e.d*n+e.f}function D(e,t){return t*Math.cos(K(e))*-1}function K(e){return e*Math.PI/180}var H=Object.freeze({SHAPES:E,MATRIX:_,ascendToViewport:function(e){for(var t=[],n=e.parentElement;n instanceof SVGGraphicsElement&&(t.push(n),!((n=n.parentElement)instanceof HTMLElement)););return t},isSvgUse:function(e){return"use"===e.tagName},isSvgShape:M,isSvgImage:N,isVisible:O,setVisible:C,setOpacity:P,getHrefTargetElement:F,getTransformMatrix:L,convertAngle:I,createTransform:q,getRotateOrigin:j,getTransform:X,getTransformOrigin:z,sortNumber:U,getLeastCommonMultiple:B,applyMatrixX:W,applyMatrixY:Y,getRadiusX:function(e,t){return t*Math.sin(K(e))},getRadiusY:D,convertRadian:K}),Z=squared.lib.util,$=function(){function e(t){r(this,e),this.element=t,this.attributeName="",this.to="",this.begin=[0],this.setAttribute("attributeName"),this.setAttribute("to");var n=this.getAttribute("begin"),a=this.getAttribute("dur");"indefinite"===n||"click"===n?this.begin.length=0:""!==n&&(this.begin=U(n.split(";").map(function(t){return e.convertClockTime(t)}))),this.duration=""===a||"indefinite"===a?-1:e.convertClockTime(a)}return s(e,[{key:"setAttribute",value:function(e,t){var n=this.getAttribute(e);n&&(void 0!==t?this[e+Z.capitalize(t)]=n===t:this[e]=n)}},{key:"getAttribute",value:function(e){var t=this.element.attributes.getNamedItem(e);return t?t.value.trim():""}}],[{key:"convertClockTime",value:function(e){var t=0,n=0;if(Z.isNumber(e))t=parseInt(e);else if(/-?\d+ms$/.test(e))n=parseInt(e);else if(/-?\d+s$/.test(e))t=parseInt(e);else if(/-?\d+min$/.test(e))t=60*parseInt(e);else if(/-?\d+(.\d+)?h$/.test(e))t=60*parseFloat(e)*60;else{var a=/^(?:(-?)(\d?\d):)?(?:(\d?\d):)?(\d?\d)\.?(\d?\d?\d)?$/.exec(e);a&&(a[2]&&(t+=60*parseInt(a[2])*60),a[3]&&(t+=60*parseInt(a[3])),a[4]&&(t+=parseInt(a[4])),a[5]&&(n=parseInt(a[5])*(a[5].length<3?Math.pow(10,3-a[5].length):1)),a[1]&&(t*=-1,n*=-1))}return t<0||n<0?0:1e3*t+n}}]),e}(),Q=squared.lib.util,J=function(e){function t(e){var n;r(this,t),(n=f(this,u(t).call(this,e))).element=e,n.from="",n.by="",n.values=[],n.keyTimes=[],n.calcMode="",n.additiveSum=!1,n.accumulateSum=!1,n.fillFreeze=!1;var a,i=n.getAttribute("values"),s=n.getAttribute("from");if(""!==i)if((a=n.values).push.apply(a,g(Q.flatMap(i.split(";"),function(e){return e.trim()}))),n.values.length>1){n.from=n.values[0],n.to=n.values[n.values.length-1];var o=n.getAttribute("keyTimes");if(o){var l,c=t.toFractionList(o);if(c.length===n.values.length)(l=n.keyTimes).push.apply(l,g(c))}}else n.values.length=0;if(0===n.values.length&&""!==n.to){if(""!==s)n.from=s;else if(e.parentElement){var h=Q.optionalAsString(e.parentElement,"".concat(n.attributeName,".baseVal.value"));if(""!==h)n.from=h;else{var v=e.parentElement.attributes.getNamedItem(n.attributeName);v&&(n.from=v.value.trim())}}n.values.push(n.from,n.to),n.keyTimes.push(0,1),n.setAttribute("by")}var m=n.getAttribute("repeatDur"),y=n.getAttribute("repeatCount");if(n.repeatDuration=""===m||"indefinite"===m?-1:t.convertClockTime(m),n._repeatCount="indefinite"===y?-1:Math.max(1,Q.convertInt(y)),n.begin.length){var p=n.getAttribute("end");if(""!==p){var b=U(p.split(";").map(function(e){return $.convertClockTime(e)}));!b.length||1!==n.begin.length&&n.begin[n.begin.length-1]===n.end&&0!==b[0]||(n.end=b[0],n.begin=n.begin.filter(function(e){return e<b[0]}),n.begin.length&&-1===n._repeatCount&&(n._repeatCount=Math.max(1,n.end/n.duration)))}}return n.setAttribute("calcMode"),""===i&&""!==s&&""!==n.to&&(n.setAttribute("additive","sum"),n.additiveSum&&n.setAttribute("accumulate","sum")),n.setAttribute("fill","freeze"),n}return l(t,$),s(t,[{key:"repeatCount",set:function(e){this._repeatCount=-1!==e?Math.max(1,e):-1,this.repeatDuration=-1},get:function(){var e=this.duration;return-1!==e?-1===this._repeatCount&&-1===this.repeatDuration?-1:-1!==this._repeatCount&&-1!==this.repeatDuration?this._repeatCount*e<=this.repeatDuration?this._repeatCount:this.repeatDuration/e:-1!==this.repeatDuration?this.repeatDuration/e:this._repeatCount:1}}],[{key:"toFractionList",value:function(e){var t=-1,n=Q.flatMap(e.split(arguments.length>1&&void 0!==arguments[1]?arguments[1]:";"),function(e){var n=parseFloat(e);return!isNaN(n)&&n<=1&&(-1===t||n>t)?(t=n,n):-1});return n.length>1&&n.some(function(e){return-1!==e})&&0===n[0]?n:[]}}]),t}(),ee=squared.lib.color,te=squared.lib.dom,ne=squared.lib.util,ae=new Map,re=function(){function e(){r(this,e)}return s(e,null,[{key:"setName",value:function(e){if(e){var t,n="";ne.isString(e.id)?(ae.has(e.id)||(n=e.id),t=e.id):t=e.tagName;var a=ae.get(t)||0;return""!==n?(ae.set(t,a),n):(ae.set(t,++a),"".concat(t,"_").concat(a))}return ae.clear(),""}},{key:"filterTransforms",value:function(e,t){return(t?e.filter(function(e){return!t.includes(e.type)}):e).filter(function(e){return!(e.type===SVGTransform.SVG_TRANSFORM_SCALE&&1===e.matrix.a&&1===e.matrix.d)})}},{key:"applyTransforms",value:function(t,n,a,r){for(var i=e.toPointList(n),s=t.slice().reverse(),o=Array.isArray(u=s),l=0,u=o?u:u[Symbol.iterator]();;){var c;if(o){if(l>=u.length)break;c=u[l++]}else{if((l=u.next()).done)break;c=l.value}var f=c,h=0,v=0,m=0,y=0,g=0,p=0;if(a)switch(f.type){case SVGTransform.SVG_TRANSFORM_SCALE:f.method.x&&(h+=a.x),f.method.y&&(y+=a.y);break;case SVGTransform.SVG_TRANSFORM_SKEWX:f.method.y&&(v-=a.y);break;case SVGTransform.SVG_TRANSFORM_SKEWY:f.method.x&&(m-=a.x);break;case SVGTransform.SVG_TRANSFORM_ROTATE:f.method.x&&(m-=a.x,g=a.x+D(f.angle,a.x)),f.method.y&&(v-=a.y,p=a.y+D(f.angle,a.y))}var b=f.matrix;if(r)switch(f.type){case SVGTransform.SVG_TRANSFORM_SCALE:r.x*=b.a,r.y*=b.d;break;case SVGTransform.SVG_TRANSFORM_ROTATE:0!==f.angle&&(r.angle=(r.angle||0)+f.angle);break;case SVGTransform.SVG_TRANSFORM_TRANSLATE:r.x+=b.e,r.y+=b.f}for(var d=Array.isArray(A=i),S=0,A=d?A:A[Symbol.iterator]();;){var V;if(d){if(S>=A.length)break;V=A[S++]}else{if((S=A.next()).done)break;V=S.value}var k=V,x=k.x;if(k.x=W(b,x+h,k.y+v)+g,k.y=Y(b,x+m,k.y+y)+p,void 0!==k.rx&&void 0!==k.ry){var T=k.rx;switch(f.type){case SVGTransform.SVG_TRANSFORM_SCALE:k.rx=W(b,T+h,k.ry+v),k.ry=Y(b,T+m,k.ry+y)}}}}return i}},{key:"partitionTransforms",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[],r=[];if(t.length){var i=t[0].css?[]:j(e);i.reverse();var s=t.slice().reverse(),o=new Set,l=1,u=1;n&&e instanceof SVGEllipseElement&&(l=e.rx.baseVal.value,u=e.ry.baseVal.value);for(var c=[],f=0;f<s.length;f++){var h=s[f],v=n&&0===a.length&&0===c.length;if(!v&&o.has(h.type))c.reverse(),a.push(c),c=[h],o.clear();else switch(h.type){case SVGTransform.SVG_TRANSFORM_TRANSLATE:case SVGTransform.SVG_TRANSFORM_SCALE:v?r.push(h):c.push(h);break;case SVGTransform.SVG_TRANSFORM_MATRIX:v&&0===h.matrix.b&&0===h.matrix.c?r.push(h):(c.push(h),v=!1);break;case SVGTransform.SVG_TRANSFORM_ROTATE:if(i.length){var m=i.shift();m.angle===h.angle&&(h.origin=m)}if(!v||l!==u||0!==f&&r[r.length-1].type!==SVGTransform.SVG_TRANSFORM_ROTATE){v||(c.reverse(),a.push(c),c=[],o.clear()),c.push(h);continue}r.push(h);break;case SVGTransform.SVG_TRANSFORM_SKEWX:case SVGTransform.SVG_TRANSFORM_SKEWY:c.push(h),v=!1}v||o.add(h.type)}c.length&&(c.reverse(),a.push(c))}return[a,r]}},{key:"getCenterPoint",value:function(e){var t=e.map(function(e){return e.x}),n=e.map(function(e){return e.y});return{x:(ne.minArray(t)+ne.maxArray(t))/2,y:(ne.minArray(n)+ne.maxArray(n))/2}}},{key:"toCoordinateList",value:function(e){for(var t,n=[],a=/-?[\d.]+/g;null!==(t=a.exec(e));){var r=parseFloat(t[0]);isNaN(r)||n.push(r)}return n}},{key:"toPointList",value:function(e){var t=[];if(e instanceof SVGPointList)for(var n=0;n<e.numberOfItems;n++){var a=e.getItem(n);t.push({x:a.x,y:a.y})}else for(var r=Array.isArray(s=e),i=0,s=r?s:s[Symbol.iterator]();;){var o;if(r){if(i>=s.length)break;o=s[i++]}else{if((i=s.next()).done)break;o=i.value}var l=o,u={x:l.x,y:l.y};void 0!==l.rx&&void 0!==l.ry&&(u.rx=l.rx,u.ry=l.ry),t.push(u)}return t}},{key:"toAbsolutePointList",value:function(e){for(var t=[],n=0,a=0,r=0;r<e.length;r++){for(var i=e[r],s=0;s<i.coordinates.length;s+=2){i.relative?(n+=i.coordinates[s],a+=i.coordinates[s+1]):(n=i.coordinates[s],a=i.coordinates[s+1]);var o={x:n,y:a};"A"===i.command.toUpperCase()&&(o.rx=i.radiusX,o.ry=i.radiusY),t.push(o)}if(i.relative){switch(i.command){case"h":case"v":var l,u=e[r-1];if(u&&"M"===u.command)(l=u.coordinates).push.apply(l,g(i.coordinates)),e.splice(r,1),r--;i.command="M";break;default:i.command=i.command.toUpperCase()}i.relative=!1}}return t}},{key:"toPathCommandList",value:function(t){var n,a=[],r=/([A-Za-z])([^A-Za-z]+)?/g;for(t=t.trim();null!==(n=r.exec(t))&&(0!==a.length||"M"===n[1].toUpperCase());){n[2]=(n[2]||"").trim();var i=e.toCoordinateList(n[2]),s=a[a.length-1],o=s?s.command.toUpperCase():"",l=s?s.points[s.points.length-1]:void 0,u=void 0,c=void 0,f=void 0,h=void 0,v=void 0;switch(n[1].toUpperCase()){case"M":0===a.length&&(n[1]="M");case"L":if(i.length>=2){i.length%2!=0&&i.length--;break}continue;case"H":if(l&&i.length){i[1]="h"===n[1]?0:l.y,i.length=2;break}continue;case"V":if(l&&i.length){var m=i[0];i[0]="v"===n[1]?0:l.x,i[1]=m,i.length=2;break}continue;case"Z":if(a.length){i.push.apply(i,g(a[0].coordinates.slice(0,2))),n[1]="Z";break}continue;case"C":if(i.length>=6){i.length=6;break}continue;case"S":if(i.length>=4&&("C"===o||"S"===o)){i.length=4;break}continue;case"Q":if(i.length>=4){i.length=4;break}continue;case"T":if(i.length>=2&&("Q"===o||"T"===o)){i.length=2;break}continue;case"A":if(i.length>=7){var p=y(i.splice(0,5),5);u=p[0],c=p[1],f=p[2],h=p[3],v=p[4],i.length=2;break}continue;default:continue}if(i.length>1){for(var b=[],d=/[a-z]/.test(n[1]),S=0;S<i.length;S+=2){var A=i[S],V=i[S+1];d&&l&&(l={x:A+=l.x,y:V+=l.y}),b.push({x:A,y:V})}a.push({command:n[1],relative:d,coordinates:i,points:b,radiusX:u,radiusY:c,xAxisRotation:f,largeArcFlag:h,sweepFlag:v})}}return a}},{key:"toColorStopList",value:function(e){for(var t=[],n=Array.from(e.getElementsByTagName("stop")),a=0;a<n.length;a++){var r=n[a],i=ee.parseRGBA(te.cssAttribute(r,"stop-color"),te.cssAttribute(r,"stop-opacity"));i&&i.visible&&t.push({color:i.valueRGBA,offset:te.cssAttribute(r,"offset"),opacity:i.alpha})}return t}},{key:"toAnimateList",value:function(e){var t=[];if(e instanceof SVGGraphicsElement)for(var n=0;n<e.children.length;n++){var a=e.children[n];a instanceof SVGAnimationElement&&(a instanceof SVGAnimateTransformElement?t.push(new squared.svg.SvgAnimateTransform(a)):a instanceof SVGAnimateMotionElement?t.push(new squared.svg.SvgAnimateMotion(a)):a instanceof SVGAnimateElement?t.push(new squared.svg.SvgAnimate(a)):t.push(new squared.svg.SvgAnimation(a)))}return t}},{key:"toTransformList",value:function(e){for(var t=[],n=0;n<e.numberOfItems;n++){var a=e.getItem(n);t.push(q(a.type,a.matrix,a.angle))}return t}},{key:"fromPointsValue",value:function(e){var t=[];return e.trim().split(/\s+/).forEach(function(e){var n=y(e.split(",").map(function(e){return parseFloat(e)}),2);t.push({x:n[0],y:n[1]})}),t}},{key:"fromNumberList",value:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push({x:e[n],y:e[n+1]});return t.length%2==0?t:[]}},{key:"fromAbsolutePointList",value:function(e,t){var n=t.slice();e:for(var a=Array.isArray(i=e),r=0,i=a?i:i[Symbol.iterator]();;){var s;if(a){if(r>=i.length)break;s=i[r++]}else{if((r=i.next()).done)break;s=r.value}var o=s;switch(o.command.toUpperCase()){case"M":case"L":case"H":case"V":case"C":case"S":case"Q":case"T":for(var l=0;l<o.coordinates.length;l+=2){var u=n.shift();if(!u){e=[];break e}o.coordinates[l]=u.x,o.coordinates[l+1]=u.y}break;case"A":var c=n.shift();if(!c||void 0===c.rx||void 0===c.ry){e=[];break e}o.coordinates[0]=c.x,o.coordinates[1]=c.y,o.radiusX=c.rx,o.radiusY=c.ry}}return e}},{key:"fromPathCommandList",value:function(e){for(var t="",n=Array.isArray(r=e),a=0,r=n?r:r[Symbol.iterator]();;){var i;if(n){if(a>=r.length)break;i=r[a++]}else{if((a=r.next()).done)break;i=a.value}var s=i;switch(t+=(""!==t?" ":"")+s.command,s.command.toUpperCase()){case"M":case"L":case"C":case"S":case"Q":case"T":t+=s.coordinates.join(",");break;case"H":t+=s.coordinates[0];break;case"V":t+=s.coordinates[1];break;case"A":t+="".concat(s.radiusX,",").concat(s.radiusY,",").concat(s.xAxisRotation,",").concat(s.largeArcFlag,",").concat(s.sweepFlag,",").concat(s.coordinates.join(","))}}return t}}]),e}(),ie=squared.lib.dom,se=function(e){return function(t){function n(){var e;return r(this,n),(e=f(this,u(n).apply(this,arguments))).baseValue={transformed:null},e}return l(n,e),s(n,[{key:"name",get:function(){return void 0===this._name&&(this._name=re.setName(this.element)),this._name}},{key:"transform",get:function(){return void 0===this._transform&&(this._transform=X(this.element)||re.toTransformList(this.element.transform.baseVal)),this._transform}},{key:"animate",get:function(){void 0===this._animate&&(this._animate=re.toAnimateList(this.element));for(var e=Array.isArray(n=this._animate),t=0,n=e?n:n[Symbol.iterator]();;){var a;if(e){if(t>=n.length)break;a=n[t++]}else{if((t=n.next()).done)break;a=t.value}a instanceof J&&(a.parent=this)}return this._animate}},{key:"visible",set:function(e){C(this.element,e)},get:function(){return O(this.element)}},{key:"opacity",set:function(e){P(this.element,e)},get:function(){return ie.cssAttribute(this.element,"opacity")||"1"}}]),n}()},oe=squared.lib.dom,le=function(e){return function(t){function n(){return r(this,n),f(this,u(n).apply(this,arguments))}return l(n,e),s(n,[{key:"setRect",value:function(){this.baseValue=Object.assign(this.baseValue||{},{x:this.x,y:this.y,width:this.width,height:this.height,transformed:null})}},{key:"getElement",value:function(){return this.element instanceof SVGSVGElement||this.element instanceof SVGUseElement||this.element instanceof SVGImageElement?this.element:void 0}},{key:"x",set:function(e){var t=this.getElement();t&&(t.x.baseVal.value=e)},get:function(){var e=this.getElement();return e?e.x.baseVal.value:0}},{key:"y",set:function(e){var t=this.getElement();t&&(t.y.baseVal.value=e)},get:function(){var e=this.getElement();return e?e.y.baseVal.value:0}},{key:"width",set:function(e){var t=this.getElement();t&&(t instanceof SVGSVGElement&&oe.isUserAgent(16)?this._width=e:t.width.baseVal.value=e)},get:function(){var e=this.getElement();return e?e instanceof SVGSVGElement&&oe.isUserAgent(16)?void 0!==this._width?this._width:e.getBoundingClientRect().width:e.width.baseVal.value:0}},{key:"height",set:function(e){var t=this.getElement();t&&(t instanceof SVGSVGElement&&oe.isUserAgent(16)?this._height=e:t.height.baseVal.value=e)},get:function(){var e=this.getElement();return e?e instanceof SVGSVGElement&&oe.isUserAgent(16)?void 0!==this._height?this._height:e.getBoundingClientRect().height:e.height.baseVal.value:0}}]),n}()},ue=function(e){function t(e){var n;return r(this,t),(n=f(this,u(t).call(this))).element=e,n}return l(t,squared.lib.base.Container),s(t,[{key:"build",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;this.clear();for(var n=0;n<this.element.children.length;n++){var a=this.element.children[n],r=void 0;if(a instanceof SVGSVGElement)r=new squared.svg.Svg(a,!1);else if(a instanceof SVGGElement)r=new squared.svg.SvgG(a);else if(a instanceof SVGUseElement){var i=F(a,a.parentElement);i&&(i instanceof SVGSymbolElement?r=new squared.svg.SvgUseSymbol(a,i):N(i)?r=new squared.svg.SvgImage(a,i):M(i)&&(r=new squared.svg.SvgUse(a,i)))}else N(a)?r=new squared.svg.SvgImage(a):M(a)&&(r=new squared.svg.SvgShape(a));r&&(r.build(e,t),this.append(r))}}},{key:"synchronize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.each(function(t){return t.synchronize(e)})}}]),t}(),ce=function(e){function t(e){var n;switch(r(this,t),(n=f(this,u(t).call(this,e))).getAttribute("type")){case"translate":n.type=SVGTransform.SVG_TRANSFORM_TRANSLATE;break;case"scale":n.type=SVGTransform.SVG_TRANSFORM_SCALE;break;case"rotate":n.type=SVGTransform.SVG_TRANSFORM_ROTATE;break;case"skewX":n.type=SVGTransform.SVG_TRANSFORM_SKEWX;break;case"skewY":n.type=SVGTransform.SVG_TRANSFORM_SKEWY;break;default:n.type=0}return n}return l(t,J),s(t,null,[{key:"toRotateList",value:function(e){var t=e.map(function(e){if(""===e)return[null,null,null];var t=re.toCoordinateList(e);return 1===t.length||3===t.length?t:[]});return t.some(function(e){return 0===e.length})?void 0:t}},{key:"toScaleList",value:function(e){var t=e.map(function(e){if(""===e)return[null,null];var t=re.toCoordinateList(e);return 1===t.length?[t[0],t[0]]:2===t.length?t:[]});return t.some(function(e){return 0===e.length})?void 0:t}},{key:"toTranslateList",value:function(e){var t=null,n=e.map(function(e){if(""===e)return[null,null];var n=re.toCoordinateList(e);return 1===n.length?[n[0],t]:2===n.length?(t=n[1],n):[]});return n.some(function(e){return 0===e.length})?void 0:n}}]),t}(),fe=function(){function e(t){r(this,e),this.element=t}return s(e,[{key:"build",value:function(){}},{key:"synchronize",value:function(){}}]),e}(),he=squared.lib.color,ve=squared.lib.dom,me=squared.lib.util,ye=function(e){return function(t){function n(){var e;return r(this,n),(e=f(this,u(n).apply(this,arguments))).fill="black",e.fillPattern="",e.fillOpacity="1",e.fillRule="nonzero",e.stroke="",e.strokeWidth="1",e.strokePattern="",e.strokeOpacity="1",e.strokeLinecap="butt",e.strokeLinejoin="miter",e.strokeMiterlimit="4",e.strokeDashArray="",e.strokeDashOffset="0",e.color="",e.clipPath="",e.clipRule="",e}return l(n,e),s(n,[{key:"setPaint",value:function(){var e=this.getAttribute("opacity");""!==e&&(this.opacity=""+Math.min(parseFloat(e),1)),this.setAttribute("color"),this.setColor("fill"),this.setOpacity("fill"),this.setAttribute("fill-rule"),this.setColor("stroke"),this.setOpacity("stroke"),this.setAttribute("stroke-width"),this.setAttribute("stroke-linecap"),this.setAttribute("stroke-linejoin"),this.setAttribute("stroke-miterlimit"),this.setAttribute("stroke-dasharray"),this.setAttribute("stroke-dashoffset");var t=me.REGEX_PATTERN.CSS_URL.exec(this.getAttribute("clip-path"));this.clipPath=t?t[1]:"",this.clipRule=this.getAttribute("clip-rule")}},{key:"setColor",value:function(e){var t=this.element,n=this.getAttribute(e),a=me.REGEX_PATTERN.CSS_URL.exec(n);if(a)this["".concat(e,"Pattern")]=a[1],n="";else if(""!==n)switch(n.toLowerCase()){case"none":case"transparent":case"rgba(0, 0, 0, 0)":n="";break;case"currentcolor":var r=he.parseRGBA(this.color||ve.cssAttribute(t,e,!0));n=r?r.valueRGB:null;break;default:var i=he.parseRGBA(n);i&&(n=i.valueRGB)}else"fill"===e&&(n=null);null!==n&&(this[e]=n)}},{key:"setOpacity",value:function(e){var t=this.getAttribute("".concat(e,"-opacity"));this["".concat(e,"Opacity")]=t?""+parseFloat(t)*parseFloat(this.opacity):this.opacity}},{key:"getAttribute",value:function(e){return ve.cssAttribute(this.element,e)||(this.parentElement?ve.cssAttribute(this.parentElement,e):"")}},{key:"setAttribute",value:function(e){var t=this.getAttribute(e);""!==t&&(this[me.convertCamelCase(e)]=t)}},{key:"opacity",set:function(e){P(this.element,e)},get:function(){return ve.cssAttribute(this.element,"opacity")||"1"}}]),n}()},ge=function e(t){r(this,e),this.element=t},pe=squared.lib.dom,be=function(e){function t(e,n){var a;return r(this,t),(a=f(this,u(t).call(this,e))).element=e,a.parentElement=n,a.name="",a.value="",a.baseValue={d:null,cx:null,cy:null,r:null,rx:null,ry:null,x1:null,x2:null,y1:null,y2:null,x:null,y:null,width:null,height:null,points:null,transformed:null},void 0===n&&(e.parentElement instanceof SVGGElement||e.parentElement instanceof SVGUseElement)&&(a.parentElement=e.parentElement),a.init(),a}return l(t,ye(ge)),s(t,[{key:"draw",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.element,i="";if(a&&(this.baseValue.transformed=null),r instanceof SVGPathElement){if(i=this.baseValue.d||pe.cssAttribute(r,"d"),e&&e.length){var s=re.toPathCommandList(i);if(s.length){var o=this.transformPoints(e,re.toAbsolutePointList(s));o.length&&(s=re.fromAbsolutePointList(s,o)).length&&(i=re.fromPathCommandList(s),this.baseValue.transformed=e)}}}else if(r instanceof SVGLineElement){var l=null!==this.baseValue.x1?this.baseValue.x1:r.x1.baseVal.value,u=null!==this.baseValue.y1?this.baseValue.y1:r.y1.baseVal.value,c=null!==this.baseValue.x2?this.baseValue.x2:r.x2.baseVal.value,f=null!==this.baseValue.y2?this.baseValue.y2:r.y2.baseVal.value;if(e&&e.length){var h=this.transformPoints(e,[{x:l,y:u},{x:c,y:f}]);h.length&&(i=t.getPolyline(h),this.baseValue.transformed=e)}""===i&&(i=t.getLine(l,u,c,f))}else if(r instanceof SVGCircleElement||r instanceof SVGEllipseElement){var v=null!==this.baseValue.cx?this.baseValue.cx:r.cx.baseVal.value,m=null!==this.baseValue.cy?this.baseValue.cy:r.cy.baseVal.value,g=0,p=0;if(r instanceof SVGCircleElement?p=g=null!==this.baseValue.r?this.baseValue.r:r.r.baseVal.value:r instanceof SVGEllipseElement&&(g=null!==this.baseValue.rx?this.baseValue.rx:r.rx.baseVal.value,p=null!==this.baseValue.ry?this.baseValue.ry:r.ry.baseVal.value),e&&e.length){var b=[{x:v,y:m,rx:g,ry:p}];if(n)if(-1!==e.findIndex(function(e){return e.type===SVGTransform.SVG_TRANSFORM_ROTATE})&&(g!==p||e.length>1&&e.some(function(e){return e.type===SVGTransform.SVG_TRANSFORM_SCALE&&e.matrix.a!==e.matrix.d}))){var d=y(re.partitionTransforms(this.element,e,!0),2);this.transformResidual=d[0],e=d[1]}if(e.length){var S=this.transformPoints(e,b);if(S.length){var A=S[0];i=t.getEllipse(A.x,A.y,A.rx,A.ry),this.baseValue.transformed=e}}}""===i&&(i=t.getEllipse(v,m,g,p))}else if(r instanceof SVGRectElement){var V=null!==this.baseValue.x?this.baseValue.x:r.x.baseVal.value,k=null!==this.baseValue.y?this.baseValue.y:r.y.baseVal.value,x=null!==this.baseValue.width?this.baseValue.width:r.width.baseVal.value,T=null!==this.baseValue.height?this.baseValue.height:r.height.baseVal.value;if(e&&e.length){var E=this.transformPoints(e,[{x:V,y:k},{x:V+x,y:k},{x:V+x,y:k+T},{x:V,y:k+T}]);E.length&&(i=t.getPolygon(E),this.baseValue.transformed=e)}""===i&&(i=t.getRect(x,T,V,k))}else if(r instanceof SVGPolygonElement||r instanceof SVGPolylineElement){var G=null!==this.baseValue.points?this.baseValue.points:re.toPointList(r.points);if(e&&e.length){var w=this.transformPoints(e,G);w.length&&(G=w,this.baseValue.transformed=e)}i="polygon"===r.tagName?t.getPolygon(G):t.getPolyline(G)}return a&&(this.value=i),i}},{key:"transformPoints",value:function(e,t,n){return re.applyTransforms(e,t,z(this.element),n)}},{key:"init",value:function(){var e=this.element;e instanceof SVGPathElement?this.baseValue.d=pe.cssAttribute(e,"d"):e instanceof SVGLineElement?(this.baseValue.x1=e.x1.baseVal.value,this.baseValue.y1=e.y1.baseVal.value,this.baseValue.x2=e.x2.baseVal.value,this.baseValue.y2=e.y2.baseVal.value):e instanceof SVGRectElement?(this.baseValue.x=e.x.baseVal.value,this.baseValue.y=e.y.baseVal.value,this.baseValue.width=e.width.baseVal.value,this.baseValue.height=e.height.baseVal.value):e instanceof SVGCircleElement?(this.baseValue.cx=e.cx.baseVal.value,this.baseValue.cy=e.cy.baseVal.value,this.baseValue.r=e.r.baseVal.value):e instanceof SVGEllipseElement?(this.baseValue.cx=e.cx.baseVal.value,this.baseValue.cy=e.cy.baseVal.value,this.baseValue.rx=e.rx.baseVal.value,this.baseValue.ry=e.ry.baseVal.value):(e instanceof SVGPolygonElement||e instanceof SVGPolylineElement)&&(this.baseValue.points=re.toPointList(e.points)),this.setPaint()}}],[{key:"getLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return"M".concat(e,",").concat(t," L").concat(n,",").concat(a)}},{key:"getCircle",value:function(e,n,a){return t.getEllipse(e,n,a)}},{key:"getEllipse",value:function(e,t,n,a){return void 0===a&&(a=n),"M".concat(e-n,",").concat(t," a").concat(n,",").concat(a,",0,1,0,").concat(2*n,",0 a").concat(n,",").concat(a,",0,1,0,-").concat(2*n,",0")}},{key:"getRect",value:function(e,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return"M".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,",").concat(n," h").concat(e," v").concat(t," h").concat(-e," Z")}},{key:"getPolygon",value:function(e){var n=t.getPolyline(e);return""!==n?n+" Z":""}},{key:"getPolyline",value:function(e){return e.length?"M".concat(e.map(function(e){return"".concat(e.x,",").concat(e.y)}).join(" ")):""}}]),t}(),de=squared.lib.util;function Se(e,t,n,a,r){return e+(n[r]+a)*t}function Ae(e,t,n,a,r,i){for(var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=(i-(a+t.duration*r))/t.duration,l=t.keyTimes,u=-1,c=-1,f=0;f<l.length;f++){if(-1!==u&&o<=l[f]){c=f;break}o>=l[f]&&(u=f)}for(var h,v=i+s;e.has(v);)v++;return h=-1!==u&&-1!==c?Ve(o,l[u],l[c],Ge(t,u,n,r),Ge(t,c,n,r)):Ge(t,l.length-1,n,r),e.set(v,h),[v,h]}function Ve(e,t,n,a,r){if("number"==typeof a&&"number"==typeof r)return a+(e-t)/(n-t)*(r-a);if(Array.isArray(a)&&Array.isArray(r)){for(var i=a,s=r,o=[],l=0;l<Math.min(i.length,s.length);l++)o.push({x:Ve(e,t,n,i[l].x,s[l].x),y:Ve(e,t,n,i[l].y,s[l].y)});return o}return a}function ke(e,t,n){var a,r,i=e.entries(),s=Array.isArray(i),o=0;for(i=s?i:i[Symbol.iterator]();;){var l;if(s){if(o>=i.length)break;l=i[o++]}else{if((o=i.next()).done)break;l=o.value}var u=y(l,2),c=u[0],f=u[1];if(a&&n<=c){r={time:c,value:f};break}n>=c&&(a={time:c,value:f})}if(a&&r){var h=Ve(n,a.time,r.time,a.value,r.value);t.set(n,h)}else a&&t.set(n,a.value)}function xe(e,t){var n=new Map,a=e.entries(),r=Array.isArray(a),i=0;for(a=r?a:a[Symbol.iterator]();;){var s;if(r){if(i>=a.length)break;s=a[i++]}else{if((i=a.next()).done)break;s=i.value}var o=y(s,2),l=o[1],u=o[0]/t;if(u>0)for(var c=5;;c++){var f=parseFloat((""+u).substring(0,c));if(!n.has(f)){u=f;break}}n.set(u,l)}return n}function Te(e,n,a){var r,i,s=[],o=n.element.tagName;switch(o){case"line":r="getLine",i=["x1","y1","x2","y2"];break;case"circle":r="getCircle",i=["cx","cy","r"];break;case"ellipse":r="getEllipse",i=["cx","cy","rx","ry"];break;case"rect":r="getRect",i=["width","height","x","y"];break;case"polygon":r="getPolygon",i=["points"];break;case"polyline":r="getPolyline",i=["points"];break;default:return}var l=function(){if(c){if(f>=u.length)return"break";h=u[f++]}else{if((f=u.next()).done)return"break";h=f.value}var e=y(h,2),t=e[0],l=e[1],v=[];if(i.forEach(function(e){l.has(e)?v.push(l.get(e)):a&&a[e]?v.push(a[e].value):null!==n.baseValue[e]&&v.push(n.baseValue[e])}),v.length!==i.length)return{v:void 0};var m,g=n.baseValue.transformed;if(g&&g.length)switch(o){case"line":m=be.getPolyline(re.applyTransforms(g,function(e){return[{x:e[0],y:e[1]},{x:e[2],y:e[4]}]}(v),z(n.element)));break;case"circle":case"ellipse":var p=re.applyTransforms(g,function(e){return[{x:e[0],y:e[1],rx:e[2],ry:e[e.length-1]}]}(v),z(n.element));if(p.length){var b=p[0];m=be.getEllipse(b.x,b.y,b.rx,b.ry)}break;case"rect":m=be.getPolygon(re.applyTransforms(g,function(e){var t=e[0],n=e[1],a=e[2],r=e[3];return[{x:a,y:r},{x:a+t,y:r},{x:a+t,y:r+n},{x:a,y:r+n}]}(v),z(n.element)));break;case"polygon":m=be.getPolygon(re.applyTransforms(g,v[0],z(n.element)));break;case"polyline":m=be.getPolyline(re.applyTransforms(g,v[0],z(n.element)))}void 0===m&&(m=be[r].apply(null,v)),s.push({time:t,value:m})};var u=e.entries(),c=Array.isArray(u),f=0;e:for(u=c?u:u[Symbol.iterator]();;){var h,v=l();switch(v){case"break":break e;default:if("object"===t(v))return v.v}}return s}function Ee(e,t,n){for(var a=new Map,r=Array.isArray(s=t),i=0,s=r?s:s[Symbol.iterator]();;){var o;if(r){if(i>=s.length)break;o=s[i++]}else{if((i=s.next()).done)break;o=i.value}var l=o,u=new Map;for(var c in e){var f=e[c].get(l);void 0!==f&&u.set(c,f)}if(n)for(var h in n)!u.has(h)&&l>=n[h].time&&u.set(h,n[h].value);a.set(l,u)}return a}function Ge(e,t,n){return"number"==typeof n?function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=parseFloat(e.values[t]);if(e.additiveSum){r+=n,e.accumulateSum||(a=0);for(var i=0;i<a;i++)for(var s=0;s<e.values.length;s++)r+=parseFloat(e.values[s])}return r}(e,t,n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0):function(e,t){return re.fromPointsValue(e.values[t])}(e,t)}var we=function(e){function n(e){var t;return r(this,n),(t=f(this,u(n).call(this,e))).element=e,t.setType(),0!==t.type&&(t.path=new be(e)),t}return l(n,se(fe)),s(n,[{key:"setType",value:function(e){this.type=E[(e||this.element).tagName]||0}},{key:"build",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;this.path&&this.path.draw(re.filterTransforms(this.transform,t?t[this.path.element.tagName]:void 0),e)}},{key:"synchronize",value:function(){this.path&&this.animate.length&&n.synchronizeAnimate(this.element,this.animate,arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.path)}},{key:"path",set:function(e){this._path=e,this._path&&(this._path.name=this.name);for(var t=Array.isArray(a=this.animate),n=0,a=t?a:a[Symbol.iterator]();;){var r;if(t){if(n>=a.length)break;r=a[n++]}else{if((n=a.next()).done)break;r=n.value}r instanceof J&&(r.parent=e)}},get:function(){return this._path}}],[{key:"synchronizeAnimate",value:function(e,n){for(var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i=[],s=e.tagName,o=!1,l=Array.isArray(c=n),u=0,c=l?c:c[Symbol.iterator]();;){var f;if(l){if(u>=c.length)break;f=c[u++]}else{if((u=c.next()).done)break;f=u.value}var h=f;if(h instanceof J&&h.keyTimes.length>1&&h.duration>0&&h.begin.length)switch(h.attributeName){case"r":case"cx":case"cy":if("circle"===s){i.push(h);break}case"rx":case"ry":"ellipse"===s&&i.push(h);break;case"x1":case"x2":case"y1":case"y2":"line"===s&&i.push(h);break;case"points":"polyline"!==s&&"polygon"!==s||(i.push(h),o=!0);break;case"x":case"y":if(e instanceof SVGSVGElement||e instanceof SVGUseElement){i.push(h),r=void 0;break}case"width":case"height":"rect"===s&&i.push(h)}}return(i.length>1||i.some(function(e){return e.begin.length>1||"0-1"!==e.keyTimes.join("-")||void 0!==e.end||e.additiveSum}))&&function(){for(var s={},l=0,u=0;u<i.length;u++){var c=i[u],f=c.attributeName;void 0===s[f]&&(s[f]=new Map);for(var h=s[f],v=Array.isArray(p=c.begin),m=0,p=v?p:p[Symbol.iterator]();;){var b;if(v){if(m>=p.length)break;b=p[m++]}else{if((m=p.next()).done)break;b=m.value}var d=b,S=h.get(d)||{duration:0,items:[]};S.items.push(c),h.set(d,S)}}for(var A in s){var V=s[A],k=Number.MAX_VALUE,x=function(){if(E){if(G>=T.length)return"break";w=T[G++]}else{if((G=T.next()).done)return"break";w=G.value}var e=y(w,2),t=e[0],n=e[1],a=n.items.length-1,r=[];do{for(var i=n.items[a],s=-1===i.repeatCount||i.fillFreeze,o=i.duration*i.repeatCount,l=0;l<a;l++){var u=n.items[l];(s||-1!==u.repeatCount&&u.duration*u.repeatCount<=o)&&r.push(u)}if(i.fillFreeze&&-1!==i.repeatCount&&(k=Math.min(t+o,k)),s)break}while(--a>=0);n.items=n.items.filter(function(e){return!r.includes(e)}),V.set(t,n)},T=V.entries(),E=Array.isArray(T),G=0;for(T=E?T:T[Symbol.iterator]();;){var w;if("break"===x())break}var R=new Map,_=U(Array.from(V.keys())),M=Array.isArray(_),N=0;for(_=M?_:_[Symbol.iterator]();;){var O;if(M){if(N>=_.length)break;O=_[N++]}else{if((N=_.next()).done)break;O=N.value}var C=O,P=V.get(C);if(P){var F=de.maxArray(P.items.map(function(e){return e.duration*(-1===e.repeatCount?1:e.repeatCount)}));l=Math.max(l,C+F),P.duration=F,P.items.reverse(),R.set(C,P)}}s[A]=R}var L,I,q={},j={},X={},z=new Set,W=new Set,Y={},D=!1,K=0,H=function(e){q[e]=new Map;var n=[],a=Array.from(s[e].keys()),i=Array.from(s[e].values()),u=-1,c=r&&r.baseValue[e]||(o?[{x:0,y:0}]:0);e:{for(var f=function(r){for(var s=a[r],o=i[r],f=0,h=r+1;h<a.length;h++)f=Math.max(f,a[h]+i[h].duration);for(var v=function(t){var i=o.items[t],h=-1===i.repeatCount,v=i.duration,m=i.repeatCount,y=v;if(!h&&s+Math.min(i.end||Number.MAX_VALUE,y*=m)<=u)return"continue";var g=void 0,p=void 0;h?(g=Math.ceil((l-s)/v),p=0):(g=Math.ceil(m),p=m-Math.floor(m));var b=Math.min(a[r+1]||Number.MAX_VALUE,i.end||Number.MAX_VALUE),d=!0,S=-1!==u,A=void 0;t:for(var V=function(t){for(var n=0;n<i.keyTimes.length;n++){var o=void 0,l=Ge(i,n,c,t);if(t===g-1&&p>0)if(p>i.keyTimes[n]){for(var f=n+1;f<i.keyTimes.length;f++)if(p<i.keyTimes[f]){o=s+y,l=Ve(p,i.keyTimes[n],i.keyTimes[f],l,Ge(i,f,c,t)),p=-1;break}}else p===i.keyTimes[n]&&(p=-1);if(void 0===o)if((o=Se(s,v,i.keyTimes,t,n))===b)d=t===g-1&&n===i.keyTimes.length-1;else{var h=function(n,o){var l=Ae(q[e],i,c,s,t,o,n&&o===a[r+1]&&!q[e].has(o-1)?-1:0);u=l[0],A=l[1]};if(o>b)return h(!0,b),d=!1,"break|threadTimeExceeded";if(S){if(s>=u)o=Math.max(s,u+1);else{if(o<u)continue;o===u?o=u+1:h(!1,u)}S=!1}else if(t>0&&0===n){if(i.additiveSum&&i.accumulateSum){u=o;continue}o=Math.max(o,u+1)}}if(o>u&&(u=o,A=l,q[e].set(o,l)),!d||-1===p)return"break|threadTimeExceeded"}},k=Math.floor(Math.max(0,u-s)/v);k<g;k++){if("break|threadTimeExceeded"===V(k))break t}if(void 0!==A){h||z.add(i),c=A;var x=q[e].get(u);if(void 0!==x&&d&&i.fillFreeze)return Y[e]={time:u,value:x},{v:"break|animationEnd"}}h&&(n.forEach(function(e){return W.delete(e.value)}),n.length=0,W.add(i)),(h||!d&&a[r]+y>f)&&n.push({time:s,value:i})},m=0;m<o.items.length;m++){var y=v(m);switch(y){case"continue":continue;default:if("object"===t(y))return y.v}}},h=0;h<a.length;h++){if("break|animationEnd"===f(h))break e}if(n.length){n.reverse();for(var v=function(t){var a=n[t].time,r=n[t].value,i=r.duration,s=u-a,o=Number.MAX_VALUE,l=function(){var t=Math.floor(s/i),n=!1;do{for(var l=0;l<r.keyTimes.length;l++){var f=Se(a,i,r.keyTimes,t,l),h=f>=o;if(f>=u||h){var v=Ae(q[e],r,c,a,t,u);if(u=v[0],c=v[1],n=!0,h){o>u&&(v=Ae(q[e],r,c,a,t,o),u=v[0],c=v[1]);break}}else f>u&&(u=f,c=Ge(r,l,c,t),q[e].set(f,c))}t++}while(!n)};if(-1===r.repeatCount){s>0&&s%i!=0&&l(),j[e]=new Map,X[e]=s<=0?a:0;for(var f=0;f<r.keyTimes.length;f++)j[e].set(r.keyTimes[f]*r.duration,Ge(r,f,0,0));return a>0&&(D=!0),"break|animationEnd"}if((o=a+r.duration*r.repeatCount)>u&&(l(),r.fillFreeze))return Y[e]={time:u,value:c},"break|animationEnd"},m=0;m<n.length;m++){if("break|animationEnd"===v(m))break e}}}};for(var Z in s)H(Z);var $=[];for(var Q in q)$.push.apply($,g(q[Q].keys()));var ee=de.maxArray($);for(var te in q){var ne=q[te],ae=X[te]||0,re=de.maxArray(Array.from(ne.keys()));if(j[te]&&ae<ee&&re<ee){do{var ie=-1,se=j[te].entries(),oe=Array.isArray(se),le=0;for(se=oe?se:se[Symbol.iterator]();;){var ue;if(oe){if(le>=se.length)break;ue=se[le++]}else{if((le=se.next()).done)break;ue=le.value}var fe=y(ue,2),he=fe[1];ie=re+ae+fe[0],ie+=ne.has(ie)?1:0,ne.set(ie,he),$.push(ie)}re=ie}while(re<ee);X[te]=0}if(void 0===j[te]&&void 0===Y[te]){var ve=void 0,me=void 0;if(r&&null!==r.baseValue[te])ve=r.baseValue[te],me=ne.get(re)!==ve;else{var ye=de.optionalAsObject(e,"".concat(te,".baseVal.value"));"number"==typeof ye?(ve=ye,me=ne.get(re)!==ve):Array.isArray(ye)?(ve=ye,me=JSON.stringify(ne.get(re))!==JSON.stringify(ve)):me=!1}me&&(ne.set(++re,ve),$.push(re))}}var ge,pe=U(Array.from(new Set($))),be={};for(var we in q){for(var Re=q[we],_e=new Map,Me=Array.from(Re.keys()).pop(),Ne=0;Ne<pe.length;Ne++){var Oe=pe[Ne];if(Oe<=Me){var Ce=Re.get(Oe);void 0===Ce?ke(Re,_e,Oe):_e.set(Oe,Ce)}}be[we]=_e}if(l=pe[pe.length-1],ge=a?xe(Ee(be,pe,Y),l):Ee(be,pe,Y),z.size||0===W.size||D?L=ge:(I=ge,K=l),void 0===I&&W.size){var Pe=Array.from(W);K=B(Pe.map(function(e){return e.duration}));var Fe={},Le=[],Ie=function(e){Fe[e]=new Map;var t=Pe.find(function(t){return t.attributeName===e});if(t){var n=0,a=0;do{var r=j[e].entries(),i=Array.isArray(r),s=0;for(r=i?r:r[Symbol.iterator]();;){var o;if(i){if(s>=r.length)break;o=r[s++]}else{if((s=r.next()).done)break;o=s.value}var l=y(o,2),u=l[0];Fe[e].set(u+=t.duration*a,l[1]),Le.push(u),n=u}a++}while(n<K)}};for(var qe in j)Ie(qe);for(var je in Le=U(Array.from(new Set(Le))),Fe)for(var Xe=Fe[je],ze=1;ze<Le.length;ze++){var Ue=Le[ze];Xe.has(Ue)||ke(Xe,Xe,Ue)}I=a?xe(Ee(Fe,Le),Le[Le.length-1]):Ee(Fe,Le)}if(L||I){de.retainArray(n,function(e){return!i.includes(e)});var Be=Array.from(new Set(i.map(function(e){return e.attributeName}))).sort().join("-"),We=0,Ye=0;void 0===r&&(We=de.optionalAsNumber(e,"x.baseVal.value"),Ye=de.optionalAsNumber(e,"y.baseVal.value")),[L,I].forEach(function(e){if(e){var i=function(){var t=function(e){e.has("x")?We=e.get("x"):e.set("x",We),e.has("y")?Ye=e.get("y"):e.set("y",Ye)},i=function(e){s?e.repeatCount=0:(e.begin=[0],e.repeatCount=-1),e.end=void 0,e.from=e.values[0],e.to=e.values[e.values.length-1],e.by="",n.push(e)},s=e===L,o=s?void 0:Y,u=(s&&z.size>0||0===W.size?z:W).values().next().value.element;if(a){var c;if(r){var f=Te(e,r,o);if(!f)return{v:void 0};(c=new J(u)).attributeName="d",c.keyTimes=f.map(function(e){return e.time}),c.values=f.map(function(e){return""+e.value})}else{(c=new ce(u)).attributeName="transform",c.type=SVGTransform.SVG_TRANSFORM_TRANSLATE,c.keyTimes.length=0,c.values.length=0;var h=e.entries(),v=Array.isArray(h),m=0;for(h=v?h:h[Symbol.iterator]();;){var g;if(v){if(m>=h.length)break;g=h[m++]}else{if((m=h.next()).done)break;g=m.value}var p=y(g,2),b=p[0];t(p[1]),c.keyTimes.push(b),c.values.push("".concat(We," ").concat(Ye))}}s?(c.begin=[0],c.duration=l):c.duration=K,i(c)}else for(var d=Array.from(e.entries()),S=0,A=0;S<d.length-1;S++){var V=y(d[S],2),k=V[0],x=V[1],T=y(d[S+1],2),E=T[0],G=T[1],w=void 0,R=void 0;if(r){var _=new Map;_.set(k,x),_.set(E,G);var M=Te(_,r,o);if(!M)continue;(w=new J(u)).attributeName="d",w.values=M.map(function(e){return""+e.value}),R=Be}else(w=new ce(u)).attributeName="transform",w.type=SVGTransform.SVG_TRANSFORM_TRANSLATE,w.values=[x,G].map(function(e){return t(e),"".concat(We," ").concat(Ye)}),R=Be+S;s&&(w.begin=[0===S?k:0]),w.duration=E-k,w.keyTimes=[0,1],w.sequential={name:R,value:A++},i(w)}}();if("object"===t(i))return i.v}})}}(),n}}]),n}(),Re=function(e){function t(e){var n,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return r(this,t),(n=f(this,u(t).call(this,e))).element=e,n.documentRoot=a,n.patterns={clipPath:new Map,gradient:new Map},n.init(),n.setRect(),n}return l(t,le(se(ue))),s(t,[{key:"synchronize",value:function(){!this.documentRoot&&this.animate.length&&we.synchronizeAnimate(this.element,this.animate,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}},{key:"init",value:function(){var e=this;[this.element].concat(g(Array.from(this.element.querySelectorAll(":scope > defs")))).forEach(function(t){t.querySelectorAll(":scope > set, :scope > animate, :scope > animateTransform, :scope > animateMotion").forEach(function(t){var n=F(t,e.element);n&&(t.parentElement&&t.parentElement.removeChild(t),n.appendChild(t))}),t.querySelectorAll(":scope > clipPath, :scope > linearGradient, :scope > radialGradient").forEach(function(t){if(t.id){var n="#".concat(t.id);t instanceof SVGClipPathElement?e.patterns.clipPath.set(n,t):t instanceof SVGLinearGradientElement?e.patterns.gradient.set(n,{type:"linear",x1:t.x1.baseVal.value,x2:t.x2.baseVal.value,y1:t.y1.baseVal.value,y2:t.y2.baseVal.value,x1AsString:t.x1.baseVal.valueAsString,x2AsString:t.x2.baseVal.valueAsString,y1AsString:t.y1.baseVal.valueAsString,y2AsString:t.y2.baseVal.valueAsString,colorStop:re.toColorStopList(t)}):t instanceof SVGRadialGradientElement&&e.patterns.gradient.set(n,{type:"radial",cx:t.cx.baseVal.value,cy:t.cy.baseVal.value,r:t.r.baseVal.value,cxAsString:t.cx.baseVal.valueAsString,cyAsString:t.cy.baseVal.valueAsString,rAsString:t.r.baseVal.valueAsString,fx:t.fx.baseVal.value,fy:t.fy.baseVal.value,fxAsString:t.fx.baseVal.valueAsString,fyAsString:t.fy.baseVal.valueAsString,colorStop:re.toColorStopList(t)})}})})}},{key:"viewBox",get:function(){return this.element.viewBox.baseVal}}]),t}(),_e=squared.lib.util,Me=function(e){function t(e){var n;r(this,t),(n=f(this,u(t).call(this,e))).path="",n.keyPoints=[],n.rotate=0,n.rotateAuto=!1,n.rotateAutoReverse=!1,n.setAttribute("path");var a=n.getAttribute("rotate");switch(a){case"auto":n.rotateAuto=!0;break;case"auto-reverse":n.rotateAutoReverse=!0;break;default:n.rotate=_e.convertInt(a)}if(n.keyTimes.length){var i=n.getAttribute("keyPoints");if(i){var s=J.toFractionList(i);s.length===n.keyTimes.length&&(n.keyPoints=s)}}for(var o=0;o<e.children.length;o++){var l=e.children[o];if("mpath"===l.tagName){var c=F(l);if(c){n.mpath=c;break}}}return n}return l(t,J),t}(),Ne=function(e){function t(e){var n;return r(this,t),(n=f(this,u(t).call(this,e))).element=e,n.setPaint(),n}return l(t,ye(se(ue))),t}(),Oe=squared.lib.util,Ce=function(e){function t(e,n){var a;return r(this,t),(a=f(this,u(t).call(this,e))).element=e,a.imageElement=n,a.setRect(),a}return l(t,le(se(fe))),s(t,[{key:"extract",value:function(e){var t=re.filterTransforms(this.transform,e);if(t.length){var n=this.x,a=this.y,r=this.width,i=this.height;t.reverse();for(var s=0;s<t.length;s++){var o=t[s],l=o.matrix,u=n;switch(n=W(l,u,a),a=Y(l,u,a),o.type){case SVGTransform.SVG_TRANSFORM_SCALE:r*=l.a,i*=l.d;break;case SVGTransform.SVG_TRANSFORM_ROTATE:0!==o.angle&&(l.a<0&&(n+=l.a*r),l.c<0&&(n+=l.c*r),l.b<0&&(a+=l.b*i),l.d<0&&(a+=l.d*i),void 0===this.rotateOrigin?this.rotateOrigin={angle:o.angle,x:0,y:0}:this.rotateOrigin.angle=(this.rotateOrigin.angle||0)+o.angle)}}Object.assign(this.baseValue,{x:n,y:a,width:r,height:i,transform:t})}}},{key:"x",get:function(){var e=v(u(t.prototype),"x",this);return 0===e&&this.imageElement?this.imageElement.x.baseVal.value:e}},{key:"y",get:function(){var e=v(u(t.prototype),"y",this);return 0===e&&this.imageElement?this.imageElement.y.baseVal.value:e}},{key:"width",get:function(){var e=v(u(t.prototype),"width",this);return 0===e&&this.imageElement?this.imageElement.width.baseVal.value:e}},{key:"height",get:function(){var e=v(u(t.prototype),"height",this);return 0===e&&this.imageElement?this.imageElement.height.baseVal.value:e}},{key:"href",set:function(e){var t=this.imageElement||this.element;t instanceof SVGImageElement&&(t.href.baseVal=e)},get:function(){var e=this.imageElement||this.element;return e instanceof SVGImageElement?Oe.resolvePath(e.href.baseVal):""}}]),t}(),Pe=function(e){function t(e,n){var a;return r(this,t),(a=f(this,u(t).call(this,e))).element=e,a.shapeElement=n,a.setPaint(),a}return l(t,ye(le(we))),s(t,[{key:"setShape",value:function(e){this.shapeElement=e,this.setType(e),this.path=void 0}},{key:"build",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;if(void 0===this.path){var a=new be(this.shapeElement,this.element);!function(e,t,n,a,r){if(!m(e,t,n,a||e)&&r)throw Error("failed to set property")}(u(t.prototype),"path",a,this,!0)}v(u(t.prototype),"build",this).call(this,e,n)}},{key:"href",set:function(e){if("#"===e.charAt(0)){var t=e.substring(1),n=document.getElementById(t);n&&M(n)&&(this.setShape(n),this.element.href.baseVal=e)}},get:function(){return this.element.href.baseVal}}]),t}(),Fe=function(e){function t(e,n){var a;return r(this,t),(a=f(this,u(t).call(this,e))).element=e,a.symbolElement=n,a.setRect(),a.setPaint(),a}return l(t,ye(le(se(ue)))),s(t,[{key:"synchronize",value:function(){this.animate.length&&we.synchronizeAnimate(this.element,this.animate,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}},{key:"viewBox",get:function(){return this.symbolElement.viewBox.baseVal}}]),t}(),Le={util:H};e.Svg=Re,e.SvgAnimate=J,e.SvgAnimateMotion=Me,e.SvgAnimateTransform=ce,e.SvgAnimation=$,e.SvgBase=ge,e.SvgBuild=re,e.SvgContainer=ue,e.SvgElement=fe,e.SvgG=Ne,e.SvgImage=Ce,e.SvgPaint=ye,e.SvgPath=be,e.SvgShape=we,e.SvgUse=Pe,e.SvgUseSymbol=Fe,e.SvgView=se,e.SvgViewRect=le,e.lib=Le,Object.defineProperty(e,"__esModule",{value:!0})});
