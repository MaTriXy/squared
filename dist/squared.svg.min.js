!function(a,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(((a=a||self).squared=a.squared||{},a.squared.svg={}))}(this,function(a){"use strict";function n(a){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function t(a){this.wrapped=a}function s(a){var n,s;function l(n,s){try{var o=a[n](s),r=o.value,f=r instanceof t;Promise.resolve(f?r.wrapped:r).then(function(a){f?l("next",a):h(o.done?"return":"normal",a)},function(a){l("throw",a)})}catch(a){h("throw",a)}}function h(a,t){switch(a){case"return":n.resolve({value:t,done:!0});break;case"throw":n.reject(t);break;default:n.resolve({value:t,done:!1})}(n=n.next)?l(n.key,n.arg):s=null}this._invoke=function(a,t){return new Promise(function(h,o){var r={key:a,arg:t,resolve:h,reject:o,next:null};s?s=s.next=r:(n=s=r,l(a,t))})},"function"!=typeof a.return&&(this.return=void 0)}function l(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function h(a,n){for(var t=0;t<n.length;t++){var s=n[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(a,s.key,s)}}function o(a,n,t){return n&&h(a.prototype,n),t&&h(a,t),a}function r(a,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),n&&c(a,n)}function f(a){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function c(a,n){return(c=Object.setPrototypeOf||function(a,n){return a.__proto__=n,a})(a,n)}function b(a,n){return!n||"object"!=typeof n&&"function"!=typeof n?function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(a):n}"function"==typeof Symbol&&Symbol.asyncIterator&&(s.prototype[Symbol.asyncIterator]=function(){return this}),s.prototype.next=function(a){return this._invoke("next",a)},s.prototype.throw=function(a){return this._invoke("throw",a)},s.prototype.return=function(a){return this._invoke("return",a)};function y(a,n){return v(a)||function(a,n){var t=[],s=!0,l=!1,h=void 0;try{for(var o,r=a[Symbol.iterator]();!(s=(o=r.next()).done)&&(t.push(o.value),!n||t.length!==n);s=!0);}catch(a){l=!0,h=a}finally{try{s||null==r.return||r.return()}finally{if(l)throw h}}return t}(a,n)||d()}function u(a){return function(a){if(Array.isArray(a)){for(var n=0,t=Array(a.length);n<a.length;n++)t[n]=a[n];return t}}(a)||e(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function v(a){if(Array.isArray(a))return a}function e(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var w=squared.lib.dom,g=squared.lib.util;function V(a){switch(a.tagName){case"path":case"circle":case"ellipse":case"line":case"rect":case"polygon":case"polyline":return!0}return!1}function A(a){return"image"===a.tagName}function R(a){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=w.cssAttribute(a,"transform-origin");if(""!==t){var s,l,h=a.parentElement;if(h instanceof SVGSVGElement)s=h.viewBox.baseVal.width,l=h.viewBox.baseVal.height;else{if(!(h instanceof SVGGElement&&h.viewportElement instanceof SVGSVGElement))return;s=h.viewportElement.viewBox.baseVal.width,l=h.viewportElement.viewBox.baseVal.height}var o=t.split(" ");1===o.length&&o.push("center"),o=o.slice(0,2);var r={x:null,y:null};if(o.includes("left")?r.x=0:o.includes("right")&&(r.x=s),o.includes("top")?r.y=0:o.includes("bottom")&&(r.y=l),["x","y"].forEach(function(t){if(null===r[t])for(var h=0;h<o.length;h++){var f=o[h];if(""!==f&&("center"===f&&(f="50%"),g.isUnit(f)?r[t]=parseInt(f.endsWith("px")?f:g.convertPX(f,n,g.convertInt(w.getStyle(a).fontSize))):g.isPercent(f)&&(r[t]=("x"===t?s:l)*(parseInt(f)/100)),null!==r[t])){o[h]="";break}}}),r.x||r.y)return r.x=r.x||0,r.y=r.y||0,r}}function E(a){var n=a.slice().sort(function(a,n){return a<n?-1:1});if(n.length>1){for(var t=n.splice(0,1)[0],s=t,l=!1;!l;)for(var h=Array.isArray(r=n),o=0,r=h?r:r[Symbol.iterator]();;){var f;if(h){if(o>=r.length)break;f=r[o++]}else{if((o=r.next()).done)break;f=o.value}if(!(s>=f&&s%f==0)){l=!1,s+=t;break}l=!0}return s}return n[0]}function G(a,n,t){return a.a*n+a.c*t+a.e}function C(a,n,t){return a.b*n+a.d*t+a.f}function N(a,n){return n*Math.cos(a*Math.PI/180)*-1}function I(a){var n=w.cssAttribute(a,"visibility",!0);return"hidden"!==n&&"collapse"!==n&&"none"!==w.cssAttribute(a,"display",!0)}var L=Object.freeze({isSvgShape:V,isSvgImage:A,createTransformData:function(a){for(var n={operations:[],translateX:0,translateY:0,scaleX:1,scaleY:1,rotateAngle:0,skewX:0,skewY:0,origin:R(a)},t=0;t<a.transform.baseVal.numberOfItems;t++){var s=a.transform.baseVal.getItem(t);if(!n.operations.includes(s.type))switch(s.type){case SVGTransform.SVG_TRANSFORM_TRANSLATE:0===s.matrix.e&&0===s.matrix.f||(n.translateX=s.matrix.e,n.translateY=s.matrix.f,n.operations.push(s.type));break;case SVGTransform.SVG_TRANSFORM_SCALE:1===s.matrix.a&&1===s.matrix.d||(n.scaleX=s.matrix.a,n.scaleY=s.matrix.d,n.operations.push(s.type));break;case SVGTransform.SVG_TRANSFORM_ROTATE:if(0!==s.angle){n.rotateAngle=s.angle;var l=a.attributes.getNamedItem("transform");if(l&&l.nodeValue){var h=/rotate\((\d+), (\d+), (\d+)\)/.exec(l.nodeValue);h&&(n.rotateOriginX=parseInt(h[2]),n.rotateOriginY=parseInt(h[3]))}n.matrixRotate=s.matrix,n.operations.push(s.type)}break;case SVGTransform.SVG_TRANSFORM_SKEWX:0!==s.angle&&(n.skewX+=s.angle,n.matrixSkewX=s.matrix,n.operations.push(s.type));break;case SVGTransform.SVG_TRANSFORM_SKEWY:0!==s.angle&&(n.skewY+=s.angle,n.matrixSkewY=s.matrix,n.operations.push(s.type))}}return n},getTransformOrigin:R,getLeastCommonMultiple:E,applyMatrixX:G,applyMatrixY:C,getRadiusX:function(a,n){return n*Math.sin(a*Math.PI/180)},getRadiusY:N,isVisible:I}),O=squared.lib.color,P=squared.lib.dom,p={},F=function(){function a(){l(this,a)}return o(a,null,[{key:"setName",value:function(a){var n,t="";return a.id?(void 0===p[a.id]&&(t=a.id),n=a.id):n=a.tagName,void 0===p[n]&&(p[n]=0),""!==t?t:"".concat(n,"_").concat(++p[n])}},{key:"applyTransforms",value:function(a,n,t){for(var s=[],l=Array.isArray(o=n),h=0,o=l?o:o[Symbol.iterator]();;){var r;if(l){if(h>=o.length)break;r=o[h++]}else{if((h=o.next()).done)break;r=h.value}s.push({x:r.x,y:r.y})}for(var f=a.numberOfItems-1;f>=0;f--){var c=a.getItem(f),b=0,y=0,u=0,v=0,e=0,d=0;if(t)switch(c.type){case SVGTransform.SVG_TRANSFORM_SCALE:b+=t.x,v+=t.y;break;case SVGTransform.SVG_TRANSFORM_SKEWX:y-=t.y;break;case SVGTransform.SVG_TRANSFORM_SKEWY:u-=t.x;break;case SVGTransform.SVG_TRANSFORM_ROTATE:u-=t.x,y-=t.y,e=t.x+N(c.angle,t.x),d=t.y+N(c.angle,t.y)}for(var w=0;w<s.length;w++){var g=s[w],V=g.x,A=g.y;g.x=G(c.matrix,V+b,A+y)+e,g.y=C(c.matrix,V+u,A+v)+d}}return s}},{key:"toPointList",value:function(a){for(var n=[],t=0;t<a.numberOfItems;t++){var s=a.getItem(t);n.push({x:s.x,y:s.y})}return n}},{key:"toCoordinateList",value:function(a){for(var n,t=[],s=/-?[\d.]+/g;null!==(n=s.exec(a));){var l=parseFloat(n[0]);isNaN(l)||t.push(l)}return t}},{key:"toPathCommandList",value:function(a){var n,t=[],s=/([A-Za-z])([^A-Za-z]+)?/g;for(a=a.trim();null!==(n=s.exec(a))&&(0!==t.length||"M"===n[1].toUpperCase());){n[2]=(n[2]||"").trim();var l=this.toCoordinateList(n[2]),h=t[t.length-1],o=h?h.command.toUpperCase():"",r=h?h.points[h.points.length-1]:void 0,f=void 0,c=void 0,b=void 0,v=void 0,e=void 0;switch(n[1].toUpperCase()){case"M":case"L":if(l.length>=2){l.length=2;break}continue;case"H":if(r&&l.length){l[1]="h"===n[1]?0:r.y,l.length=2;break}continue;case"V":if(r&&l.length){var d=l[0];l[0]="v"===n[1]?0:r.x,l[1]=d,l.length=2;break}continue;case"Z":if(t.length){l.push.apply(l,u(t[0].coordinates)),n[1]="Z";break}continue;case"C":if(l.length>=6){l.length=6;break}continue;case"S":if(l.length>=4&&("C"===o||"S"===o)){l.length=4;break}continue;case"Q":if(l.length>=4){l.length=4;break}continue;case"T":if(l.length>=2&&("Q"===o||"T"===o)){l.length=2;break}continue;case"A":if(l.length>=7){var w=y(l.splice(0,5),5);f=w[0],c=w[1],b=w[2],v=w[3],e=w[4],l.length=2;break}continue;default:continue}if(l.length>1){for(var g=[],V=/[a-z]/.test(n[1]),A=0;A<l.length;A+=2){var R=l[A],E=l[A+1];V&&r&&(R+=r.x,E+=r.y),g.push({x:R,y:E})}t.push({command:n[1],relative:V,coordinates:l,points:g,radiusX:f,radiusY:c,xAxisRotation:b,largeArcFlag:v,sweepFlag:e})}}return t}},{key:"createColorStops",value:function(a){for(var n=[],t=Array.from(a.getElementsByTagName("stop")),s=0;s<t.length;s++){var l=t[s],h=O.parseRGBA(P.cssAttribute(l,"stop-color"),P.cssAttribute(l,"stop-opacity"));h&&h.visible&&n.push({color:h.valueRGBA,offset:P.cssAttribute(l,"offset"),opacity:h.alpha})}return n}},{key:"fromCoordinateList",value:function(a){for(var n=[],t=0;t<a.length;t+=2)n.push({x:a[t],y:a[t+1]});return n.length%2==0?n:[]}},{key:"fromPathCommandList",value:function(a){for(var n="",t=Array.isArray(l=a),s=0,l=t?l:l[Symbol.iterator]();;){var h;if(t){if(s>=l.length)break;h=l[s++]}else{if((s=l.next()).done)break;h=s.value}var o=h;switch(n+=(""!==n?" ":"")+o.command,o.command.toUpperCase()){case"M":case"L":case"C":case"S":case"Q":case"T":n+=o.coordinates.join(",");break;case"H":n+=o.coordinates[0];break;case"V":n+=o.coordinates[1];break;case"A":n+="".concat(o.radiusX,",").concat(o.radiusY,",").concat(o.xAxisRotation,",").concat(o.largeArcFlag,",").concat(o.sweepFlag,",").concat(o.coordinates.join(","))}}return n}}]),a}(),B=squared.lib.util,q=function(){function a(n,t){l(this,a),this.element=n,this.parentElement=t,this.attributeName="",this.to="",this.setAttribute("attributeName"),this.setAttribute("to");var s=this.getAttribute("begin"),h=this.getAttribute("dur");if(""===s)this._begin=0,this._beginMS=0;else if("indefinite"===s)this._begin=-1;else{var o=y(a.convertClockTime(s),2);this._begin=o[0],this._beginMS=o[1]}if(""===h||"indefinite"===h)this._duration=-1;else{var r=y(a.convertClockTime(h),2);this._duration=r[0],this._durationMS=r[1]}}return o(a,[{key:"setAttribute",value:function(a,n){var t=this.getAttribute(a);t&&(void 0!==n?this[a+B.capitalize(n)]=t===n:this[a]=t)}},{key:"getAttribute",value:function(a){var n=this.element.attributes.getNamedItem(a);return n?n.value.trim():""}},{key:"duration",set:function(a){this._duration=Math.floor(a/1e3),this._durationMS=a%1e3},get:function(){return void 0!==this._durationMS?1e3*this._duration+this._durationMS:this._duration}},{key:"begin",set:function(a){this._begin=Math.floor(a/1e3),this._beginMS=a%1e3},get:function(){return void 0!==this._beginMS?1e3*this._begin+this._beginMS:this._begin}}],[{key:"convertClockTime",value:function(a){var n=0,t=0;if(/\d+ms$/.test(a))t=parseInt(a);else if(/\d+s$/.test(a))n=parseInt(a);else if(/\d+min$/.test(a))n=60*parseInt(a);else if(/\d+(.\d+)?h$/.test(a))n=60*parseFloat(a)*60;else{var s=/^(?:(\d?\d):)?(?:(\d?\d):)?(\d?\d)\.?(\d?\d?\d)?$/.exec(a);s&&(s[1]&&(n+=60*parseInt(s[1])*60),s[2]&&(n+=60*parseInt(s[2])),s[3]&&(n+=parseInt(s[3])),s[4]&&(t=parseInt(s[4])*(s[4].length<3?Math.pow(10,3-s[4].length):1)))}return[n,t]}}]),a}(),X=squared.lib.util,Y=function(a){function n(a,t){var s;l(this,n),(s=b(this,f(n).call(this,a,t))).element=a,s.parentElement=t,s.from="",s.by="",s.values=[],s.keyTimes=[],s.calcMode="",s.additiveSum=!1,s.accumulateSum=!1,s.fillFreeze=!1;var h,o=s.getAttribute("values");if(o)if((h=s.values).push.apply(h,u(X.flatMap(o.split(";"),function(a){return a.trim()}))),s.values.length>1){s.from=s.values[0],s.to=s.values[s.values.length-1];var r=s.getAttribute("keyTimes");if(r){var c,v=n.toFractionList(r);if(v.length===s.values.length)(c=s.keyTimes).push.apply(c,u(v))}}else s.values.length=0;if(0===s.values.length&&""!==s.to){if(s.setAttribute("from"),""===s.from){var e=X.optional(t,"".concat(s.attributeName,".baseVal.value"));if(e)s.from=e;else{var d=t.attributes.getNamedItem(s.attributeName);d&&(s.from=d.value.trim())}}s.values.push(s.from,s.to),s.keyTimes.push(0,1),s.setAttribute("by")}var w=s.getAttribute("end"),g=s.getAttribute("repeatDur"),V=s.getAttribute("repeatCount");if(""===w||"indefinite"===w)s._end=-1;else{var A=y(n.convertClockTime(w),2);s._end=A[0],s._endMS=A[1]}if(""===g||"indefinite"===g)s._repeatDuration=-1;else{var R=y(n.convertClockTime(g),2);s._repeatDuration=R[0],s._repeatDurationMS=R[1]}return s._repeatCount="indefinite"===V?-1:Math.max(0,X.convertInt(V)),s.setAttribute("calcMode"),s.setAttribute("additive","sum"),s.setAttribute("accumulate","sum"),s.setAttribute("fill","freeze"),s}return r(n,q),o(n,[{key:"end",set:function(a){this._end=Math.floor(a/1e3),this._endMS=a%1e3},get:function(){return void 0!==this._endMS?1e3*this._end+this._endMS:this._end}},{key:"repeatCount",set:function(a){this._repeatCount=a,this._repeatDuration=-1,this._repeatDurationMS=void 0},get:function(){var a=this.duration;return-1!==a?-1!==this._repeatCount&&-1!==this._repeatDuration?(this._repeatCount+1)*a<=this.repeatDuration?this._repeatCount:this.repeatDuration/a:-1===this._repeatCount&&-1===this._repeatDuration?-1:-1!==this._repeatDuration?this.repeatDuration/a:this._repeatCount:0}},{key:"repeatDuration",get:function(){return void 0!==this._repeatDurationMS?1e3*this._repeatDuration+this._repeatDurationMS:this._repeatDuration}}],[{key:"toFractionList",value:function(a){var n=-1,t=X.flatMap(a.split(arguments.length>1&&void 0!==arguments[1]?arguments[1]:";"),function(a){var t=parseFloat(a);return!isNaN(t)&&t<=1&&(-1===n||t>n)?(n=t,t):-1});return t.length>1&&t.some(function(a){return-1!==a})&&0===t[0]?t:[]}}]),n}(),D=squared.lib.util,W=function(a){function n(a,t){var s;l(this,n),(s=b(this,f(n).call(this,a,t))).path="",s.keyPoints=[],s.rotate=0,s.rotateAuto=!1,s.rotateAutoReverse=!1,s.setAttribute("path");var h=s.getAttribute("rotate");switch(h){case"auto":s.rotateAuto=!0;break;case"auto-reverse":s.rotateAutoReverse=!0;break;default:s.rotate=D.convertInt(h)}if(s.keyTimes.length){var o=s.getAttribute("keyPoints");if(o){var r=Y.toFractionList(o);r.length===s.keyTimes.length&&(s.keyPoints=r)}}return s}return r(n,Y),n}(),U=function(a){function n(a,t){var s;switch(l(this,n),(s=b(this,f(n).call(this,a,t))).getAttribute("type")){case"translate":s.type=SVGTransform.SVG_TRANSFORM_TRANSLATE;break;case"scale":s.type=SVGTransform.SVG_TRANSFORM_SCALE;break;case"rotate":s.type=SVGTransform.SVG_TRANSFORM_ROTATE;break;case"skewX":s.type=SVGTransform.SVG_TRANSFORM_SKEWX;break;case"skewY":s.type=SVGTransform.SVG_TRANSFORM_SKEWY;break;default:s.type=0}return s}return r(n,Y),o(n,null,[{key:"toRotateList",value:function(a){var n=a.map(function(a){if(""===a)return[null,null,null];var n=F.toCoordinateList(a);return 1===n.length||3===n.length?n:[]});return n.some(function(a){return 0===a.length})?void 0:n}},{key:"toScaleList",value:function(a){var n=a.map(function(a){if(""===a)return[null,null];var n=F.toCoordinateList(a);return 1===n.length?[n[0],n[0]]:2===n.length?n:[]});return n.some(function(a){return 0===a.length})?void 0:n}},{key:"toTranslateList",value:function(a){var n=a.map(function(a){if(""===a)return[null,null];var n=F.toCoordinateList(a);return 1===n.length||2===n.length?n:[]});return n.some(function(a){return 0===a.length})?void 0:n}}]),n}(),z=squared.lib.color,H=squared.lib.dom,Z=squared.lib.util,K=function(){function a(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";l(this,a),this.element=n,this.d=t,this.transformed=!1,this.opacity=1,this.color="",this.fillRule="",this.fill="",this.fillOpacity="",this.stroke="",this.strokeWidth="",this.strokeOpacity="",this.strokeLinecap="",this.strokeLinejoin="",this.strokeMiterlimit="",this.clipPath="",this.clipRule="",this.baseVal={cx:null,cy:null,r:null,rx:null,ry:null,x1:null,x2:null,y1:null,y2:null,x:null,y:null,width:null,height:null,points:null},this.init()}return o(a,[{key:"setColor",value:function(a){var n=H.cssAttribute(this.element,a),t=Z.REGEX_PATTERN.CSS_URL.exec(n);if(t)n="@".concat(t[1]);else if(""!==n)switch(n.toLowerCase()){case"none":case"transparent":case"rgba(0, 0, 0, 0)":n="";break;case"currentcolor":var s=z.parseRGBA(H.cssAttribute(this.element,"color",!0));n=s?s.valueRGB:"#000000";break;default:var l=z.parseRGBA(n);l&&(n=l.valueRGB)}else"fill"!==a||this.element.parentElement instanceof SVGGElement||(n="#000000");this[a]=n}},{key:"setOpacity",value:function(a){var n=H.cssAttribute(this.element,"".concat(a,"-opacity"));this["".concat(a,"Opacity")]=n?""+parseFloat(n)*this.opacity:""+this.opacity}},{key:"init",value:function(){var n=this.element;if(""===this.d){var t=n.transform.baseVal;switch(n.tagName){case"path":this.d=H.cssAttribute(n,"d");break;case"circle":var s=n;this.baseVal.cx=s.cx.baseVal.value,this.baseVal.cy=s.cy.baseVal.value,this.baseVal.r=s.r.baseVal.value,this.d=a.getCircle(this.baseVal.cx,this.baseVal.cy,this.baseVal.r,!0);break;case"ellipse":var l=n;this.baseVal.cx=l.cx.baseVal.value,this.baseVal.cy=l.cy.baseVal.value,this.baseVal.rx=l.rx.baseVal.value,this.baseVal.ry=l.ry.baseVal.value,this.d=a.getEllipse(this.baseVal.cx,this.baseVal.cy,this.baseVal.rx,this.baseVal.ry,!0);break;case"line":var h=n;if(this.baseVal.x1=h.x1.baseVal.value,this.baseVal.y1=h.y1.baseVal.value,this.baseVal.x2=h.x2.baseVal.value,this.baseVal.y2=h.y2.baseVal.value,t.numberOfItems)this.d=a.getPolyline(F.applyTransforms(t,[{x:this.baseVal.x1,y:this.baseVal.y1},{x:this.baseVal.x2,y:this.baseVal.y2}],R(n))),this.transformed=!0;else this.d=a.getLine(this.baseVal.x1,this.baseVal.y1,this.baseVal.x2,this.baseVal.y2,!0);break;case"rect":var o=n;if(this.baseVal.x=o.x.baseVal.value,this.baseVal.y=o.y.baseVal.value,this.baseVal.width=o.width.baseVal.value,this.baseVal.height=o.height.baseVal.value,t.numberOfItems)this.d=a.getPolygon(F.applyTransforms(t,[{x:this.baseVal.x,y:this.baseVal.y},{x:this.baseVal.x+this.baseVal.width,y:this.baseVal.y},{x:this.baseVal.x+this.baseVal.width,y:this.baseVal.y+this.baseVal.height},{x:this.baseVal.x,y:this.baseVal.y+this.baseVal.height}],R(n))),this.transformed=!0;else this.d=a.getRect(this.baseVal.width,this.baseVal.height,this.baseVal.x,this.baseVal.y,!0);break;case"polyline":case"polygon":this.baseVal.points=F.toPointList(n.points),t.numberOfItems&&(this.baseVal.points=F.applyTransforms(t,this.baseVal.points,R(n)),this.transformed=!0),this.d="polygon"===n.tagName?a.getPolygon(this.baseVal.points):a.getPolyline(this.baseVal.points)}}var r=Z.REGEX_PATTERN.CSS_URL.exec(H.cssAttribute(n,"clip-path"));r&&(this.clipPath=r[1],this.clipRule=H.cssAttribute(n,"clip-rule",!0));var f=H.cssAttribute(n,"opacity");f&&(this.opacity=Math.min(parseFloat(f),1)),this.setColor("fill"),""!==this.fill&&(this.setOpacity("fill"),this.fillRule=H.cssAttribute(n,"fill-rule",!0)),this.setColor("stroke"),""!==this.stroke&&(this.setOpacity("stroke"),this.strokeWidth=H.cssAttribute(n,"stroke-width")||"1",this.strokeLinecap=H.cssAttribute(n,"stroke-linecap",!0),this.strokeLinejoin=H.cssAttribute(n,"stroke-linejoin",!0),this.strokeMiterlimit=H.cssAttribute(n,"stroke-miterlimit",!0))}}],[{key:"getLine",value:function(a,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return 0===a&&0===n&&0===t&&0===s&&(arguments.length>4&&void 0!==arguments[4]&&arguments[4])?"":"M".concat(a,",").concat(n," L").concat(t,",").concat(s)}},{key:"getRect",value:function(a,n){var t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return a>0&&n>0||!(arguments.length>4&&void 0!==arguments[4]&&arguments[4])?"M".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,",").concat(t," h").concat(a," v").concat(n," h").concat(-a," Z"):""}},{key:"getPolyline",value:function(a){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(a=a instanceof SVGPointList?F.toPointList(a):a).length||!n?"M".concat(a.map(function(a){return"".concat(a.x,",").concat(a.y)}).join(" ")):""}},{key:"getPolygon",value:function(a){var n=this.getPolyline(a);return""!==n?n+" Z":""}},{key:"getCircle",value:function(a,n,t){return t>0||!(arguments.length>3&&void 0!==arguments[3]&&arguments[3])?this.getEllipse(a,n,t,t):""}},{key:"getEllipse",value:function(a,n,t,s){return t>0&&s>0||!(arguments.length>4&&void 0!==arguments[4]&&arguments[4])?"M".concat(a-t,",").concat(n," a").concat(t,",").concat(s,",0,1,0,").concat(2*t,",0 a").concat(t,",").concat(s,",0,1,0,-").concat(2*t,",0"):""}}]),a}(),Q=squared.lib.util;function J(a,n,t,s,l){return s+(a-n)/(t-n)*(l-s)}function $(a,n){var t,s,l=a.entries(),h=Array.isArray(l),o=0;for(l=h?l:l[Symbol.iterator]();;){var r;if(h){if(o>=l.length)break;r=l[o++]}else{if((o=l.next()).done)break;r=o.value}var f=y(r,2),c=f[0],b=f[1];if(t&&n<c){s={timeMS:c,value:b.value};break}n>c&&(t={timeMS:c,value:b.value})}return[t,s]}function j(a,n){var t=new Map,s=a.entries(),l=Array.isArray(s),h=0;for(s=l?s:s[Symbol.iterator]();;){var o;if(l){if(h>=s.length)break;o=s[h++]}else{if((h=s.next()).done)break;o=h.value}var r=y(o,2),f=r[1],c=r[0]/n;if(c>0)for(var b=5;;b++){var u=parseFloat((""+c).substring(0,b));if(!t.has(u)){c=u;break}}t.set(c,f)}return t}function i(a,t,s,l,h,o){var r=[],f=function(){if(b){if(u>=c.length)return"break";v=c[u++]}else{if((u=c.next()).done)return"break";v=u.value}var n,t=y(v,2),f=t[0],e=t[1],d=[];if(l.forEach(function(n){e.has(n)?d.push(e.get(n)):h&&void 0!==h[n]?d.push(h[n]):null!==a.baseVal[n]&&d.push(a.baseVal[n])}),d.length!==l.length)return{v:void 0};if(o&&o.numberOfItems)switch(s){case"getLine":n=K.getPolyline(F.applyTransforms(o,function(a){return[{x:a[0],y:a[1]},{x:a[2],y:a[4]}]}(d),R(a.element)));break;case"getRect":n=K.getPolygon(F.applyTransforms(o,function(a){var n=a[0],t=a[1],s=a[2],l=a[3];return[{x:s,y:l},{x:s+n,y:l},{x:s+n,y:l+t},{x:s,y:l+t}]}(d),R(a.element)))}void 0===n&&(n=K[s].apply(null,d)),r.push({timeMS:f,value:n})};var c=t.entries(),b=Array.isArray(c),u=0;a:for(c=b?c:c[Symbol.iterator]();;){var v,e=f();switch(e){case"break":break a;default:if("object"===n(e))return e.v}}return r}var k=function(){function a(n){if(l(this,a),this.element=n,this.name=F.setName(n),this.animate=this.animatable?a.toAnimateList(n):[],this.visible=I(n),this.drawable){var t=new K(n);t.d&&"none"!==t.d&&(this.path=t)}}return o(a,[{key:"synchronizePath",value:function(){var a=this.path;if(a&&this.animate.length){for(var n=this.element.tagName,t=[],s=Array.isArray(h=this.animate),l=0,h=s?h:h[Symbol.iterator]();;){var o;if(s){if(l>=h.length)break;o=h[l++]}else{if((l=h.next()).done)break;o=l.value}var r=o;if(r instanceof Y&&r.keyTimes.length>1&&r.duration>0)switch(r.attributeName){case"r":case"cx":case"cy":if("circle"===n){t.push(r);break}case"rx":case"ry":"ellipse"===n&&t.push(r);break;case"x1":case"x2":case"y1":case"y2":"line"===n&&t.push(r);break;case"x":case"y":case"width":case"height":"rect"===n&&t.push(r)}}if(t.length>1){var f={},c={},b={},v=[],e=[],d=0,w=0;t.forEach(function(a){var n=a.attributeName;if(void 0===f[n]&&void 0===b[n])if(-1===a.repeatCount){f[n]=new Map;var t=-1!==a.begin?a.begin:0;v.push(t+a.duration);for(var s=0;s<a.keyTimes.length;s++)f[n].set(t+a.keyTimes[s]*a.duration,{value:parseFloat(a.values[s]),begin:t,duration:a.duration})}else{var l=-1,h=!1,o=!1;void 0===c[n]?c[n]=new Map:(l=Q.maxArray(Array.from(c[n].keys())),h=!!Array.from(c[n].values()).pop().freeze,o=!0);var r=a.duration,y=a.repeatCount;if(l>=(y+1)*r)return;for(var u,e=Math.ceil(y),d=y-Math.floor(y),w=-1!==a.begin?a.begin:0,g=l>=r?Math.floor(l/r):0;g<=e;g++)for(var V=w*(g+1),A=0;A<a.keyTimes.length;A++){var R=a.keyTimes[A],E=void 0,G=void 0,C=parseFloat(a.values[A]);if(0===A)if(null===(a.element.attributes.getNamedItem("values")||a.element.attributes.getNamedItem("from"))){var N=Array.from(c[n].values()).reverse().find(function(a){return!!a.freeze});N&&(C=N.value)}if(g===e&&d>R&&(void 0!==(E=a.keyTimes[A+1])&&d<E?(G=y*r,C=J(d,R,E,C,parseFloat(a.values[A+1]))):E=void 0),void 0===G){if(G=(R+g)*r,0===A&&(g>0||o))if(o){var I=l+(h?0:-1);if(V>=I)G=Math.max(V,l+1);else{var L=I%(w+r);if(0!==L){for(var O=(L-w)/r,P=-1,p=-1,F=0;F<a.keyTimes.length;F++){if(-1!==P&&O<a.keyTimes[F]){p=F;break}O>a.keyTimes[F]&&(P=F)}-1!==P&&-1!==p&&(C=J(O,a.keyTimes[P],a.keyTimes[p],parseFloat(a.values[P]),parseFloat(a.values[p]))),G=l+1}else C=parseFloat(a.values[0]),G=Math.max(V+G,l+1)}o=!1}else G=l+1}else G+=V;if(G>l&&(c[n].set(G,u={value:C}),l=G),E)break}u&&(a.fillFreeze?(u.freeze=a.fillFreeze,b[n]={timeMS:l,value:u.value}):c[n].set(l+1,{value:parseFloat(a.values[0])}))}});var g=Object.keys(c).length>0;if(g){var V=[];for(var A in c){var R;(R=V).push.apply(R,u(c[A].keys()))}for(var G in V=Array.from(new Set(V)).sort(function(a,n){return a<n?-1:1}),f)for(var C=f[G].values().next().value.duration,N=V[V.length-1],I=1;;I++){var L=C*I;if(L===N)break;if(L>N){V.push(L);break}}var O={},P={};[[f,O],[c,P]].forEach(function(a){var n=a[0],t=a[1];for(var s in n){var l=n[s],h=Array.from(l.keys()).pop(),o=V.length+(n===c?-1:0);t[s]=new Map;for(var r=1;r<o;r++){var f=V[r];if(n===c&&f>=h)break;var b=l.get(f);if(void 0===b){var u=void 0,v=void 0,e=void 0;if(n===c){var d=y($(l,f),2);u=d[0],v=d[1],e=f}else{var w=Array.from(l.values()),g=w[1].duration;u={timeMS:0,value:w[0].value},v={timeMS:g,value:w[1].value},e=f%g!=0?f>g?f%g:f:g}u&&v&&t[s].set(f,{value:J(e,u.timeMS,v.timeMS,u.value,v.value)})}else t[s].set(f,b)}}});for(var p=new Map,F=function(){if(B){if(q>=X.length)return"break";D=X[q++]}else{if((q=X.next()).done)return"break";D=q.value}var a=D,n=new Map;[O,P].forEach(function(t){for(var s in t){var l=t[s].get(a);l&&n.set(s,l.value)}}),p.set(a,n)},B=Array.isArray(X=V),q=0,X=B?X:X[Symbol.iterator]();;){var D;if("break"===F())break}for(var W in b){var U=b[W],z=p.entries(),H=Array.isArray(z),Z=0;for(z=H?z:z[Symbol.iterator]();;){var K;if(H){if(Z>=z.length)break;K=z[Z++]}else{if((Z=z.next()).done)break;K=Z.value}var k=y(K,2),x=k[1];k[0]>U.timeMS&&!x.has(W)&&x.set(W,U.value)}}e.push(j(p,d=V[V.length-1]))}if(v.length>1){w=E(v);var S={},M=new Set;for(var T in f){S[T]=new Map;var m=0,_=0;do{var aa=0,na=f[T].entries(),ta=Array.isArray(na),sa=0;for(na=ta?na:na[Symbol.iterator]();;){var la;if(ta){if(sa>=na.length)break;la=na[sa++]}else{if((sa=na.next()).done)break;la=sa.value}var ha=y(la,2),oa=ha[0];m>0&&0==aa++&&oa++,S[T].set(oa+=((x=ha[1]).begin+x.duration)*m,{value:x.value}),M.add(oa),_=oa}m++}while(_<w)}var ra=Array.from(M).sort(function(a,n){return a<n?-1:1});for(var fa in S)for(var ca=S[fa],ba=1;ba<ra.length;ba++){var ya=ra[ba];if(!ca.has(ya)){var ua=y($(ca,ya),2),va=ua[0],ea=ua[1];va&&ea&&ca.set(ya,{value:J(ya,va.timeMS,ea.timeMS,va.value,ea.value)})}}for(var da=new Map,wa=Array.isArray(Va=ra),ga=0,Va=wa?Va:Va[Symbol.iterator]();;){var Aa;if(wa){if(ga>=Va.length)break;Aa=Va[ga++]}else{if((ga=Va.next()).done)break;Aa=ga.value}var Ra=Aa,Ea=new Map;for(var Ga in S){var Ca=S[Ga].get(Ra);Ca&&Ea.set(Ga,Ca.value)}da.set(Ra,Ea)}e.push(j(da,ra[ra.length-1]))}else{var Na=function(a){var n=t.find(function(n){return n.attributeName===a&&-1===n.repeatCount});n&&Q.spliceArray(t,n)&&(n.begin=d)};for(var Ia in f)Na(Ia)}if(e.length){this.animate=this.animate.filter(function(a){return!t.includes(a)});for(var La=0;La<e.length;La++){var Oa=e[La],Pa=!g||La>0?b:void 0,pa=void 0;switch(n){case"circle":pa=i(a,Oa,"getCircle",["cx","cy","r"],Pa);break;case"ellipse":pa=i(a,Oa,"getEllipse",["cx","cy","rx","ry"],Pa);break;case"line":pa=i(a,Oa,"getLine",["x1","y1","x2","y2"],Pa,this.transform);break;case"rect":pa=i(a,Oa,"getRect",["width","height","x","y"],Pa,this.transform)}if(pa){var Fa=new Y(t[0].element,this.element);Fa.attributeName="d",g&&0===La?(Fa.duration=d,Fa.repeatCount=0):(Fa.begin=d,Fa.duration=w,Fa.repeatCount=-1),Fa.end=0,Fa.keyTimes=pa.map(function(a){return a.timeMS}),Fa.values=pa.map(function(a){return""+a.value}),Fa.from=Fa.values[0],Fa.to=Fa.values[Fa.values.length-1],Fa.by="",this.animate.push(Fa)}}}}}}},{key:"transform",get:function(){return this.element.transform.baseVal}},{key:"drawable",get:function(){return!0}},{key:"animatable",get:function(){return!0}},{key:"transformable",get:function(){return this.transform.numberOfItems>0}}],[{key:"toAnimateList",value:function(a){for(var n=[],t=0;t<a.children.length;t++){var s=a.children[t];s instanceof SVGAnimateTransformElement?n.push(new U(s,a)):s instanceof SVGAnimateMotionElement?n.push(new W(s,a)):s instanceof SVGAnimateElement?n.push(new Y(s,a)):s instanceof SVGAnimationElement&&n.push(new q(s,a))}return n}}]),a}(),x=function(a){function n(a){var t;return l(this,n),(t=b(this,f(n).call(this))).element=a,t.visible=!0,t.name=F.setName(a),t.animate=t.animatable?k.toAnimateList(a):[],t.visible=I(a),t}return r(n,squared.lib.base.Container),o(n,[{key:"transform",get:function(){return this.element.transform.baseVal}},{key:"animatable",get:function(){return this.element instanceof SVGGElement}},{key:"transformable",get:function(){return this.element instanceof SVGGElement&&this.element.transform.baseVal.numberOfItems>0}}]),n}(),S=function(a){function n(a){var t;return l(this,n),(t=b(this,f(n).call(this,a))).element=a,t.x=a.x.baseVal.value,t.y=a.y.baseVal.value,t.width=a.width.baseVal.value,t.height=a.height.baseVal.value,t}return r(n,x),o(n,[{key:"animatable",get:function(){return!0}},{key:"transformable",get:function(){return this.transform.numberOfItems>0}}]),n}(),M=squared.lib.util,T=function(a){function n(a){var t;return l(this,n),(t=b(this,f(n).call(this,a))).element=a,t.uri="",t.x=a.x.baseVal.value,t.y=a.y.baseVal.value,t.width=a.width.baseVal.value,t.height=a.height.baseVal.value,t.uri=M.resolvePath(a.href.baseVal),t}return r(n,k),o(n,[{key:"externalize",value:function(){var a=this.element.transform.baseVal;if(a.numberOfItems){for(var n=this.x,t=this.y,s=a.numberOfItems-1;s>=0;s--){var l=a.getItem(s),h=l.matrix;switch(l.type){case SVGTransform.SVG_TRANSFORM_TRANSLATE:n+=h.e,t+=h.f;break;case SVGTransform.SVG_TRANSFORM_SCALE:n*=h.a,t*=h.d,this.width*=h.a,this.height*=h.d;break;case SVGTransform.SVG_TRANSFORM_ROTATE:n=G(h,n,n),t=C(h,t,t),h.a<0&&(n+=h.a*this.width),h.c<0&&(n+=h.c*this.width),h.b<0&&(t+=h.b*this.height),h.d<0&&(t+=h.d*this.height)}}this.x=n,this.y=t}}},{key:"drawable",get:function(){return!1}}]),n}(),m=function(a){function n(a,t){var s;return l(this,n),(s=b(this,f(n).call(this,a))).element=a,t&&s.setPath(t),s}return r(n,S),o(n,[{key:"setPath",value:function(a){this.path=new K(this.element,a)}}]),n}(),_=squared.lib.dom,aa={util:L};a.Svg=function(a){function n(a){var t;return l(this,n),(t=b(this,f(n).call(this))).element=a,t.animatable=!0,t.transformable=!1,t.defs={clipPath:new Map,gradient:new Map},t._width=0,t._height=0,t._viewBoxWidth=0,t._viewBoxHeight=0,t._opacity=1,t.name=F.setName(a),t.animate=k.toAnimateList(a),t.visible=I(a),t.init(),t}return r(n,squared.lib.base.Container),o(n,[{key:"setDimensions",value:function(a,n){this._width=a,this._height=n}},{key:"setViewBox",value:function(a,n){this._viewBoxWidth=a,this._viewBoxHeight=n}},{key:"setOpacity",value:function(a){this._opacity=!isNaN(a=parseFloat(""+a))&&a<1?a:1}},{key:"init",value:function(){var a=this,n=this.element;if(this.setViewBox(n.viewBox.baseVal.width,n.viewBox.baseVal.height),this.setOpacity(_.cssAttribute(n,"opacity")),this.setDimensions(n.width.baseVal.value,n.height.baseVal.value),_.isUserAgent(16)){var t=n.getBoundingClientRect();t.width>this.width&&t.height>this.height&&this.setDimensions(t.width,t.height)}n.querySelectorAll("clipPath, linearGradient, radialGradient").forEach(function(n){if(n.id)if(n instanceof SVGClipPathElement){for(var t=new x(n),s=Array.from(n.children),l=0;l<s.length;l++){var h=s[l];if(V(h)){var o=new k(h);o.path&&t.append(o)}}t.length&&a.defs.clipPath.set(n.id,t)}else n instanceof SVGLinearGradientElement?a.defs.gradient.set("@".concat(n.id),{type:"linear",x1:n.x1.baseVal.value,x2:n.x2.baseVal.value,y1:n.y1.baseVal.value,y2:n.y2.baseVal.value,x1AsString:n.x1.baseVal.valueAsString,x2AsString:n.x2.baseVal.valueAsString,y1AsString:n.y1.baseVal.valueAsString,y2AsString:n.y2.baseVal.valueAsString,colorStop:F.createColorStops(n)}):n instanceof SVGRadialGradientElement&&a.defs.gradient.set("@".concat(n.id),{type:"radial",cx:n.cx.baseVal.value,cy:n.cy.baseVal.value,r:n.r.baseVal.value,cxAsString:n.cx.baseVal.valueAsString,cyAsString:n.cy.baseVal.valueAsString,rAsString:n.r.baseVal.valueAsString,fx:n.fx.baseVal.value,fy:n.fy.baseVal.value,fxAsString:n.fx.baseVal.valueAsString,fyAsString:n.fy.baseVal.valueAsString,colorStop:F.createColorStops(n)})});var s,l=new Map;function h(a){var n;V(a)?(n=new k(a),a.id&&n.path&&l.set("#".concat(a.id),n.path.d)):A(a)&&(n=new T(a)),s&&n&&s.append(n)}for(var o=0;o<n.children.length;o++){var r=n.children[o];if(r instanceof SVGSVGElement)s=new S(r),this.append(s);else if(r instanceof SVGGElement)s=new x(r),this.append(s);else{if(!(r instanceof SVGUseElement)){void 0===s&&(s=new x(n),this.append(s)),h(r);continue}s=new m(r),this.append(s)}for(var f=0;f<r.children.length;f++)h(r.children[f]);s=void 0}this.each(function(a){if(a instanceof m){var n=l.get(a.element.href.baseVal);n&&a.setPath(n)}}),this.retain(this.filter(function(a){return a.length>0||a instanceof m&&void 0!==a.path}))}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"viewBoxWidth",get:function(){return this._viewBoxWidth}},{key:"viewBoxHeight",get:function(){return this._viewBoxHeight}},{key:"opacity",get:function(){return this._opacity}},{key:"transform",get:function(){return this.element.transform.baseVal}}]),n}(),a.SvgAnimate=Y,a.SvgAnimateMotion=W,a.SvgAnimateTransform=U,a.SvgAnimation=q,a.SvgBuild=F,a.SvgElement=k,a.SvgGroup=x,a.SvgGroupViewBox=S,a.SvgImage=T,a.SvgPath=K,a.SvgUse=m,a.lib=aa,Object.defineProperty(a,"__esModule",{value:!0})});
