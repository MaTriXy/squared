!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(((e=e||self).squared=e.squared||{},e.squared.svg={}))}(this,function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e){this.wrapped=e}function n(e){var t,n;function a(t,n){try{var s=e[t](n),o=s.value,l=o instanceof r;Promise.resolve(l?o.wrapped:o).then(function(e){l?a("next",e):i(s.done?"return":"normal",e)},function(e){a("throw",e)})}catch(e){i("throw",e)}}function i(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?a(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise(function(i,s){var o={key:e,arg:r,resolve:i,reject:s,next:null};n?n=n.next=o:(t=n=o,a(e,r))})},"function"!=typeof e.return&&(this.return=void 0)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}function h(e,t,r){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=f(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(r):a.value}})(e,t,r||e)}"function"==typeof Symbol&&Symbol.asyncIterator&&(n.prototype[Symbol.asyncIterator]=function(){return this}),n.prototype.next=function(e){return this._invoke("next",e)},n.prototype.throw=function(e){return this._invoke("throw",e)},n.prototype.return=function(e){return this._invoke("return",e)};function v(e,t){return p(e)||function(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}(e,t)||g()}function m(e){return function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(e){if(Array.isArray(e))return e}function y(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function g(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var d=squared.lib.dom,b=squared.lib.util;function k(e,t,r){e.style[t]=r,e.setAttribute(t,r)}function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"deg",r=parseFloat(e);switch(t){case"turn":r*=360;break;case"rad":r*=180/Math.PI}return r}function S(e){return e*Math.PI/180}var x={path:1,line:2,rect:3,ellipse:4,circle:5,polyline:6,polygon:7},T={clone:function(e){return{a:e.a,b:e.b,c:e.c,d:e.d,e:e.e,f:e.f}},rotate:function(e){var t=S(e),r=Math.cos(t),n=Math.sin(t);return{a:r,b:n,c:-1*n,d:r,e:0,f:0}},skew:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{a:1,b:Math.tan(S(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),c:Math.tan(S(e)),d:1,e:0,f:0}},scale:function(){return{a:arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,b:0,c:0,d:arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e:0,f:0}},translate:function(){return{a:1,b:0,c:0,d:1,e:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,f:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0}}},E={ZERO_ONE:"(0(?:\\.\\d+)?|1(?:\\.0+)?)",DECIMAL:"(-?[\\d.]+)",LENGTH:"([\\d.]+(?:[a-z]{2,}|%)?)",DEGREE:"(?:(-?[\\d.]+)(deg|rad|turn))"},V={MATRIX:"(matrix(?:3d)?)\\(".concat(E.DECIMAL,", ").concat(E.DECIMAL,", ").concat(E.DECIMAL,", ").concat(E.DECIMAL,", ").concat(E.DECIMAL,", ").concat(E.DECIMAL,"(?:, ").concat(E.DECIMAL,")?(?:, ").concat(E.DECIMAL,")?(?:, ").concat(E.DECIMAL,")?(?:, ").concat(E.DECIMAL,")?(?:, ").concat(E.DECIMAL,")?(?:, ").concat(E.DECIMAL,")?(?:, ").concat(E.DECIMAL,")?(?:, ").concat(E.DECIMAL,")?(?:, ").concat(E.DECIMAL,")?(?:, ").concat(E.DECIMAL,")?\\)"),ROTATE:"(rotate[XY]?)\\(".concat(E.DEGREE,"\\)"),SKEW:"(skew[XY]?)\\(".concat(E.DEGREE,"(?:, ").concat(E.DEGREE,")?\\)"),SCALE:"(scale[XY]?)\\(".concat(E.DECIMAL,"(?:, ").concat(E.DECIMAL,")?\\)"),TRANSLATE:"(translate[XY]?)\\(".concat(E.LENGTH,"(?:, ").concat(E.LENGTH,")?\\)")};function w(){return b.optionalAsNumber(squared,"settings.resolutionDPI")||96}function R(e){return parseInt(d.getStyle(e).fontSize||"16")}function M(e){var t=0,r=0;if(b.isNumber(e))t=parseInt(e);else if(/-?\d+ms$/.test(e))r=parseInt(e);else if(/-?\d+s$/.test(e))t=parseInt(e);else if(/-?\d+min$/.test(e))t=60*parseInt(e);else if(/-?\d+(.\d+)?h$/.test(e))t=60*parseFloat(e)*60;else{var n=/^(?:(-?)(\d?\d):)?(?:(\d?\d):)?(\d?\d)\.?(\d?\d?\d)?$/.exec(e);n&&(n[2]&&(t+=60*parseInt(n[2])*60),n[3]&&(t+=60*parseInt(n[3])),n[4]&&(t+=parseInt(n[4])),n[5]&&(r=parseInt(n[5])*(n[5].length<3?Math.pow(10,3-n[5].length):1)),n[1]&&(t*=-1,r*=-1))}return 1e3*t+r}var N={svg:function(e){return!!e&&"svg"===e.tagName},g:function(e){return!!e&&"g"===e.tagName},use:function(e){return!!e&&"use"===e.tagName},symbol:function(e){return!!e&&"symbol"===e.tagName},shape:function(e){return void 0!==x[e.tagName]},image:function(e){return"image"===e.tagName},path:function(e){return"path"===e.tagName},line:function(e){return"line"===e.tagName},rect:function(e){return"rect"===e.tagName},circle:function(e){return"circle"===e.tagName},ellipse:function(e){return"ellipse"===e.tagName},polygon:function(e){return"polygon"===e.tagName},polyline:function(e){return"polyline"===e.tagName},clipPath:function(e){return"clipPath"===e.tagName},linearGradient:function(e){return"linearGradient"===e.tagName},radialGradient:function(e){return"radialGradient"===e.tagName}};function _(e){var t=d.cssAttribute(e,"visibility",!0);return"hidden"!==t&&"collapse"!==t&&"none"!==d.cssAttribute(e,"display",!0)}function O(e,t){k(e,"display",t?"block":"none"),k(e,"visibility",t?"visible":"hidden")}function G(e,t){if(b.isNumber(t)){var r=parseFloat(""+t);r<=0?r=0:r>=1&&(r=1),e.style.opacity=""+r,e.setAttribute("opacity",""+r)}}function C(e,t){var r=e.attributes.getNamedItem("href");if(r&&"#"===r.value.charAt(0)){var n=r.value.substring(1);if(t)for(var a=Array.from(t.querySelectorAll("*")),i=0;i<a.length;i++){var s=a[i];if(s.id===n)return s instanceof SVGElement?s:null}else{var o=document.getElementById(n);if(o&&o instanceof SVGElement)return o}}return null}function F(e,t){return{type:e,matrix:t,angle:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,method:{x:!(arguments.length>3&&void 0!==arguments[3])||arguments[3],y:!(arguments.length>4&&void 0!==arguments[4])||arguments[4]}}}function L(e,t){var r=void 0===t?d.cssInline(e,"transform"):t;if(""!==r){var n=[];for(var a in V)for(var i=RegExp(V[a],"g"),s=null;null!==(s=i.exec(r));){var o=s[1].endsWith("X"),l=s[1].endsWith("Y");if(s[1].startsWith("rotate")){var u=A(s[2],s[3]),c=T.rotate(u);o?(c.a=1,c.b=0,c.c=0):l&&(c.b=0,c.c=0,c.d=1),n[s.index]=F(SVGTransform.SVG_TRANSFORM_ROTATE,c,u,!o,!l)}else if(s[1].startsWith("skew")){var f=l?0:A(s[2],s[3]),h=l?A(s[2],s[3]):s[4]&&s[5]?A(s[4],s[5]):0,v=T.skew(f,h);o?n[s.index]=F(SVGTransform.SVG_TRANSFORM_SKEWX,v,f,!0,!1):l?n[s.index]=F(SVGTransform.SVG_TRANSFORM_SKEWY,v,h,!1,!0):(n[s.index]=F(SVGTransform.SVG_TRANSFORM_SKEWX,Object.assign({},v,{b:0}),f,!0,!1),0!==h&&(n[s.index+1]=F(SVGTransform.SVG_TRANSFORM_SKEWY,Object.assign({},v,{c:0}),h,!1,!0)))}else if(s[1].startsWith("scale")){var m=l?void 0:parseFloat(s[2]),p=T.scale(m,o?void 0:l?parseFloat(s[2]):!o&&s[3]?parseFloat(s[3]):m);n[s.index]=F(SVGTransform.SVG_TRANSFORM_SCALE,p,0,!l,!o)}else if(s[1].startsWith("translate")){var y=w(),g=R(e),k=parseFloat(b.convertPX(s[2],y,g)),S=!o&&s[3]?parseFloat(b.convertPX(s[3],y,g)):0,x=T.translate(l?0:k,l?k:S);n[s.index]=F(SVGTransform.SVG_TRANSFORM_TRANSLATE,x,0)}else if(s[1].startsWith("matrix")){var E=P(e,t);E&&(n[s.index]=F(SVGTransform.SVG_TRANSFORM_MATRIX,E))}}return n.filter(function(e){return!!e&&(e.css=!0,!0)})}}function P(e,t){var r=RegExp(V.MATRIX).exec(t||d.getStyle(e,!0).transform||"");if(r)switch(r[1]){case"matrix":return{a:parseFloat(r[2]),b:parseFloat(r[3]),c:parseFloat(r[4]),d:parseFloat(r[5]),e:parseFloat(r[6]),f:parseFloat(r[7])};case"matrix3d":return{a:parseFloat(r[2]),b:parseFloat(r[3]),c:parseFloat(r[6]),d:parseFloat(r[7]),e:parseFloat(r[14]),f:parseFloat(r[15])}}}function B(e,t){var r={x:null,y:null};if(""!==(t=t||d.cssAttribute(e,"transform-origin"))){var n,a=e.parentElement,i=0,s=0;N.svg(a)&&a.viewBox?n=a.viewBox.baseVal:a instanceof SVGGraphicsElement&&N.svg(a.viewportElement)&&a.viewportElement.viewBox&&(n=a.viewportElement.viewBox.baseVal),n&&(i=n.width,s=n.height);var o=t.split(" ");1===o.length&&o.push("center"),(o=o.slice(0,2)).includes("left")?r.x=0:o.includes("right")&&(r.x=i),o.includes("top")?r.y=0:o.includes("bottom")&&(r.y=s),["x","y"].forEach(function(t){if(null===r[t])for(var n=0;n<o.length;n++){var a=o[n];if(""!==a&&("center"===a&&(a="50%"),b.isUnit(a)?r[t]=parseInt(a.endsWith("px")?a:b.convertPX(a,w(),R(e))):b.isPercent(a)&&(r[t]=("x"===t?i:s)*(parseInt(a)/100)),null!==r[t])){o[n]="";break}}})}return r.x=r.x||0,r.y=r.y||0,r}function I(e){switch(e){case"rotate":case SVGTransform.SVG_TRANSFORM_ROTATE:return"0 0 0";case"scale":case SVGTransform.SVG_TRANSFORM_SCALE:return"1 1";case"skewX":case"skewY":case SVGTransform.SVG_TRANSFORM_SKEWX:case SVGTransform.SVG_TRANSFORM_SKEWY:return"0";case"translate":case SVGTransform.SVG_TRANSFORM_TRANSLATE:return"0 0"}return""}function X(e){return e.sort(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?function(e,t){return e>t?-1:1}:function(e,t){return e<t?-1:1})}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if(e.length>1){var n=X(e.slice(0))[0];if(r)if(r.length===e.length)for(var a=0;a<r.length;a++)t=Math.max(t,r[a]+n);else r=void 0;void 0===r&&(t=Math.max(t,n));for(var i=t,s=!1;!s;)for(var o=0;o<e.length;o++){if((i-(r?r[o]:0))%e[o]!=0){s=!1,i+=n;break}s=!0}return i}return e[0]}function j(e,t,r){return e.a*t+e.c*r+e.e}function q(e,t,r){return e.b*t+e.d*r+e.f}function U(e,t){return t*Math.cos(S(e))*-1}var z=Object.freeze({SHAPES:x,MATRIX:T,REGEXP_UNIT:E,getHostDPI:w,getFontSize:R,createElement:function(e){return document.createElementNS("http://www.w3.org/2000/svg",e)},convertClockTime:M,SVG:N,isVisible:_,setVisible:O,setOpacity:G,getTargetElement:C,createTransform:F,getTransform:L,getTransformMatrix:P,getTransformOrigin:B,getTransformRotate:function(e){var t=[],r=e.attributes.getNamedItem("transform");if(r)for(var n=/rotate\((-?[\d.]+),?\s*(-?[\d.]+),?\s*(-?[\d.]+)\)/g,a=null;null!==(a=n.exec(r.value));)t.push({angle:parseFloat(a[1]),x:parseFloat(a[2]),y:parseFloat(a[3])});return t.length?t:[{angle:0,x:0,y:0}]},getTransformInitialValue:I,sortNumber:X,getLeastCommonMultiple:D,applyMatrixX:j,applyMatrixY:q,getRadiusX:function(e,t){return t*Math.sin(S(e))},getRadiusY:U}),W=squared.lib.util,Y=new Map,H=function(){function e(){a(this,e)}return s(e,null,[{key:"setName",value:function(e){if(e){var t,r="";if(W.isString(e.id)){var n=W.convertWord(e.id,!0);Y.has(n)||(r=n),t=n}else t=e.tagName;var a=Y.get(t)||0;return""!==r?(Y.set(r,a),r):(Y.set(t,++a),"".concat(t,"_").concat(a))}return Y.clear(),""}},{key:"instance",value:function(e){return!!e&&N.svg(e.element)}},{key:"instanceOfContainer",value:function(t){return e.instance(t)||e.instanceOfG(t)||e.instanceOfUseSymbol(t)}},{key:"instanceOfElement",value:function(t){return e.instanceOfShape(t)||e.instanceOfImage(t)||e.instanceOfUse(t)&&!e.instanceOfUseSymbol(t)}},{key:"instanceOfG",value:function(e){return!!e&&N.g(e.element)}},{key:"instanceOfUseSymbol",value:function(t){return e.instanceOfUse(t)&&void 0!==t.symbolElement}},{key:"instanceOfShape",value:function(t){return!!t&&N.shape(t.element)||e.instanceOfUse(t)&&void 0!==t.path}},{key:"instanceOfImage",value:function(t){return!!t&&N.image(t.element)||e.instanceOfUse(t)&&void 0!==t.imageElement}},{key:"instanceOfUse",value:function(e){return!!e&&N.use(e.element)}},{key:"instanceOfSet",value:function(e){return 0===e.instanceType}},{key:"instanceOfAnimate",value:function(e){return 1===e.instanceType}},{key:"instanceOfAnimateTransform",value:function(e){return 2===e.instanceType}},{key:"instanceOfAnimateMotion",value:function(e){return 3===e.instanceType}},{key:"getContainerOpacity",value:function(e){for(var t=parseFloat(e.opacity),r=e.parent;r;){var n=parseFloat(r.opacity||"1");!isNaN(n)&&n<1&&(t*=n),r=r.parent}return t}},{key:"getContainerViewBox",value:function(e){for(var t=e;t;)switch(t.element.tagName){case"svg":case"symbol":return t;default:t=t.parent}}},{key:"convertTransformList",value:function(e){for(var t=[],r=0;r<e.numberOfItems;r++){var n=e.getItem(r);t.push(F(n.type,n.matrix,n.angle))}return t}},{key:"filterTransforms",value:function(e,t){return(t?e.filter(function(e){return!t.includes(e.type)}):e).filter(function(e){return!(e.type===SVGTransform.SVG_TRANSFORM_SCALE&&1===e.matrix.a&&1===e.matrix.d)})}},{key:"applyTransforms",value:function(t,r,n,a){for(var i=e.clonePoints(r),s=t.slice(0).reverse(),o=Array.isArray(u=s),l=0,u=o?u:u[Symbol.iterator]();;){var c;if(o){if(l>=u.length)break;c=u[l++]}else{if((l=u.next()).done)break;c=l.value}var f=c,h=0,v=0,m=0,p=0,y=0,g=0;if(n)switch(f.type){case SVGTransform.SVG_TRANSFORM_SCALE:f.method.x&&(h+=n.x),f.method.y&&(p+=n.y);break;case SVGTransform.SVG_TRANSFORM_SKEWX:f.method.y&&(v-=n.y);break;case SVGTransform.SVG_TRANSFORM_SKEWY:f.method.x&&(m-=n.x);break;case SVGTransform.SVG_TRANSFORM_ROTATE:f.method.x&&(m-=n.x,y=n.x+U(f.angle,n.x)),f.method.y&&(v-=n.y,g=n.y+U(f.angle,n.y))}var d=f.matrix;if(a)switch(f.type){case SVGTransform.SVG_TRANSFORM_SCALE:a.x*=d.a,a.y*=d.d;break;case SVGTransform.SVG_TRANSFORM_ROTATE:0!==f.angle&&(a.angle=(a.angle||0)+f.angle);break;case SVGTransform.SVG_TRANSFORM_TRANSLATE:a.x+=d.e,a.y+=d.f}for(var b=Array.isArray(A=i),k=0,A=b?A:A[Symbol.iterator]();;){var S;if(b){if(k>=A.length)break;S=A[k++]}else{if((k=A.next()).done)break;S=k.value}var x=S,T=x.x;if(x.x=j(d,T+h,x.y+v)+y,x.y=q(d,T+m,x.y+p)+g,f.type===SVGTransform.SVG_TRANSFORM_SCALE&&void 0!==x.rx&&void 0!==x.ry){var E=x.rx;x.rx=j(d,E+h,x.ry+v),x.ry=q(d,E+m,x.ry+p)}}}return i}},{key:"getCenterPoint",value:function(e){var t=e.map(function(e){return e.x}),r=e.map(function(e){return e.y});return{x:(W.minArray(t)+W.maxArray(t))/2,y:(W.minArray(r)+W.maxArray(r))/2}}},{key:"clonePoints",value:function(e){var t=[];if(Array.isArray(e))for(var r=Array.isArray(a=e),n=0,a=r?a:a[Symbol.iterator]();;){var i;if(r){if(n>=a.length)break;i=a[n++]}else{if((n=a.next()).done)break;i=n.value}var s=i,o={x:s.x,y:s.y};void 0!==s.rx&&void 0!==s.ry&&(o.rx=s.rx,o.ry=s.ry),t.push(o)}else for(var l=0;l<e.numberOfItems;l++){var u=e.getItem(l);t.push({x:u.x,y:u.y})}return t}},{key:"fromNumberList",value:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push({x:e[r],y:e[r+1]});return t.length%2==0?t:[]}},{key:"toNumberList",value:function(e){for(var t,r=[],n=/-?[\d.]+/g;null!==(t=n.exec(e));){var a=parseFloat(t[0]);isNaN(a)||r.push(a)}return r}},{key:"getPathPoints",value:function(e){for(var t=[],r=0,n=0,a=0;a<e.length;a++){for(var i=e[a],s=0;s<i.coordinates.length;s+=2){i.relative?(r+=i.coordinates[s],n+=i.coordinates[s+1]):(r=i.coordinates[s],n=i.coordinates[s+1]);var o={x:r,y:n};"A"===i.command.toUpperCase()&&(o.rx=i.radiusX,o.ry=i.radiusY),t.push(o)}if(i.relative){switch(i.command){case"h":case"v":var l,u=e[a-1];if(u&&"M"===u.command)(l=u.coordinates).push.apply(l,m(i.coordinates)),e.splice(a,1),a--;i.command="M";break;default:i.command=i.command.toUpperCase()}i.relative=!1}}return t}},{key:"rebindPathPoints",value:function(e,t){var r=t.slice(0);e:for(var n=Array.isArray(i=e),a=0,i=n?i:i[Symbol.iterator]();;){var s;if(n){if(a>=i.length)break;s=i[a++]}else{if((a=i.next()).done)break;s=a.value}var o=s;switch(o.command.toUpperCase()){case"M":case"L":case"H":case"V":case"C":case"S":case"Q":case"T":for(var l=0;l<o.coordinates.length;l+=2){var u=r.shift();if(!u){e=[];break e}o.coordinates[l]=u.x,o.coordinates[l+1]=u.y}break;case"A":var c=r.shift();if(!c||void 0===c.rx||void 0===c.ry){e=[];break e}o.coordinates[0]=c.x,o.coordinates[1]=c.y,o.radiusX=c.rx,o.radiusY=c.ry}}return e}},{key:"fromPathCommandList",value:function(e){for(var t="",r=Array.isArray(a=e),n=0,a=r?a:a[Symbol.iterator]();;){var i;if(r){if(n>=a.length)break;i=a[n++]}else{if((n=a.next()).done)break;i=n.value}var s=i;switch(t+=(""!==t?" ":"")+s.command,s.command.toUpperCase()){case"M":case"L":case"C":case"S":case"Q":case"T":t+=s.coordinates.join(",");break;case"H":t+=s.coordinates[0];break;case"V":t+=s.coordinates[1];break;case"A":t+="".concat(s.radiusX,",").concat(s.radiusY,",").concat(s.xAxisRotation,",").concat(s.largeArcFlag,",").concat(s.sweepFlag,",").concat(s.coordinates.join(","))}}return t}},{key:"toPathCommandList",value:function(t){var r,n=[],a=/([A-Za-z])([^A-Za-z]+)?/g;for(t=t.trim();null!==(r=a.exec(t))&&(0!==n.length||"M"===r[1].toUpperCase());){r[2]=(r[2]||"").trim();var i=e.toNumberList(r[2]),s=n[n.length-1],o=s?s.command.toUpperCase():"",l=s?s.points[s.points.length-1]:void 0,u=void 0,c=void 0,f=void 0,h=void 0,p=void 0;switch(r[1].toUpperCase()){case"M":0===n.length&&(r[1]="M");case"L":if(i.length>=2){i.length%2!=0&&i.length--;break}continue;case"H":if(l&&i.length){i[1]="h"===r[1]?0:l.y,i.length=2;break}continue;case"V":if(l&&i.length){var y=i[0];i[0]="v"===r[1]?0:l.x,i[1]=y,i.length=2;break}continue;case"Z":if(n.length){i.push.apply(i,m(n[0].coordinates.slice(0,2))),r[1]="Z";break}continue;case"C":if(i.length>=6){i.length=6;break}continue;case"S":if(i.length>=4&&("C"===o||"S"===o)){i.length=4;break}continue;case"Q":if(i.length>=4){i.length=4;break}continue;case"T":if(i.length>=2&&("Q"===o||"T"===o)){i.length=2;break}continue;case"A":if(i.length>=7){var g=v(i.splice(0,5),5);u=g[0],c=g[1],f=g[2],h=g[3],p=g[4],i.length=2;break}continue;default:continue}if(i.length>1){for(var d=[],b=/[a-z]/.test(r[1]),k=0;k<i.length;k+=2){var A=i[k],S=i[k+1];b&&l&&(l={x:A+=l.x,y:S+=l.y}),d.push({x:A,y:S})}n.push({command:r[1],relative:b,coordinates:i,points:d,radiusX:u,radiusY:c,xAxisRotation:f,largeArcFlag:h,sweepFlag:p})}}return n}}]),e}(),K=squared.lib.dom,Z=function(e){return function(t){function r(){var e;return a(this,r),(e=c(this,l(r).apply(this,arguments)))._baseVal={},e}return o(r,e),s(r,[{key:"setBaseValue",value:function(e,t){if(void 0!==t){if(this.validateType(e,t))return this._baseVal[e]=t,!0}else switch(e){case"d":return this._baseVal[e]=K.cssAttribute(this.element,"d"),!0;case"points":var r=this.element[e];if(Array.isArray(r))return this._baseVal[e]=H.clonePoints(r),!0;break;default:var n=this.element[e];if(n&&n.baseVal)return this._baseVal[e]=n.baseVal.value,!0}return!1}},{key:"getBaseValue",value:function(e,t){return void 0!==this._baseVal[e]||this.setBaseValue(e)?this._baseVal[e]:t}},{key:"validateType",value:function(e,t){switch(e){case"d":return"string"==typeof t;case"cx":case"cy":case"r":case"rx":case"ry":case"x1":case"x2":case"y1":case"y2":case"x":case"y":case"width":case"height":return"number"==typeof t;case"points":return Array.isArray(t)}return!1}}]),r}()},$=squared.lib.util,Q=function(){function e(t){if(a(this,e),this.attributeName="",this.to="",this.begin=[0],this.duration=-1,this.paused=!1,t){this.element=t,this.setAttribute("attributeName"),this.setAttribute("to");var r=this.getAttribute("begin");"indefinite"===r?this.begin.length=0:/^[a-zA-Z]+$/.test(r)?this.paused=!0:""!==r&&(this.begin=X(r.split(";").map(function(e){return M(e)})));var n=this.getAttribute("dur");n&&"indefinite"!==n&&(this.duration=M(n))}}return s(e,[{key:"setAttribute",value:function(e,t){var r=this.getAttribute(e);r&&(void 0!==t?this[e+$.capitalize(t)]=r===t:this[e]=r)}},{key:"getAttribute",value:function(e){var t=this.element&&this.element.attributes.getNamedItem(e);return t?t.value.trim():""}},{key:"instanceType",get:function(){return 0}}]),e}(),J={ease:"0.25 0.1 0.25 1","ease-in":"0.42 0 1 1","ease-in-out":"0.42 0 0.58 1","ease-out":"0 0 0.58 1",linear:"0 0 1 1",step:"0 1 0 1"},ee=Object.freeze({KEYSPLINE_NAME:J}),te=squared.lib.color,re=squared.lib.dom,ne=squared.lib.util;function ae(e,t,r){return e+(t-e)*r}function ie(e){return parseFloat((1-e).toFixed(5))}var se=function(e){function r(e){var t;if(a(this,r),(t=c(this,l(r).call(this,e))).element=e,t.from="",t.by="",t.values=[],t.keyTimes=[],t.repeatDuration=-1,t.additiveSum=!1,t.accumulateSum=!1,t.fillMode=0,t.alternate=!1,t._repeatCount=1,t._reverse=!1,e){var n,i,s=t.getAttribute("values"),o=t.getAttribute("keyTimes");if(""!==s&&""!==o)(n=t.values).push.apply(n,m(ne.flatMap(s.split(";"),function(e){return e.trim()}))),(i=t.keyTimes).push.apply(i,m(r.toFractionList(o))),t.values.length>1&&t.keyTimes.length===t.values.length?(0===t.keyTimes[0]&&(t.from=t.values[0]),t.to=t.values[t.values.length-1]):(t.values.length=0,t.keyTimes.length=0);var u=t.getAttribute("from");if(0===t.values.length&&""!==t.to){if(""!==u)t.from=u;else if("transform"===t.attributeName)t.from=I(t.getAttribute("type"));else if(e.parentElement){var f=ne.optionalAsString(e.parentElement,"".concat(t.attributeName,".baseVal.value"));t.from=""!==f?f:re.cssAttribute(e.parentElement,t.attributeName)}t.values.push(t.from,t.to),t.keyTimes.push(0,1),t.setAttribute("by")}""===s&&""!==u&&""!==t.to&&(t.setAttribute("additive","sum"),t.additiveSum&&t.setAttribute("accumulate","sum"));var h=t.getAttribute("repeatDur");h&&"indefinite"!==h&&(t.repeatDuration=M(h));var v=t.getAttribute("repeatCount");if(t.repeatCount="indefinite"===v?-1:parseFloat(v),t.begin.length){var p=t.getAttribute("end");if(""!==p){var y=X(p.split(";").map(function(e){return M(e)}));!y.length||1!==t.begin.length&&t.begin[t.begin.length-1]===t.end&&0!==y[0]||(t.end=y[0],t.begin=t.begin.filter(function(e){return e>=0&&e<y[0]}),t.begin.length&&-1===t.repeatCount&&(t.repeatCount=t.end/t.duration))}}"animate"===e.tagName&&t.setCalcMode(t.attributeName)}return t}return o(r,Q),s(r,[{key:"setCalcMode",value:function(e){var n=this;if(this.element){var a=function(){switch(n.getAttribute("calcMode")){case"discrete":for(var t=[],a=[],i=[],s=0;s<n.keyTimes.length-1;s++){var o=r.toStepFractionList(e,"steps-start",s,n.keyTimes,n.values,w(),R(n.element));if(!o)return{v:void 0};t.push.apply(t,m(o[0])),a.push.apply(a,m(o[1])),o[0].forEach(function(){return i.push(J.step)})}t.push(n.keyTimes.pop()),a.push(n.values.pop()),n.keyTimes=t,n.values=a,n._keySplines=i;break;case"spline":n.keySplines=ne.flatMap(n.getAttribute("keySplines").split(";"),function(e){return e.trim()})}}();if("object"===t(a))return a.v}}},{key:"repeatCount",set:function(e){(isNaN(e)?this._repeatCount=1:(this._repeatCount=e,-1!==e&&(this.repeatDuration=-1)),this.element)&&("freeze"===this.getAttribute("fill")&&-1!==this.repeatCount?this.fillMode|=8:ne.hasBit(this.fillMode,8)&&(this.fillMode^=8))},get:function(){var e=this.duration;return-1!==e?-1===this._repeatCount&&-1===this.repeatDuration?-1:-1!==this._repeatCount&&-1!==this.repeatDuration?this._repeatCount*e<=this.repeatDuration?this._repeatCount:this.repeatDuration/e:-1!==this.repeatDuration?this.repeatDuration/e:this._repeatCount:1}},{key:"keySplines",set:function(e){if(e){var t=this.keyTimes.length-1;if(t>0&&e.length>=t&&!e.every(function(e){return""===e})){for(var r=[],n=0;n<t;n++){var a=e[n].split(" ").map(function(e){return parseFloat(e)});4===a.length&&!a.some(function(e){return isNaN(e)})&&a[0]>=0&&a[0]<=1&&a[2]>=0&&a[2]<=1?r.push(a.join(" ")):r.push(J.linear)}this._keySplines=r}}else this._keySplines=void 0},get:function(){return this._keySplines}},{key:"reverse",set:function(e){if(e!==this._reverse&&this.values.length){if(this.values.reverse(),this._keySplines){for(var t=[],r=this._keySplines.length-1;r>=0;r--){var n=this._keySplines[r].split(" ").map(function(e){return parseFloat(e)});t.push(4===n.length?"".concat(ie(n[2])," ").concat(ie(n[3])," ").concat(ie(n[0])," ").concat(ie(n[1])):J.linear)}this._keySplines=t}this._reverse=e}},get:function(){return this._reverse}},{key:"fromToType",get:function(){return this.keyTimes.length>0&&0===this.keyTimes[0]&&1===this.keyTimes[1]}},{key:"instanceType",get:function(){return 1}}],[{key:"toStepFractionList",value:function(e,t,r,n,a){var i,s,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:96,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:16;switch(e){case"fill":case"stroke":var u=te.parseRGBA(a[r]),c=te.parseRGBA(a[r+1]);u&&c&&(i=[u],s=[c]);break;case"points":i=H.fromNumberList(H.toNumberList(a[r])),s=H.fromNumberList(H.toNumberList(a[r+1]));break;case"rotate":case"scale":case"translate":i=a[r].split(" ").map(function(e){return parseFloat(e)}),s=a[r+1].split(" ").map(function(e){return parseFloat(e)});break;default:ne.isNumber(a[r])?i=[parseFloat(a[r])]:ne.isUnit(a[r])&&(i=[parseFloat(ne.convertPX(a[r],o,l))]),ne.isNumber(a[r+1])?s=[parseFloat(a[r+1])]:ne.isUnit(a[r+1])&&(s=[parseFloat(ne.convertPX(a[r+1],o,l))])}if(i&&s&&i.length&&i.length===s.length){switch(t){case"steps-start":t="steps(1, start)";break;case"steps-end":t="steps(1, end)"}var f=/steps\((\d+)(?:, (start|end))?\)/.exec(t);if(f){for(var h=n[r+1]-n[r],v=parseInt(f[1]),m=100/v,p=[],y=[],g=0,d="start"===f[2]?1:0;g<v;g++){var b=n[r]+h*(g/v),k=[],A=(d>0&&g===v-1?100:m*(g+d))/100;switch(e){case"fill":case"stroke":var S=i[0],x=s[0],T=te.convertHex(ae(S.rgba.r,x.rgba.r,A)),E=te.convertHex(ae(S.rgba.g,x.rgba.g,A)),V=te.convertHex(ae(S.rgba.b,x.rgba.b,A)),w=te.convertHex(ae(S.rgba.a,x.rgba.a,A));k.push("#".concat(T+E+V+("FF"!==w?w:"")));break;case"points":for(var R=0;R<i.length;R++){var M=i[R],N=s[R];k.push("".concat(ae(M.x,N.x,A),",").concat(ae(M.y,N.y,A)))}break;default:for(var _=0;_<i.length;_++){k.push(""+ae(i[_],s[_],A))}}if(!k.length)return;p.push(b),y.push(k.join(" "))}return[p,y]}}}},{key:"toFractionList",value:function(e){var t=-1,r=ne.flatMap(e.split(arguments.length>1&&void 0!==arguments[1]?arguments[1]:";"),function(e){var r=parseFloat(e);return!isNaN(r)&&r<=1&&(-1===t||r>t)?(t=r,r):-1});return r.length>1&&r.some(function(e){return-1!==e})&&0===r[0]?r:[]}}]),r}(),oe=function(e){function t(e){var r;if(a(this,t),(r=c(this,l(t).call(this,e))).element=e,r.type=0,e){var n=r.getAttribute("type");r.setType(n),r.setCalcMode(n)}return r}return o(t,se),s(t,[{key:"setType",value:function(e){switch(e){case"translate":this.type=SVGTransform.SVG_TRANSFORM_TRANSLATE;break;case"scale":this.type=SVGTransform.SVG_TRANSFORM_SCALE;break;case"rotate":this.type=SVGTransform.SVG_TRANSFORM_ROTATE;break;case"skewX":this.type=SVGTransform.SVG_TRANSFORM_SKEWX;break;case"skewY":this.type=SVGTransform.SVG_TRANSFORM_SKEWY}}},{key:"instanceType",get:function(){return 2}}],[{key:"toRotateList",value:function(e){var t=e.map(function(e){if(""===e)return[null,null,null];var t=H.toNumberList(e);return 1===t.length||3===t.length?t:[]});return t.some(function(e){return 0===e.length})?void 0:t}},{key:"toScaleList",value:function(e){var t=e.map(function(e){if(""===e)return[null,null];var t=H.toNumberList(e);return 1===t.length?[t[0],t[0]]:2===t.length?t:[]});return t.some(function(e){return 0===e.length})?void 0:t}},{key:"toTranslateList",value:function(e){var t=null,r=e.map(function(e){if(""===e)return[null,null];var r=H.toNumberList(e);return 1===r.length?[r[0],t]:2===r.length?(t=r[1],r):[]});return r.some(function(e){return 0===e.length})?void 0:r}}]),t}(),le=squared.lib.color,ue=squared.lib.dom,ce=squared.lib.util,fe=function(e){return function(t){function r(){var e;return a(this,r),(e=c(this,l(r).apply(this,arguments))).fill="black",e.fillPattern="",e.fillOpacity="1",e.fillRule="nonzero",e.stroke="",e.strokeWidth="1",e.strokePattern="",e.strokeOpacity="1",e.strokeLinecap="butt",e.strokeLinejoin="miter",e.strokeMiterlimit="4",e.strokeDashArray="",e.strokeDashOffset="0",e.color="",e.clipPath="",e.clipRule="",e.parentElement=null,e}return o(r,e),s(r,[{key:"setPaint",value:function(){this.setAttribute("color"),this.setColor("fill"),this.setAttribute("fill-opacity"),this.setAttribute("fill-rule"),this.setColor("stroke"),this.setAttribute("stroke-opacity"),this.setAttribute("stroke-width"),this.setAttribute("stroke-linecap"),this.setAttribute("stroke-linejoin"),this.setAttribute("stroke-miterlimit"),this.setAttribute("stroke-dasharray"),this.setAttribute("stroke-dashoffset");var e=ce.REGEXP_PATTERN.CSS_URL.exec(this.getAttribute("clip-path"));e&&(this.clipPath=e[1]),this.setAttribute("clip-rule")}},{key:"setColor",value:function(e){var t=this.element,r=this.getAttribute(e),n=ce.REGEXP_PATTERN.CSS_URL.exec(r);if(n)this["".concat(e,"Pattern")]=n[1],r="";else if(""!==r)switch(r.toLowerCase()){case"none":case"transparent":case"rgba(0, 0, 0, 0)":r="";break;case"currentcolor":var a=le.parseRGBA(this.color||ue.cssAttribute(t,e,!0));r=a?a.valueRGB:null;break;default:var i=le.parseRGBA(r);i&&(r=i.valueRGB)}else"fill"===e&&(r=null);null!==r&&(this[e]=r)}},{key:"setAttribute",value:function(e){var t=this.getAttribute(e);""!==t&&(this[ce.convertCamelCase(e)]=t)}},{key:"getAttribute",value:function(e){return ue.cssAttribute(this.element,e)||(this.parentElement?ue.cssAttribute(this.parentElement,e):"")}}]),r}()},he=function(){function e(t){a(this,e),this.element=t}return s(e,[{key:"build",value:function(e,t){}},{key:"synchronize",value:function(e){}}]),e}(),ve=function(e){function t(e,r){var n;return a(this,t),(n=c(this,l(t).call(this,e))).element=e,n.name="",n.value="",n.transformed=null,r?n.parentElement=r:(N.g(e.parentElement)||N.use(e.parentElement))&&(n.parentElement=e.parentElement),n.init(),n}return o(t,fe(Z(he))),s(t,[{key:"draw",value:function(e,r){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=this.element,i="";n&&(this.transformed=null);var s=this.parent;if(N.path(a)){if(i=this.getBaseValue("d"),s&&1!==s.aspectRatio.unit||e&&e.length){var o=H.toPathCommandList(i);if(o.length){var l=H.getPathPoints(o);if(l.length){if(e&&e.length){if("function"==typeof r){var u=v(r.call(this,a,e),2);this.transformResidual=u[0],e=u[1]}e.length&&(l=this.transformPoints(e,l),this.transformed=e)}s&&s.refitPoints(l),i=H.fromPathCommandList(H.rebindPathPoints(o,l))}}}}else if(N.line(a)){var c=[{x:this.getBaseValue("x1"),y:this.getBaseValue("y1")},{x:this.getBaseValue("x2"),y:this.getBaseValue("y2")}];if(e&&e.length){if("function"==typeof r){var f=v(r.call(this,a,e),2);this.transformResidual=f[0],e=f[1]}e.length&&(c=this.transformPoints(e,c),this.transformed=e)}s&&s.refitPoints(c),i=t.getPolyline(c)}else if(N.circle(a)||N.ellipse(a)){var h,m;N.ellipse(a)?(h=this.getBaseValue("rx"),m=this.getBaseValue("ry")):m=h=this.getBaseValue("r");var p=[{x:this.getBaseValue("cx"),y:this.getBaseValue("cy"),rx:h,ry:m}];if(e&&e.length){if("function"==typeof r){var y=v(r.call(this,a,e,h,m),2);this.transformResidual=y[0],e=y[1]}e.length&&(p=this.transformPoints(e,p),this.transformed=e)}s&&s.refitPoints(p);var g=p[0];i=t.getEllipse(g.x,g.y,g.rx,g.ry)}else if(N.rect(a)){var d=this.getBaseValue("x"),b=this.getBaseValue("y"),k=this.getBaseValue("width"),A=this.getBaseValue("height");if(e&&e.length){var S=[{x:d,y:b},{x:d+k,y:b},{x:d+k,y:b+A},{x:d,y:b+A}];if("function"==typeof r){var x=v(r.call(this,a,e),2);this.transformResidual=x[0],e=x[1]}e.length&&(S=this.transformPoints(e,S),this.transformed=e),s&&s.refitPoints(S),i=t.getPolygon(S)}else s&&(d=s.refitX(d),b=s.refitY(b),k=s.refitSize(k),A=s.refitSize(A)),i=t.getRect(k,A,d,b)}else if(N.polygon(a)||N.polyline(a)){var T=this.getBaseValue("points");if(e&&e.length){if("function"==typeof r){var E=v(r.call(this,a,e),2);this.transformResidual=E[0],e=E[1]}e.length&&(T=this.transformPoints(e,T),this.transformed=e)}s&&s.refitPoints(T),i="polygon"===a.tagName?t.getPolygon(T):t.getPolyline(T)}return n&&(this.value=i),i}},{key:"transformPoints",value:function(e,t,r){return H.applyTransforms(e,t,B(this.element),r)}},{key:"init",value:function(){var e=this.element;N.path(e)?this.setBaseValue("d"):N.line(e)?(this.setBaseValue("x1"),this.setBaseValue("y1"),this.setBaseValue("x2"),this.setBaseValue("y2")):N.rect(e)?(this.setBaseValue("x"),this.setBaseValue("y"),this.setBaseValue("width"),this.setBaseValue("height")):N.circle(e)?(this.setBaseValue("cx"),this.setBaseValue("cy"),this.setBaseValue("r")):N.ellipse(e)?(this.setBaseValue("cx"),this.setBaseValue("cy"),this.setBaseValue("rx"),this.setBaseValue("ry")):(N.polygon(e)||N.polyline(e))&&this.setBaseValue("points",H.clonePoints(e.points)),this.setPaint()}},{key:"transform",get:function(){return void 0===this._transform&&(this._transform=L(this.element)||H.convertTransformList(this.element.transform.baseVal)),this._transform}}],[{key:"getLine",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return"M".concat(e,",").concat(t," L").concat(r,",").concat(n)}},{key:"getCircle",value:function(e,r,n){return t.getEllipse(e,r,n)}},{key:"getEllipse",value:function(e,t,r,n){return void 0===n&&(n=r),"M".concat(e-r,",").concat(t," a").concat(r,",").concat(n,",0,1,0,").concat(2*r,",0 a").concat(r,",").concat(n,",0,1,0,-").concat(2*r,",0")}},{key:"getRect",value:function(e,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return"M".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,",").concat(r," h").concat(e," v").concat(t," h").concat(-e," Z")}},{key:"getPolygon",value:function(e){var r=t.getPolyline(e);return""!==r?r+" Z":""}},{key:"getPolyline",value:function(e){return e.length?"M".concat(e.map(function(e){return"".concat(e.x,",").concat(e.y)}).join(" ")):""}}]),t}(),me=squared.lib.util;function pe(e,t,r){var n,a,i=e.entries(),s=Array.isArray(i),o=0;for(i=s?i:i[Symbol.iterator]();;){var l;if(s){if(o>=i.length)break;l=i[o++]}else{if((o=i.next()).done)break;l=o.value}var u=v(l,2),c=u[0],f=u[1];if(n&&r<=c){a={ordinal:c,value:f};break}r>=c&&(n={ordinal:c,value:f})}if(n&&a){var h=Ae(r,n.ordinal,a.ordinal,n.value,a.value);t.set(r,h)}else n&&t.set(r,n.value)}function ye(e,t){var r=new Map,n=e.entries(),a=Array.isArray(n),i=0;for(n=a?n:n[Symbol.iterator]();;){var s;if(a){if(i>=n.length)break;s=n[i++]}else{if((i=n.next()).done)break;s=i.value}var o=v(s,2),l=o[1],u=o[0]/t;if(u>0)for(var c=5;;c++){var f=parseFloat((""+u).substring(0,c));if(!r.has(f)){u=f;break}}r.set(u,l)}return r}function ge(e,r,n,a){var i,s=[],o=r.element.tagName;switch(o){case"line":i=["x1","y1","x2","y2"];break;case"rect":i=["width","height","x","y"];break;case"polyline":case"polygon":i=["points"];break;case"circle":i=["cx","cy","r"];break;case"ellipse":i=["cx","cy","rx","ry"];break;default:return}var l=function(){if(c){if(f>=u.length)return"break";h=u[f++]}else{if((f=u.next()).done)return"break";h=f.value}var e,t=v(h,2),l=t[0],m=t[1],p=[];if(i.forEach(function(e){if(m.has(e))p.push(m.get(e));else if(a&&a[e])p.push(a[e].value);else{var t=r.getBaseValue(e);void 0!==t&&p.push(t)}}),p.length!==i.length)return{v:void 0};switch(o){case"line":e=function(e){return[{x:e[0],y:e[1]},{x:e[2],y:e[4]}]}(p);break;case"rect":e=function(e){var t=e[0],r=e[1],n=e[2],a=e[3];return[{x:n,y:a},{x:n+t,y:a},{x:n+t,y:a+r},{x:n,y:a+r}]}(p);break;case"polygon":case"polyline":e=p[0];break;case"circle":case"ellipse":e=function(e){return[{x:e[0],y:e[1],rx:e[2],ry:e[e.length-1]}]}(p)}if(e){var y;switch(r.transformed&&r.transformed.length&&(e=H.applyTransforms(r.transformed,e,B(r.element))),n&&n.refitPoints(e),o){case"line":case"polyline":y=ve.getPolyline(e);break;case"rect":case"polygon":y=ve.getPolygon(e);break;case"circle":case"ellipse":var g=e[0];y=ve.getEllipse(g.x,g.y,g.rx,g.ry)}void 0!==y&&s.push({ordinal:l,value:y})}};var u=e.entries(),c=Array.isArray(u),f=0;e:for(u=c?u:u[Symbol.iterator]();;){var h,m=l();switch(m){case"break":break e;default:if("object"===t(m))return m.v}}return s}function de(e,t,r){for(var n=new Map,a=Array.isArray(s=t),i=0,s=a?s:s[Symbol.iterator]();;){var o;if(a){if(i>=s.length)break;o=s[i++]}else{if((i=s.next()).done)break;o=i.value}var l=o,u=new Map;for(var c in e){var f=e[c].get(l);void 0!==f&&u.set(c,f)}if(r)for(var h in r)!u.has(h)&&l>=r[h].ordinal&&u.set(h,r[h].value);n.set(l,u)}return n}function be(e,t,r,n,a){return Math.round(e+(r[a]+n)*t)}function ke(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=e.alternate&&n%2!=0?e.values.slice(0).reverse():e.values;if("number"==typeof r){var i=parseFloat(a[t]);if(e.additiveSum){i+=r,e.accumulateSum||(n=0);for(var s=0;s<n;s++)for(var o=0;o<a.length;o++)i+=parseFloat(a[o])}return i}var l=[];return a[t].trim().split(/\s+/).forEach(function(e){var t=v(e.split(",").map(function(e){return parseFloat(e)}),2);l.push({x:t[0],y:t[1]})}),l}function Ae(e,t,r,n,a){if("number"==typeof n&&"number"==typeof a)return n+(e-t)/(r-t)*(a-n);if(Array.isArray(n)&&Array.isArray(a)){for(var i=[],s=0;s<Math.min(n.length,a.length);s++)i.push({x:Ae(e,t,r,n[s].x,a[s].x),y:Ae(e,t,r,n[s].y,a[s].y)});return i}return n}function Se(e){return!e.paused&&e.begin.length>0&&e.keyTimes.length>1&&e.duration>0}function xe(e){return-1!==e.repeatCount?e.duration*e.repeatCount:Number.MAX_VALUE}function Te(e){return e.duration*(-1!==e.repeatCount?e.repeatCount:1)}var Ee=function(e){return function(r){function n(){return a(this,n),c(this,l(n).apply(this,arguments))}return o(n,e),s(n,[{key:"getAnimateShape",value:function(){for(var e=this.element,t=[],r=Array.isArray(a=this.animation),n=0,a=r?a:a[Symbol.iterator]();;){var i;if(r){if(n>=a.length)break;i=a[n++]}else{if((n=a.next()).done)break;i=n.value}var s=i;if(Se(s))switch(s.attributeName){case"r":case"cx":case"cy":if(N.circle(e)){t.push(s);break}case"rx":case"ry":N.ellipse(e)&&t.push(s);break;case"x1":case"x2":case"y1":case"y2":N.line(e)&&t.push(s);break;case"points":(N.polyline(e)||N.polygon(e))&&t.push(s);break;case"x":case"y":case"width":case"height":N.rect(e)&&t.push(s)}}return t}},{key:"getAnimateViewRect",value:function(){for(var e=[],t=Array.isArray(n=this.animation),r=0,n=t?n:n[Symbol.iterator]();;){var a;if(t){if(r>=n.length)break;a=n[r++]}else{if((r=n.next()).done)break;a=r.value}var i=a;if(Se(i))switch(i.attributeName){case"x":case"y":e.push(i)}}return e}},{key:"mergeAnimate",value:function(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;(e.length>1||e.some(function(e){return e.begin.length>1||!e.fromToType||e.alternate||void 0!==e.end||e.additiveSum}))&&function(){for(var i=function(e,t,r,n,a,i,o){for(var l,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=(o-(a+r.duration*i))/r.duration,f=r.keyTimes,h=-1,v=-1,m=0;m<f.length;m++){if(-1!==h&&c<=f[m]){v=m;break}c>=f[m]&&(h=m)}l=-1!==h&&-1!==v?Ae(c,f[h],f[v],ke(r,h,n,i),ke(r,v,n,i)):ke(r,v=-1!==h?h+1:f.length-1,n,i);var p=o+u;if(e.get(p)!==l){for(;e.has(p);)p++;s(t,p,r.keySplines,v),e.set(p,l)}return[p,l]},s=function(e,t,r,a){if(!n){if(0===a)return;a--}var i=r&&r[a]||"";if(""!==i){var s=e.get(t)||new Set;s.add(i),e.set(t,s)}},o=e.filter(function(e){return void 0===e.element}),l=me.minArray(o.map(function(e){return e.begin[0]})),u=me.maxArray(o.map(function(e){return xe(e)})),c=o.filter(function(e){return me.hasBit(e.fillMode,2)}),f={},h=0,p=Array.isArray(g=e),y=0,g=p?g:g[Symbol.iterator]();;){var d;if(p){if(y>=g.length)break;d=g[y++]}else{if((y=g.next()).done)break;d=y.value}var b=d,k=b.attributeName;void 0===f[k]&&(f[k]=new Map);for(var A=Array.isArray(x=b.begin),S=0,x=A?x:x[Symbol.iterator]();;){var T;if(A){if(S>=x.length)break;T=x[S++]}else{if((S=x.next()).done)break;T=S.value}var E=T;if(void 0===b.element||0===c.length&&E<l||xe(b)>u){var V=f[k].get(E)||{duration:0,items:[]};V.items.push(b),f[k].set(E,V)}}}for(var w in f)if(f[w].size){var R=f[w],M=Number.MAX_VALUE,N=function(){if(O){if(G>=_.length)return"break";C=_[G++]}else{if((G=_.next()).done)return"break";C=G.value}var e=v(C,2),t=e[0],r=e[1];r.items.sort(function(e,t){return e.element&&void 0===t.element?-1:0});var n=r.items.length-1,a=[];do{for(var i=r.items[n],s=-1===i.repeatCount||i.fillMode>=4,o=i.duration*i.repeatCount,l=0;l<n;l++){var u=r.items[l];(s||-1!==u.repeatCount&&u.duration*u.repeatCount<=o)&&a.push(u)}if(-1!==i.repeatCount&&i.fillMode>=4&&(M=Math.min(t+o,M)),s)break}while(--n>=0);r.items=r.items.filter(function(e){return!a.includes(e)}),R.set(t,r)},_=R.entries(),O=Array.isArray(_),G=0;for(_=O?_:_[Symbol.iterator]();;){var C;if("break"===N())break}var F=new Map,L=X(Array.from(R.keys())),P=Array.isArray(L),B=0;for(L=P?L:L[Symbol.iterator]();;){var I;if(P){if(B>=L.length)break;I=L[B++]}else{if((B=L.next()).done)break;I=B.value}var j=I,q=R.get(j);if(q){var U=me.maxArray(q.items.map(function(e){return Te(e)}));h=Math.max(h,j+U),q.items=q.items.filter(function(e){return!c.includes(e)}),q.items.length&&(q.duration=U,q.items.reverse(),F.set(j,q))}}f[w]=F}else delete f[w];var z,W,Y={},K={},Z=new Map,$=new Map,Q=new Set,J={},ee={},te=0,re=function(e){var t;try{t=(a||r).getBaseValue(e)}catch(e){}return null!=t?t:"points"===e?[{x:0,y:0}]:0};e:{var ne=function(e){Y[e]=new Map;var r=Array.from(f[e].keys()),n=Array.from(f[e].values()),a=re(e),l=[],u=a,m=void 0,p=-1;function y(t,r){return l=l.filter(function(e){return e.value!==t}),me.hasBit(t.fillMode,4)?(ee[e]=!0,0===(o=o.filter(function(t){return t.attributeName!==e})).length?2:1):me.hasBit(t.fillMode,8)?(J[e]={ordinal:p,value:u},1):(r&&Y[e].set(++p,a),0)}if(c.length&&(m=c.filter(function(t){return t.attributeName===e})).length){for(var g=Array.isArray(b=m),d=0,b=g?b:b[Symbol.iterator]();;){var k;if(g){if(d>=b.length)break;k=b[d++]}else{if((d=b.next()).done)break;k=d.value}var A=k;r.unshift(A.begin[0]),n.unshift({duration:Te(A),items:[A]})}var S=n[0].items[0];u=ke(S,S.reverse?0:S.values.length-1,u,0),Y[e].set(0,u)}t:{for(var x=function(a){var c=n[a].items;if(0===c.length)return"continue";var f=r[a],g=-1;f<0&&(g=Math.max(0,p),p=Math.max(p,Math.abs(f)),f=0);for(var d=-1,b=0,k=function(t){var g=c[t];t===d&&(f=b,d=-1,b=0);var k=-1===g.repeatCount,S=g.duration,x=g.repeatCount,T=S;if(!k&&f+Math.min(g.end||Number.MAX_VALUE,T*=x)<=p)return A=t,"continue";var E=void 0,V=void 0;k?(E=Math.ceil((h-f)/S),V=0):(E=Math.ceil(x),V=x-Math.floor(x));var w=void 0,R=0;if(g.element){if(w=r[a+1],l.length){for(var M,N=l.length-1;N>=0;N--)if(void 0===l[N].value.element){M=l[N],l.splice(N,1);break}if(M)return d=t+1,b=f,f=M.ordinal,c.splice(t,0,M.value),A=--t,"continue"}for(var _=a+1;_<r.length;_++)R=Math.max(R,r[_]+n[_].duration)}else!function(){var e=o.findIndex(function(e){return e===g});if(void 0===m||!m.includes(g))r:for(var i=a+1;i<r.length;i++){var s=function(){if(u){if(c>=l.length)return"break";f=l[c++]}else{if((c=l.next()).done)return"break";f=c.value}var t=f;if(o.findIndex(function(e){return e===t})>e)return w=r[i],"break|nextBegin"};var l=n[i].items.filter(function(e){return void 0===e.element}),u=Array.isArray(l),c=0;n:for(l=u?l:l[Symbol.iterator]();;){var f;switch(s()){case"break":break n;case"break|nextBegin":break r}}}for(var h=a+1;h<r.length;h++){var v=n[h].items.filter(function(t){return void 0===t.element&&o.findIndex(function(e){return e===t})>e});if(v.length){var p=me.maxArray(v.map(function(e){return Te(e)}));R=Math.max(R,r[t]+p)}}}();var O=Math.min(w||Number.MAX_VALUE,g.end||Number.MAX_VALUE),G=void 0,C=!1;if(O>p){C=!0;var F=-1!==p;r:for(var L=function(t){for(var n=0;n<g.keyTimes.length;n++){var o=g.keyTimes[n],l=void 0,c=ke(g,n,u,t);if(t===E-1&&V>0)if(V>o){for(var h=n+1;h<g.keyTimes.length;h++)if(V<=g.keyTimes[h]){l=f+T,c=Ae(V,o,g.keyTimes[h],c,ke(g,h,u,t)),V=-1;break}}else V===o&&(V=-1);if(void 0===l)if((l=be(f,S,g.keyTimes,t,n))===O)C=t===E-1&&n===g.keyTimes.length-1;else{var m=function(n,s){var o=v(i(Y[e],Z,g,u,f,t,n,s&&n===r[a+1]&&!Y[e].has(n-1)?-1:0),2);p=o[0],G=o[1]};if(l>O)return m(O,!0),C=!1,"break|threadTimeExceeded";if(F){if(f>=p)l=Math.max(f,p+1);else{if(l<p)continue;l===p?l=p+1:m(p,!1)}F=!1}else if(t>0&&0===n){if(g.additiveSum&&g.accumulateSum){s(Z,l,g.keySplines,n),p=l;continue}if(l===p&&Y[e].get(l)===c){s(Z,l,g.keySplines,n);continue}l=Math.max(l,p+1)}}if(l>p&&(s(Z,l,g.keySplines,n),Y[e].set(l,c),p=l,G=c),!C||-1===V)return"break|threadTimeExceeded"}},P=Math.floor(Math.max(0,p-f)/S);P<E;P++){if("break|threadTimeExceeded"===L(P))break r}}if(void 0!==G&&(u=G,k||Q.add(g)),k)l.length=0,l.push({ordinal:f,value:g});else if(C){var B=y(g,r[a+1]>p+1);if(2===B)return A=t,{v:{v:"break|animationEnd"}};if(1===B)return A=t,{v:"break|attributeEnd"}}else r[a]+T>R&&l.push({ordinal:f,value:g});A=t},A=0;A<c.length;A++){var S=k(A);switch(S){case"continue":continue;default:if("object"===t(S))return S.v}}if(-1!==g){var x=new Map;p=g;var T=Y[e].entries(),E=Array.isArray(T),V=0;for(T=E?T:T[Symbol.iterator]();;){var w;if(E){if(V>=T.length)break;w=T[V++]}else{if((V=T.next()).done)break;w=V.value}var R=v(w,2),M=R[0],N=R[1];if(M>=g)for(M+=r[a];x.has(M);)M++;x.set(M,N),p=Math.max(M,p)}Y[e]=x}},T=0;T<r.length;T++){var E=x(T);switch(E){case"continue":continue;case"break|attributeEnd":break t;default:if("object"===t(E))return E.v}}if(l.length){l.reverse();var V=function(t){var r=l[t].ordinal,n=l[t].value,a=n.duration,c=p-r,f=Number.MAX_VALUE,h=function(){var t=Math.floor(c/a),o=!1;do{for(var l=0;l<n.keyTimes.length;l++){var h=be(r,a,n.keyTimes,t,l);if(!o&&h>=p){var m=v(i(Y[e],Z,n,u,r,t,p),2);p=m[0],u=m[1],o=!0}if(o){if(h>=f){if(f>p){var y=v(i(Y[e],Z,n,u,r,t,f),2);p=y[0],u=y[1]}return}h>p&&(u=ke(n,l,u,t),s(Z,h,n.keySplines,l),Y[e].set(h,u),p=h)}}}while(p<f&&++t)};if(-1===n.repeatCount)return c>0&&c%a!=0&&(f=r+n.duration*Math.ceil(c/a),h()),K[e]={ordinal:r,value:n},void 0===n.element&&0===(o=o.filter(function(t){return t.attributeName!==e})).length?{v:"break|animationEnd"}:"break|attributeEnd";if((f=r+n.duration*n.repeatCount)>p){h(),Q.add(n);var m=y(n,!1);if(2===m)return{v:"break|animationEnd"};if(1===m)return"break|attributeEnd"}};for(T=0;T<l.length;T++){var w=V(T);switch(w){case"break|attributeEnd":break t;default:if("object"===t(w))return w.v}}}}o=o.filter(function(t){return t.attributeName!==e})};for(var ae in f){if("break|animationEnd"===ne(ae))break e}}var ie=[];for(var le in Y)ie.push.apply(ie,m(Y[le].keys()));var ue=me.maxArray(ie);if(Object.keys(K).length){var ce=[],fe=[];for(var he in K)fe.push(K[he].ordinal),ce.push(K[he].value.duration);ue=D(ce,ue,fe)}var ve=function(e){var t=Y[e],r=me.maxArray(Array.from(t.keys()));if(K[e]&&r<ue){var n=K[e].ordinal,a=K[e].value,o=Array.from(t.values()).pop(),l=Math.floor((r-n)/a.duration);do{for(var u=!1,c=0;c<a.keyTimes.length;c++){var f=be(n,a.duration,a.keyTimes,l,c);if(!u&&f>=r){var h=v(i(t,Z,a,o,n,c,r),2);o=h[1],ie.push(r=h[0]),u=!0}u&&f>r&&(o=ke(a,c,o,l),s(Z,f,a.keySplines,c),t.set(f,o),ie.push(r=f))}}while(r<ue&&++l)}if(void 0===K[e]&&void 0===J[e]&&!ee[e]){var m,p=Array.from(Q).reverse().find(function(t){return t.attributeName===e});if(p&&void 0===p.element){var y=p.values[0]||p.from;isNaN(m=parseFloat(y))&&0===(m=H.fromNumberList(H.toNumberList(y))).length&&(m=void 0)}else m=re(e);if(void 0!==m&&JSON.stringify(t.get(r))!==JSON.stringify(m)){for(;t.has(r);)r++;t.set(r,m),ie.push(r)}}};for(var Se in Y)ve(Se);var Ee=X(Array.from(new Set(ie))),Ve={};for(var we in Y){for(var Re=Y[we],Me=new Map,Ne=Array.from(Re.keys()).pop(),_e=0;_e<Ee.length;_e++){var Oe=Ee[_e];if(Oe<=Ne){var Ge=Re.get(Oe);void 0===Ge?pe(Re,Me,Oe):Me.set(Oe,Ge)}}Ve[we]=Me}if(z=de(Ve,Ee,J),h=Ee[Ee.length-1],n&&(z=ye(z,h)),Object.keys(K).length){var Ce=[],Fe={},Le=[];for(var Pe in K)Ce.push(K[Pe].value);te=D(Ce.map(function(e){return e.duration}));for(var Be=0;Be<Ce.length;Be++){var Ie=Ce[Be],Xe=Ie.attributeName;Fe[Xe]=new Map;var De=0,je=Y[Xe]?Array.from(Y[Xe].values()).pop():re(Xe),qe=0;do{for(var Ue=0;Ue<Ie.keyTimes.length;Ue++)De=be(0,Ie.duration,Ie.keyTimes,qe,Ue),je=ke(Ie,Ue,je,qe),s($,De,Ie.keySplines,Ue),Fe[Xe].set(De,je),Le.push(De)}while(De<te&&++qe)}if(Ce.every(function(e){return e.alternate})){var ze=-1;for(var We in K)for(var Ye=Array.from(Fe[We].keys()),He=Array.from(Fe[We].values()).reverse(),Ke=0;Ke<Ye.length;Ke++){ze=te+Ye[Ke];var Ze=$.get(Ye[Ke]);Ze&&$.set(ze,Ze),Fe[We].set(ze,He[Ke]),Le.push(ze)}-1!==ze&&(te=ze)}for(var $e in Le=X(Array.from(new Set(Le))),Fe)for(var Qe=Fe[$e],Je=1;Je<Le.length;Je++){var et=Le[Je];Qe.has(et)||pe(Qe,Qe,et)}W=de(Fe,Le),n&&(W=ye(W,te))}if(z||W){var tt=function(e){e.has("x")?nt=e.get("x"):e.set("x",nt),e.has("y")?at=e.get("y"):e.set("y",at)};me.retainArray(r.animation,function(t){return!e.includes(t)});var rt=Array.from(new Set(e.map(function(e){return e.attributeName}))).sort().join("-"),nt=0,at=0;void 0===a&&(nt=re("x")||0,at=re("y")||0);var it=function(e,t){t||(e.repeatCount=-1),e.from=e.values[0],e.to=e.values[e.values.length-1],r.animation.push(e)};[z,W].forEach(function(e){if(e){var t=e===z,i=t?Z:$,s=t?void 0:J;if(n){var o,l=[],u=r.parent;if(a){var c=ge(e,a,u,s);if(!c)return;(o=new se).attributeName="d";for(var f=Array.isArray(p=c),m=0,p=f?p:p[Symbol.iterator]();;){var y;if(f){if(m>=p.length)break;y=p[m++]}else{if((m=p.next()).done)break;y=m.value}var g=y;o.keyTimes.push(g.ordinal),o.values.push(""+g.value);var d=i.get(g.ordinal);d?(l.push(d.values().next().value),i.delete(g.ordinal)):l.push("")}}else{(o=new oe).attributeName="transform",o.type=SVGTransform.SVG_TRANSFORM_TRANSLATE;var b=e.entries(),k=Array.isArray(b),A=0;for(b=k?b:b[Symbol.iterator]();;){var S;if(k){if(A>=b.length)break;S=b[A++]}else{if((A=b.next()).done)break;S=A.value}var x=v(S,2),T=x[0];tt(x[1]),o.keyTimes.push(T),o.values.push(u?"".concat(u.refitX(nt)," ").concat(u.refitX(at)):"".concat(nt," ").concat(at));var E=i.get(T);E?(l.push(E.values().next().value),i.delete(T)):l.push("")}}o.keySplines=l,o.duration=t?h:te,it(o,t)}else for(var V=Array.from(e.entries()),w=0,R=0;w<V.length-1;w++){var M=v(V[w],2),N=M[0],_=M[1],O=v(V[w+1],2),G=O[0],C=O[1],F=void 0,L=void 0;if(a){var P=new Map;P.set(N,_),P.set(G,C);var B=ge(P,a,r.parent,s);if(!B)continue;(F=new se).attributeName="d",F.values=B.map(function(e){return""+e.value}),L=rt}else(F=new oe).attributeName="transform",F.type=SVGTransform.SVG_TRANSFORM_TRANSLATE,F.values=[_,C].map(function(e){return tt(e),r.parent?"".concat(r.parent.refitX(nt)," ").concat(r.parent.refitX(at)):"".concat(nt," ").concat(at)}),L=rt+w;t&&(F.begin=[0===w?N:0]),F.duration=G-N,F.keyTimes=[0,1],F.sequential={ordinal:R++,value:L};var I=i.get(G);I&&(F.keySplines=[I.values().next().value],i.delete(G)),it(F,t)}}})}}()}}]),n}()},Ve=squared.lib.util,we=function(e){function t(e){var r;if(a(this,t),(r=c(this,l(t).call(this,e))).element=e,r.path="",r.mpath=null,r.rotate=0,r.rotateAuto=!1,r.rotateAutoReverse=!1,r.keyPoints=[],e){r.setAttribute("path");var n=r.getAttribute("rotate");switch(n){case"auto":r.rotateAuto=!0;break;case"auto-reverse":r.rotateAutoReverse=!0;break;default:r.rotate=Ve.convertInt(n)}if(r.keyTimes.length){var i=r.getAttribute("keyPoints");if(i){var s=se.toFractionList(i);s.length===r.keyTimes.length&&(r.keyPoints=s)}}for(var o=0;o<e.children.length;o++){var u=e.children[o];if("mpath"===u.tagName){var f=C(u);if(f&&(N.shape(f)||N.use(f))){r.mpath=f;break}}}}return r}return o(t,se),s(t,[{key:"instanceType",get:function(){return 3}}]),t}(),Re=squared.lib.dom,Me=squared.lib.util,Ne=Re.getKeyframeRules(),_e={"animation-delay":["0s"],"animation-duration":["0s"],"animation-iteration-count":["1"],"animation-play-state":["running"],"animation-direction":["normal"],"animation-fill-mode":["none"],"animation-timing-function":["ease"]},Oe=RegExp("cubic-bezier\\(".concat(E.ZERO_ONE,", ").concat(E.DECIMAL,", ").concat(E.ZERO_ONE,", ").concat(E.DECIMAL,"\\)"));function Ge(e,t){return Me.flatMap(Re.cssAttribute(e,t).split(/(?<!\w+\([\-\d., ]+),/),function(e){return e.trim()})}function Ce(e){return e.sort(function(e,t){return e.ordinal>=t.ordinal?1:-1})}var Fe=function(e){return function(t){function r(){var e;return a(this,r),(e=c(this,l(r).apply(this,arguments))).transformed=null,e}return o(r,e),s(r,[{key:"getAnimations",value:function(e){var t=this,r=[],n=Ge(e,"animation-name");if(n.length){var a={};for(var i in _e){var s=Ge(e,i);for(0===s.length&&s.push.apply(s,m(_e[i].slice(0)));s.length<n.length;)s.push.apply(s,m(s.slice(0)));s.length=n.length,a[i]=s}n.forEach(function(t,n){var i=Ne.get(t);if(i){var s={},o={};for(var l in i){var u=parseInt(l)/100;for(var c in i[l]){var f=_e[c]?o:s;void 0===f[c]&&(f[c]=[]),f[c].push({ordinal:u,value:i[l][c]})}}if(s.transform){Ce(s.transform).forEach(function(t){var r=L(e,t.value);if(r){var n=function(t){if(s["transform-origin"]){var r=s["transform-origin"].find(function(e){return e.ordinal===t});if(r)return B(e,r.value)}return B(e)}(t.ordinal);r.forEach(function(e){var r,a;switch(e.type){case SVGTransform.SVG_TRANSFORM_TRANSLATE:r="translate",a="".concat(e.matrix.e," ").concat(e.matrix.f);break;case SVGTransform.SVG_TRANSFORM_SCALE:r="scale",a="".concat(e.matrix.a," ").concat(e.matrix.d);break;case SVGTransform.SVG_TRANSFORM_ROTATE:r="rotate",a="".concat(e.angle," ").concat(n.x," ").concat(n.y);break;case SVGTransform.SVG_TRANSFORM_SKEWX:r="skewX",a=""+e.angle;break;case SVGTransform.SVG_TRANSFORM_SKEWY:r="skewY",a=""+e.angle;break;default:return}void 0===s[r]&&(s[r]=[]);var i=s[r].findIndex(function(e){return e.ordinal===t.ordinal});-1!==i?s[r][i].value=a:s[r].push({ordinal:t.ordinal,value:a})})}})}delete s.transform,delete s["transform-origin"];var h=function(t){var i=s[t];Ce(i);var l=void 0;switch(t){case"rotate":case"scale":case"skewX":case"skewY":case"translate":var u=new oe;u.attributeName="transform",u.setType(t),l=u,0!==i[0].ordinal&&i.unshift({ordinal:0,value:I(t)});break;default:(l=new se).attributeName=t,0!==i[0].ordinal&&i.unshift({ordinal:0,value:Re.cssAttribute(e,t)})}l.paused="paused"===a["animation-play-state"][n];for(var c=a["animation-iteration-count"][n],f=a["animation-timing-function"][n],h=a["animation-direction"][n],v=a["animation-fill-mode"][n],p=M(a["animation-delay"][n]),y=M(a["animation-duration"][n]),g=[],d=[],b=[],k=function(e){if(g.push(i[e].ordinal),d.push(i[e].value),e<i.length-1){var t=o["animation-timing-function"]?o["animation-timing-function"].find(function(t){return t.ordinal===i[e].ordinal}):void 0;b.push(t?t.value:f)}},A=0;A<i.length;A++)k(A);b.every(function(e){return"linear"===e})?(l.keyTimes=g,l.values=d):function(){for(var r=[],n=[],a=[],i=0;i<b.length;i++){if(J[b[i]])b[i]=J[b[i]];else if(b[i].startsWith("steps")){var s=se.toStepFractionList(t,b[i],i,g,d,w(),R(e));if(s){r.push.apply(r,m(s[0])),n.push.apply(n,m(s[1])),s[0].forEach(function(){return a.push(J.step)});continue}b[i]=J.linear}else{var o=Oe.exec(b[i]);b[i]=o?"".concat(o[1]," ").concat(o[2]," ").concat(o[3]," ").concat(o[4]):J.ease}r.push(g[i]),n.push(d[i]),a.push(b[i])}r.push(g.pop()),n.push(d.pop()),l.keyTimes=r,l.values=n,l.keySplines=a}(),l.begin[0]=p,l.duration=y,l.repeatCount="infinite"!==c?parseFloat(c):-1,"forwards"!==v&&"both"!==v||(l.fillMode|=4),"backwards"!==v&&"both"!==v||(l.fillMode|=2),l.reverse=h.endsWith("reverse"),l.alternate=(-1===l.repeatCount||l.repeatCount>1)&&h.startsWith("alternate"),r.push(l)};for(var v in s)h(v)}})}for(var o=0;o<e.children.length;o++){var l=e.children[o];switch(l.tagName){case"set":r.push(new Q(l));break;case"animate":r.push(new se(l));break;case"animateTransform":r.push(new oe(l));break;case"animateMotion":r.push(new we(l))}}return r.forEach(function(e){return e.parent=t}),r}},{key:"name",get:function(){return void 0===this._name&&(this._name=H.setName(this.element)),this._name}},{key:"transform",get:function(){return void 0===this._transform&&(this._transform=L(this.element)||H.convertTransformList(this.element.transform.baseVal)),this._transform}},{key:"animation",get:function(){return void 0===this._animation&&(this._animation=this.getAnimations(this.element)),this._animation}},{key:"visible",set:function(e){O(this.element,e)},get:function(){return _(this.element)}},{key:"opacity",set:function(e){G(this.element,e)},get:function(){return Re.cssAttribute(this.element,"opacity")||"1"}}]),r}()},Le=squared.lib.dom,Pe=function(e){return function(t){function r(){return a(this,r),c(this,l(r).apply(this,arguments))}return o(r,e),s(r,[{key:"setRect",value:function(){var e=this.x,t=this.y,r=this.width,n=this.height;this.parent&&(e=this.parent.refitX(e),t=this.parent.refitY(t),r=this.parent.refitSize(r),n=this.parent.refitSize(n)),this.setBaseValue("x",e),this.setBaseValue("y",t),this.setBaseValue("width",r),this.setBaseValue("height",n)}},{key:"getElement",value:function(){switch(this.element.tagName){case"svg":case"use":case"image":return this.element;default:return null}}},{key:"x",set:function(e){var t=this.getElement();t&&(t.x.baseVal.value=e)},get:function(){var e=this.getElement();return e?e.x.baseVal.value:0}},{key:"y",set:function(e){var t=this.getElement();t&&(t.y.baseVal.value=e)},get:function(){var e=this.getElement();return e?e.y.baseVal.value:0}},{key:"width",set:function(e){var t=this.getElement();t&&("svg"===t.tagName&&Le.isUserAgent(16)&&t.parentElement instanceof HTMLElement?this._width=e:t.width.baseVal.value=e)},get:function(){var e=this.getElement();return e?"svg"===e.tagName&&Le.isUserAgent(16)&&e.parentElement instanceof HTMLElement?void 0!==this._width?this._width:e.getBoundingClientRect().width:e.width.baseVal.value:0}},{key:"height",set:function(e){var t=this.getElement();t&&("svg"===t.tagName&&Le.isUserAgent(16)&&t.parentElement instanceof HTMLElement?this._height=e:t.height.baseVal.value=e)},get:function(){var e=this.getElement();return e?"svg"===e.tagName&&Le.isUserAgent(16)&&e.parentElement instanceof HTMLElement?void 0!==this._height?this._height:e.getBoundingClientRect().height:e.height.baseVal.value:0}}]),r}()},Be=function(e){function t(e){var r;return a(this,t),(r=c(this,l(t).call(this))).element=e,r.aspectRatio={x:0,y:0,unit:1},r}return o(t,squared.lib.base.Container),s(t,[{key:"append",value:function(e){return e.parent=this,h(l(t.prototype),"append",this).call(this,e)}},{key:"build",value:function(e,t){this.clear();for(var r=0;r<this.element.children.length;r++){var n=this.element.children[r],a=void 0;if(N.svg(n))a=new squared.svg.Svg(n,!1),this.setAspectRatio(a,n);else if(N.g(n))a=new squared.svg.SvgG(n),this.setAspectRatio(a);else if(N.use(n)){var i=C(n,n.parentElement);i&&(N.symbol(i)?(a=new squared.svg.SvgUseSymbol(n,i),this.setAspectRatio(a,i)):N.image(i)?a=new squared.svg.SvgImage(n,i):N.shape(i)&&(a=new squared.svg.SvgUse(n,i)))}else N.image(n)?a=new squared.svg.SvgImage(n):N.shape(n)&&(a=new squared.svg.SvgShape(n));a&&(this.append(a),a.build(e,t))}}},{key:"synchronize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.each(function(t){return t.synchronize(e)})}},{key:"refitX",value:function(e){return e*this.aspectRatio.unit+this.aspectRatio.x}},{key:"refitY",value:function(e){return e*this.aspectRatio.unit+this.aspectRatio.y}},{key:"refitSize",value:function(e){return e*this.aspectRatio.unit}},{key:"refitPoints",value:function(e){for(var t=this.aspectRatio,r=Array.isArray(a=e),n=0,a=r?a:a[Symbol.iterator]();;){var i;if(r){if(n>=a.length)break;i=a[n++]}else{if((n=a.next()).done)break;i=n.value}var s=i;s.x=s.x*t.unit+t.x,s.y=s.y*t.unit+t.y,void 0!==s.rx&&void 0!==s.ry&&(s.rx*=t.unit,s.ry*=t.unit)}return e}},{key:"setAspectRatio",value:function(e,t){var r=H.getContainerViewBox(this);if(r){var n=e.aspectRatio;if(t){var a=t.viewBox.baseVal;if(a&&a.width>0&&a.height>0){var i=a.width/a.height,s=r.viewBox,o=s.width/s.height;o>i?n.x=(s.width-s.height*a.width/a.height)/2:o<i&&(n.y=(s.height-s.width*a.height/a.width)/2),n.unit=Math.min(s.width/a.width,s.height/a.height)}}n.x*=r.aspectRatio.unit,n.x+=r.aspectRatio.x,n.y*=r.aspectRatio.unit,n.y+=r.aspectRatio.y,n.unit*=r.aspectRatio.unit}}}]),t}(),Ie=squared.lib.color,Xe=squared.lib.dom;function De(e){var t=[];return Array.from(e.getElementsByTagName("stop")).forEach(function(e){var r=Ie.parseRGBA(Xe.cssAttribute(e,"stop-color"),Xe.cssAttribute(e,"stop-opacity"));r&&t.push({color:r.valueRGBA,offset:Xe.cssAttribute(e,"offset"),opacity:r.alpha})}),t}function je(e){for(var t={},r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];for(var i=0;i<n.length;i++){var s=n[i];e[s]&&(t[s]=e[s].baseVal.value,t["".concat(s,"AsString")]=e[s].baseVal.valueAsString)}return t}var qe=function(e){function t(e){var r,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return a(this,t),(r=c(this,l(t).call(this,e))).element=e,r.documentRoot=n,r.patterns={clipPath:new Map,gradient:new Map},r.init(),r}return o(t,Ee(Pe(Z(Fe(Be))))),s(t,[{key:"build",value:function(e,r){this.setRect(),h(l(t.prototype),"build",this).call(this,e,r)}},{key:"synchronize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!this.documentRoot&&this.animation.length&&this.mergeAnimate(this.getAnimateViewRect(),e),h(l(t.prototype),"synchronize",this).call(this,e)}},{key:"init",value:function(){var e=this;[this.element].concat(m(Array.from(this.element.querySelectorAll("defs")))).forEach(function(t){t.querySelectorAll(":scope > set, :scope > animate, :scope > animateTransform, :scope > animateMotion").forEach(function(t){var r=C(t,e.element);r&&(t.parentElement&&t.parentElement.removeChild(t),r.appendChild(t))}),t.querySelectorAll("clipPath, linearGradient, radialGradient").forEach(function(t){if(t.id){var r="#".concat(t.id);N.clipPath(t)?e.patterns.clipPath.set(r,t):N.linearGradient(t)?e.patterns.gradient.set(r,Object.assign({element:t,type:"linear",colorStop:De(t)},je(t,"x1","x2","y1","y2"))):N.radialGradient(t)&&e.patterns.gradient.set(r,Object.assign({element:t,type:"radial",colorStop:De(t)},je(t,"cx","cy","r","fx","fy")))}})})}},{key:"viewBox",get:function(){return this.element.viewBox.baseVal}}]),t}(),Ue=function(e){function t(e){var r;return a(this,t),(r=c(this,l(t).call(this,e))).element=e,r.setPaint(),r}return o(t,fe(Fe(Be))),t}(),ze=squared.lib.util,We=function(e){function t(e,r){var n;return a(this,t),(n=c(this,l(t).call(this,e))).element=e,n.imageElement=null,r&&(n.imageElement=r),n}return o(t,Pe(Z(Fe(he)))),s(t,[{key:"build",value:function(){this.setRect()}},{key:"extract",value:function(e){var t=H.filterTransforms(this.transform,e),r=this.x,n=this.y,a=this.width,i=this.height;if(t.length){t.reverse();for(var s=0;s<t.length;s++){var o=t[s],l=o.matrix,u=r;switch(r=j(l,u,n),n=q(l,u,n),o.type){case SVGTransform.SVG_TRANSFORM_SCALE:a*=l.a,i*=l.d;break;case SVGTransform.SVG_TRANSFORM_ROTATE:0!==o.angle&&(l.a<0&&(r+=l.a*a),l.c<0&&(r+=l.c*a),l.b<0&&(n+=l.b*i),l.d<0&&(n+=l.d*i),this.rotateOrigin?this.rotateOrigin.angle=(this.rotateOrigin.angle||0)+o.angle:this.rotateOrigin={angle:o.angle,x:0,y:0})}}this.transformed=t}this.parent&&(r=this.parent.refitX(r),n=this.parent.refitY(n),a=this.parent.refitSize(a),i=this.parent.refitSize(i)),this.translationOffset&&(r+=this.translationOffset.x,n+=this.translationOffset.y),this.setBaseValue("x",r),this.setBaseValue("y",n),this.setBaseValue("width",a),this.setBaseValue("height",i)}},{key:"x",get:function(){var e=h(l(t.prototype),"x",this);return 0===e&&this.imageElement?this.imageElement.x.baseVal.value:e}},{key:"y",get:function(){var e=h(l(t.prototype),"y",this);return 0===e&&this.imageElement?this.imageElement.y.baseVal.value:e}},{key:"width",get:function(){var e=h(l(t.prototype),"width",this);return 0===e&&this.imageElement?this.imageElement.width.baseVal.value:e}},{key:"height",get:function(){var e=h(l(t.prototype),"height",this);return 0===e&&this.imageElement?this.imageElement.height.baseVal.value:e}},{key:"href",set:function(e){var t=this.imageElement||this.element;N.image(t)&&(t.href.baseVal=e)},get:function(){var e=this.imageElement||this.element;return N.image(e)?ze.resolvePath(e.href.baseVal):""}}]),t}(),Ye=function(e){function t(e){var r;return a(this,t),(r=c(this,l(t).call(this,e))).element=e,r.setType(),r}return o(t,Ee(Fe(he))),s(t,[{key:"setType",value:function(e){this.type=x[(e||this.element).tagName]||0}},{key:"build",value:function(e,t){var r;void 0===this._path?(r=new ve(this.element),this.path=r):r=this._path;var n=this.transform.slice(0);this.element!==r.element&&n.push.apply(n,m(r.transform)),r.draw(H.filterTransforms(n,e?e[r.element.tagName]:void 0),t)}},{key:"synchronize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.path&&this.animation.length&&this.mergeAnimate(this.getAnimateShape(),e,this.path)}},{key:"path",set:function(e){this._path=e,e&&(e.parent=this.parent,e.name=this.name)},get:function(){return this._path}}]),t}(),He=function(e){function t(e,r){var n;return a(this,t),(n=c(this,l(t).call(this,e))).element=e,n.shapeElement=r,n.setPaint(),n.setShape(r),n}return o(t,fe(Pe(Z(Ye)))),s(t,[{key:"setShape",value:function(e){this.shapeElement=e,this.setType(e),this.path=void 0}},{key:"build",value:function(e,r){void 0===this.path&&(this.path=new ve(this.shapeElement,this.element)),h(l(t.prototype),"build",this).call(this,e,r)}},{key:"synchronize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.animation.length&&this.mergeAnimate(this.getAnimateViewRect(),e),h(l(t.prototype),"synchronize",this).call(this,e)}},{key:"href",set:function(e){if("#"===e.charAt(0)){var t=document.getElementById(e.substring(1));t&&N.shape(t)&&(this.setShape(t),this.element.href.baseVal=e)}},get:function(){return this.element.href.baseVal}}]),t}(),Ke=function(e){function t(e,r){var n;return a(this,t),(n=c(this,l(t).call(this,e))).element=e,n.symbolElement=r,n.setPaint(),n}return o(t,fe(Ee(Pe(Z(Fe(Be)))))),s(t,[{key:"build",value:function(e,r){this.setRect();var n=this.element;this.element=this.symbolElement,h(l(t.prototype),"build",this).call(this,e,r),this.each(function(e){e.path&&(e.path.parentElement=n,e.path.setPaint())}),this.element=n;var a=this.getBaseValue("x"),i=this.getBaseValue("y");if(0!==a||0!==i){var s={x:a,y:i};this.cascade().forEach(function(e){return e.translationOffset=s})}}},{key:"synchronize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.animation.length&&this.mergeAnimate(this.getAnimateViewRect(),e),h(l(t.prototype),"synchronize",this).call(this,e)}},{key:"viewBox",get:function(){return this.symbolElement.viewBox.baseVal}}]),t}(),Ze={constant:ee,util:z};e.Svg=qe,e.SvgAnimate=se,e.SvgAnimateMotion=we,e.SvgAnimateTransform=oe,e.SvgAnimation=Q,e.SvgBaseVal=Z,e.SvgBuild=H,e.SvgContainer=Be,e.SvgElement=he,e.SvgG=Ue,e.SvgImage=We,e.SvgPaint=fe,e.SvgPath=ve,e.SvgShape=Ye,e.SvgSynchronize=Ee,e.SvgUse=He,e.SvgUseSymbol=Ke,e.SvgView=Fe,e.SvgViewRect=Pe,e.lib=Ze,Object.defineProperty(e,"__esModule",{value:!0})});
