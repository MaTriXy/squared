!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(((e=e||self).squared=e.squared||{},e.squared.svg={}))}(this,function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){this.wrapped=e}function n(e){var t,n;function r(t,n){try{var o=e[t](n),l=o.value,i=l instanceof a;Promise.resolve(i?l.wrapped:l).then(function(e){i?r("next",e):s(o.done?"return":"normal",e)},function(e){r("throw",e)})}catch(e){s("throw",e)}}function s(e,a){switch(e){case"return":t.resolve({value:a,done:!0});break;case"throw":t.reject(a);break;default:t.resolve({value:a,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,a){return new Promise(function(s,o){var l={key:e,arg:a,resolve:s,reject:o,next:null};n?n=n.next=l:(t=n=l,r(e,a))})},"function"!=typeof e.return&&(this.return=void 0)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,a){return t&&s(e.prototype,t),a&&s(e,a),e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}"function"==typeof Symbol&&Symbol.asyncIterator&&(n.prototype[Symbol.asyncIterator]=function(){return this}),n.prototype.next=function(e){return this._invoke("next",e)},n.prototype.throw=function(e){return this._invoke("throw",e)},n.prototype.return=function(e){return this._invoke("return",e)};function h(e,t){return v(e)||function(e,t){var a=[],n=!0,r=!1,s=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,s=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw s}}return a}(e,t)||y()}function f(e){return function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function v(e){if(Array.isArray(e))return e}function b(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function y(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var p=squared.lib.dom,g=squared.lib.util;function d(e){switch(e.tagName){case"path":case"circle":case"ellipse":case"line":case"rect":case"polygon":case"polyline":return!0}return!1}function k(e){return"image"===e.tagName}function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=p.cssAttribute(e,"transform-origin");if(""!==a){var n,r,s=e.parentElement;if(s instanceof SVGSVGElement)n=s.viewBox.baseVal.width,r=s.viewBox.baseVal.height;else{if(!(s instanceof SVGGElement&&s.viewportElement instanceof SVGSVGElement))return;n=s.viewportElement.viewBox.baseVal.width,r=s.viewportElement.viewBox.baseVal.height}var o=a.split(" ");1===o.length&&o.push("center"),o=o.slice(0,2);var l={x:null,y:null};if(o.includes("left")?l.x=0:o.includes("right")&&(l.x=n),o.includes("top")?l.y=0:o.includes("bottom")&&(l.y=r),["x","y"].forEach(function(a){if(null===l[a])for(var s=0;s<o.length;s++){var i=o[s];if(""!==i&&("center"===i&&(i="50%"),g.isUnit(i)?l[a]=parseInt(i.endsWith("px")?i:g.convertPX(i,t,g.convertInt(p.getStyle(e).fontSize))):g.isPercent(i)&&(l[a]=("x"===a?n:r)*(parseInt(i)/100)),null!==l[a])){o[s]="";break}}}),l.x||l.y)return l.x=l.x||0,l.y=l.y||0,l}}function V(e){var t=e.slice().sort(function(e,t){return e<t?-1:1});if(t.length>1){for(var a=t.splice(0,1)[0],n=a,r=!1;!r;)for(var s=Array.isArray(l=t),o=0,l=s?l:l[Symbol.iterator]();;){var i;if(s){if(o>=l.length)break;i=l[o++]}else{if((o=l.next()).done)break;i=o.value}if(!(n>=i&&n%i==0)){r=!1,n+=a;break}r=!0}return n}return t[0]}function x(e,t,a){return e.a*t+e.c*a+e.e}function S(e,t,a){return e.b*t+e.d*a+e.f}function w(e,t){return t*Math.cos(e*Math.PI/180)*-1}function R(e){var t=p.cssAttribute(e,"visibility",!0);return"hidden"!==t&&"collapse"!==t&&"none"!==p.cssAttribute(e,"display",!0)}var m=Object.freeze({isSvgShape:d,isSvgImage:k,createTransformData:function(e){for(var t={operations:[],translateX:0,translateY:0,scaleX:1,scaleY:1,rotateAngle:0,skewX:0,skewY:0,origin:A(e)},a=0;a<e.transform.baseVal.numberOfItems;a++){var n=e.transform.baseVal.getItem(a);if(!t.operations.includes(n.type))switch(n.type){case SVGTransform.SVG_TRANSFORM_TRANSLATE:0===n.matrix.e&&0===n.matrix.f||(t.translateX=n.matrix.e,t.translateY=n.matrix.f,t.operations.push(n.type));break;case SVGTransform.SVG_TRANSFORM_SCALE:1===n.matrix.a&&1===n.matrix.d||(t.scaleX=n.matrix.a,t.scaleY=n.matrix.d,t.operations.push(n.type));break;case SVGTransform.SVG_TRANSFORM_ROTATE:if(0!==n.angle){t.rotateAngle=n.angle;var r=e.attributes.getNamedItem("transform");if(r&&r.nodeValue){var s=/rotate\((\d+), (\d+), (\d+)\)/.exec(r.nodeValue);s&&(t.rotateOriginX=parseInt(s[2]),t.rotateOriginY=parseInt(s[3]))}t.matrixRotate=n.matrix,t.operations.push(n.type)}break;case SVGTransform.SVG_TRANSFORM_SKEWX:0!==n.angle&&(t.skewX+=n.angle,t.matrixSkewX=n.matrix,t.operations.push(n.type));break;case SVGTransform.SVG_TRANSFORM_SKEWY:0!==n.angle&&(t.skewY+=n.angle,t.matrixSkewY=n.matrix,t.operations.push(n.type))}}return t},getTransformOrigin:A,getLeastCommonMultiple:V,applyMatrixX:x,applyMatrixY:S,getRadiusX:function(e,t){return t*Math.sin(e*Math.PI/180)},getRadiusY:w,isVisible:R}),E=squared.lib.color,G=squared.lib.dom,O={},C=function(){function e(){r(this,e)}return o(e,null,[{key:"setName",value:function(e){var t,a="";return e.id?(void 0===O[e.id]&&(a=e.id),t=e.id):t=e.tagName,void 0===O[t]&&(O[t]=0),""!==a?a:"".concat(t,"_").concat(++O[t])}},{key:"applyTransforms",value:function(e,t,a){for(var n=[],r=Array.isArray(o=t),s=0,o=r?o:o[Symbol.iterator]();;){var l;if(r){if(s>=o.length)break;l=o[s++]}else{if((s=o.next()).done)break;l=s.value}n.push({x:l.x,y:l.y})}for(var i=e.numberOfItems-1;i>=0;i--){var u=e.getItem(i),c=0,h=0,f=0,v=0,b=0,y=0;if(a)switch(u.type){case SVGTransform.SVG_TRANSFORM_SCALE:c+=a.x,v+=a.y;break;case SVGTransform.SVG_TRANSFORM_SKEWX:h-=a.y;break;case SVGTransform.SVG_TRANSFORM_SKEWY:f-=a.x;break;case SVGTransform.SVG_TRANSFORM_ROTATE:f-=a.x,h-=a.y,b=a.x+w(u.angle,a.x),y=a.y+w(u.angle,a.y)}for(var p=0;p<n.length;p++){var g=n[p],d=g.x,k=g.y;g.x=x(u.matrix,d+c,k+h)+b,g.y=S(u.matrix,d+f,k+v)+y}}return n}},{key:"toPointList",value:function(e){for(var t=[],a=0;a<e.numberOfItems;a++){var n=e.getItem(a);t.push({x:n.x,y:n.y})}return t}},{key:"toCoordinateList",value:function(e){for(var t,a=[],n=/-?[\d.]+/g;null!==(t=n.exec(e));){var r=parseFloat(t[0]);isNaN(r)||a.push(r)}return a}},{key:"toPathCommandList",value:function(e){var t,a=[],n=/([A-Za-z])([^A-Za-z]+)?/g;for(e=e.trim();null!==(t=n.exec(e))&&(0!==a.length||"M"===t[1].toUpperCase());){t[2]=(t[2]||"").trim();var r=this.toCoordinateList(t[2]),s=a[a.length-1],o=s?s.command.toUpperCase():"",l=s?s.points[s.points.length-1]:void 0,i=void 0,u=void 0,c=void 0,v=void 0,b=void 0;switch(t[1].toUpperCase()){case"M":case"L":if(r.length>=2){r.length=2;break}continue;case"H":if(l&&r.length){r[1]="h"===t[1]?0:l.y,r.length=2;break}continue;case"V":if(l&&r.length){var y=r[0];r[0]="v"===t[1]?0:l.x,r[1]=y,r.length=2;break}continue;case"Z":if(a.length){r.push.apply(r,f(a[0].coordinates)),t[1]="Z";break}continue;case"C":if(r.length>=6){r.length=6;break}continue;case"S":if(r.length>=4&&("C"===o||"S"===o)){r.length=4;break}continue;case"Q":if(r.length>=4){r.length=4;break}continue;case"T":if(r.length>=2&&("Q"===o||"T"===o)){r.length=2;break}continue;case"A":if(r.length>=7){var p=h(r.splice(0,5),5);i=p[0],u=p[1],c=p[2],v=p[3],b=p[4],r.length=2;break}continue;default:continue}if(r.length>1){for(var g=[],d=/[a-z]/.test(t[1]),k=0;k<r.length;k+=2){var A=r[k],V=r[k+1];d&&l&&(A+=l.x,V+=l.y),g.push({x:A,y:V})}a.push({command:t[1],relative:d,coordinates:r,points:g,radiusX:i,radiusY:u,xAxisRotation:c,largeArcFlag:v,sweepFlag:b})}}return a}},{key:"createColorStops",value:function(e){for(var t=[],a=Array.from(e.getElementsByTagName("stop")),n=0;n<a.length;n++){var r=a[n],s=E.parseRGBA(G.cssAttribute(r,"stop-color"),G.cssAttribute(r,"stop-opacity"));s&&s.visible&&t.push({color:s.valueRGBA,offset:G.cssAttribute(r,"offset"),opacity:s.alpha})}return t}},{key:"fromCoordinateList",value:function(e){for(var t=[],a=0;a<e.length;a+=2)t.push({x:e[a],y:e[a+1]});return t.length%2==0?t:[]}},{key:"fromPathCommandList",value:function(e){for(var t="",a=Array.isArray(r=e),n=0,r=a?r:r[Symbol.iterator]();;){var s;if(a){if(n>=r.length)break;s=r[n++]}else{if((n=r.next()).done)break;s=n.value}var o=s;switch(t+=(""!==t?" ":"")+o.command,o.command.toUpperCase()){case"M":case"L":case"C":case"S":case"Q":case"T":t+=o.coordinates.join(",");break;case"H":t+=o.coordinates[0];break;case"V":t+=o.coordinates[1];break;case"A":t+="".concat(o.radiusX,",").concat(o.radiusY,",").concat(o.xAxisRotation,",").concat(o.largeArcFlag,",").concat(o.sweepFlag,",").concat(o.coordinates.join(","))}}return t}}]),e}(),N=squared.lib.util,L=function(){function e(t,a){r(this,e),this.element=t,this.parentElement=a,this.attributeName="",this.to="",this.begin=[0],this.setAttribute("attributeName"),this.setAttribute("to");var n=this.getAttribute("begin"),s=this.getAttribute("dur");"indefinite"===n?this.begin.length=0:""!==n&&(this.begin=n.split(";").map(function(t){return e.convertClockTime(t)}).sort(function(e,t){return e<t?-1:1})),this.duration=""===s||"indefinite"===s?-1:e.convertClockTime(s)}return o(e,[{key:"setAttribute",value:function(e,t){var a=this.getAttribute(e);a&&(void 0!==t?this[e+N.capitalize(t)]=a===t:this[e]=a)}},{key:"getAttribute",value:function(e){var t=this.element.attributes.getNamedItem(e);return t?t.value.trim():""}}],[{key:"convertClockTime",value:function(e){var t=0,a=0;if(/\d+ms$/.test(e))a=parseInt(e);else if(/\d+s$/.test(e))t=parseInt(e);else if(/\d+min$/.test(e))t=60*parseInt(e);else if(/\d+(.\d+)?h$/.test(e))t=60*parseFloat(e)*60;else{var n=/^(?:(\d?\d):)?(?:(\d?\d):)?(\d?\d)\.?(\d?\d?\d)?$/.exec(e);n&&(n[1]&&(t+=60*parseInt(n[1])*60),n[2]&&(t+=60*parseInt(n[2])),n[3]&&(t+=parseInt(n[3])),n[4]&&(a=parseInt(n[4])*(n[4].length<3?Math.pow(10,3-n[4].length):1)))}return 1e3*t+a}}]),e}(),I=squared.lib.util,P=function(e){function t(e,a){var n;r(this,t),(n=c(this,i(t).call(this,e,a))).element=e,n.parentElement=a,n.from="",n.by="",n.values=[],n.keyTimes=[],n.end=[],n.calcMode="",n.additiveSum=!1,n.accumulateSum=!1,n.fillFreeze=!1;var s,o=n.getAttribute("values");if(""!==o)if((s=n.values).push.apply(s,f(I.flatMap(o.split(";"),function(e){return e.trim()}))),n.values.length>1){n.from=n.values[0],n.to=n.values[n.values.length-1];var l=n.getAttribute("keyTimes");if(l){var u,h=t.toFractionList(l);if(h.length===n.values.length)(u=n.keyTimes).push.apply(u,f(h))}}else n.values.length=0;if(0===n.values.length&&""!==n.to){if(n.setAttribute("from"),""===n.from){var v=I.optional(a,"".concat(n.attributeName,".baseVal.value"));if(v)n.from=v;else{var b=a.attributes.getNamedItem(n.attributeName);b&&(n.from=b.value.trim())}}n.values.push(n.from,n.to),n.keyTimes.push(0,1),n.setAttribute("by")}var y=n.getAttribute("end"),p=n.getAttribute("repeatDur"),g=n.getAttribute("repeatCount");return""!==y&&(n.end=y.split(";").map(function(e){return L.convertClockTime(e)}).sort(function(e,t){return e<t?-1:1})),n.repeatDuration=""===p||"indefinite"===p?-1:t.convertClockTime(p),n._repeatCount="indefinite"===g?-1:Math.max(1,I.convertInt(g)),n.setAttribute("calcMode"),n.setAttribute("additive","sum"),n.setAttribute("accumulate","sum"),n.setAttribute("fill","freeze"),n}return l(t,L),o(t,[{key:"repeatCount",set:function(e){this._repeatCount=-1!==e?Math.max(1,e):-1,this.repeatDuration=-1},get:function(){var e=this.duration;return-1!==e?-1===this._repeatCount&&-1===this.repeatDuration?-1:-1!==this._repeatCount&&-1!==this.repeatDuration?this._repeatCount*e<=this.repeatDuration?this._repeatCount:this.repeatDuration/e:-1!==this.repeatDuration?this.repeatDuration/e:this._repeatCount:1}}],[{key:"toFractionList",value:function(e){var t=-1,a=I.flatMap(e.split(arguments.length>1&&void 0!==arguments[1]?arguments[1]:";"),function(e){var a=parseFloat(e);return!isNaN(a)&&a<=1&&(-1===t||a>t)?(t=a,a):-1});return a.length>1&&a.some(function(e){return-1!==e})&&0===a[0]?a:[]}}]),t}(),F=squared.lib.util,M=function(e){function t(e,a){var n;r(this,t),(n=c(this,i(t).call(this,e,a))).path="",n.keyPoints=[],n.rotate=0,n.rotateAuto=!1,n.rotateAutoReverse=!1,n.setAttribute("path");var s=n.getAttribute("rotate");switch(s){case"auto":n.rotateAuto=!0;break;case"auto-reverse":n.rotateAutoReverse=!0;break;default:n.rotate=F.convertInt(s)}if(n.keyTimes.length){var o=n.getAttribute("keyPoints");if(o){var l=P.toFractionList(o);l.length===n.keyTimes.length&&(n.keyPoints=l)}}return n}return l(t,P),t}(),X=function(e){function t(e,a){var n;switch(r(this,t),(n=c(this,i(t).call(this,e,a))).getAttribute("type")){case"translate":n.type=SVGTransform.SVG_TRANSFORM_TRANSLATE;break;case"scale":n.type=SVGTransform.SVG_TRANSFORM_SCALE;break;case"rotate":n.type=SVGTransform.SVG_TRANSFORM_ROTATE;break;case"skewX":n.type=SVGTransform.SVG_TRANSFORM_SKEWX;break;case"skewY":n.type=SVGTransform.SVG_TRANSFORM_SKEWY;break;default:n.type=0}return n}return l(t,P),o(t,null,[{key:"toRotateList",value:function(e){var t=e.map(function(e){if(""===e)return[null,null,null];var t=C.toCoordinateList(e);return 1===t.length||3===t.length?t:[]});return t.some(function(e){return 0===e.length})?void 0:t}},{key:"toScaleList",value:function(e){var t=e.map(function(e){if(""===e)return[null,null];var t=C.toCoordinateList(e);return 1===t.length?[t[0],t[0]]:2===t.length?t:[]});return t.some(function(e){return 0===e.length})?void 0:t}},{key:"toTranslateList",value:function(e){var t=e.map(function(e){if(""===e)return[null,null];var t=C.toCoordinateList(e);return 1===t.length||2===t.length?t:[]});return t.some(function(e){return 0===e.length})?void 0:t}}]),t}(),B=squared.lib.color,q=squared.lib.dom,Y=squared.lib.util,D=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";r(this,e),this.element=t,this.d=a,this.transformed=!1,this.opacity=1,this.color="",this.fillRule="",this.fill="",this.fillOpacity="",this.stroke="",this.strokeWidth="",this.strokeOpacity="",this.strokeLinecap="",this.strokeLinejoin="",this.strokeMiterlimit="",this.clipPath="",this.clipRule="",this.baseVal={cx:null,cy:null,r:null,rx:null,ry:null,x1:null,x2:null,y1:null,y2:null,x:null,y:null,width:null,height:null,points:null},this.init()}return o(e,[{key:"setColor",value:function(e){var t=q.cssAttribute(this.element,e),a=Y.REGEX_PATTERN.CSS_URL.exec(t);if(a)t="@".concat(a[1]);else if(""!==t)switch(t.toLowerCase()){case"none":case"transparent":case"rgba(0, 0, 0, 0)":t="";break;case"currentcolor":var n=B.parseRGBA(q.cssAttribute(this.element,"color",!0));t=n?n.valueRGB:"#000000";break;default:var r=B.parseRGBA(t);r&&(t=r.valueRGB)}else"fill"!==e||this.element.parentElement instanceof SVGGElement||(t="#000000");this[e]=t}},{key:"setOpacity",value:function(e){var t=q.cssAttribute(this.element,"".concat(e,"-opacity"));this["".concat(e,"Opacity")]=t?""+parseFloat(t)*this.opacity:""+this.opacity}},{key:"init",value:function(){var t=this.element;if(""===this.d){var a=t.transform.baseVal;switch(t.tagName){case"path":this.d=q.cssAttribute(t,"d");break;case"circle":var n=t;this.baseVal.cx=n.cx.baseVal.value,this.baseVal.cy=n.cy.baseVal.value,this.baseVal.r=n.r.baseVal.value,this.d=e.getCircle(this.baseVal.cx,this.baseVal.cy,this.baseVal.r,!0);break;case"ellipse":var r=t;this.baseVal.cx=r.cx.baseVal.value,this.baseVal.cy=r.cy.baseVal.value,this.baseVal.rx=r.rx.baseVal.value,this.baseVal.ry=r.ry.baseVal.value,this.d=e.getEllipse(this.baseVal.cx,this.baseVal.cy,this.baseVal.rx,this.baseVal.ry,!0);break;case"line":var s=t;if(this.baseVal.x1=s.x1.baseVal.value,this.baseVal.y1=s.y1.baseVal.value,this.baseVal.x2=s.x2.baseVal.value,this.baseVal.y2=s.y2.baseVal.value,a.numberOfItems)this.d=e.getPolyline(C.applyTransforms(a,[{x:this.baseVal.x1,y:this.baseVal.y1},{x:this.baseVal.x2,y:this.baseVal.y2}],A(t))),this.transformed=!0;else this.d=e.getLine(this.baseVal.x1,this.baseVal.y1,this.baseVal.x2,this.baseVal.y2,!0);break;case"rect":var o=t;if(this.baseVal.x=o.x.baseVal.value,this.baseVal.y=o.y.baseVal.value,this.baseVal.width=o.width.baseVal.value,this.baseVal.height=o.height.baseVal.value,a.numberOfItems)this.d=e.getPolygon(C.applyTransforms(a,[{x:this.baseVal.x,y:this.baseVal.y},{x:this.baseVal.x+this.baseVal.width,y:this.baseVal.y},{x:this.baseVal.x+this.baseVal.width,y:this.baseVal.y+this.baseVal.height},{x:this.baseVal.x,y:this.baseVal.y+this.baseVal.height}],A(t))),this.transformed=!0;else this.d=e.getRect(this.baseVal.width,this.baseVal.height,this.baseVal.x,this.baseVal.y,!0);break;case"polyline":case"polygon":this.baseVal.points=C.toPointList(t.points),a.numberOfItems&&(this.baseVal.points=C.applyTransforms(a,this.baseVal.points,A(t)),this.transformed=!0),this.d="polygon"===t.tagName?e.getPolygon(this.baseVal.points):e.getPolyline(this.baseVal.points)}}var l=Y.REGEX_PATTERN.CSS_URL.exec(q.cssAttribute(t,"clip-path"));l&&(this.clipPath=l[1],this.clipRule=q.cssAttribute(t,"clip-rule",!0));var i=q.cssAttribute(t,"opacity");i&&(this.opacity=Math.min(parseFloat(i),1)),this.setColor("fill"),""!==this.fill&&(this.setOpacity("fill"),this.fillRule=q.cssAttribute(t,"fill-rule",!0)),this.setColor("stroke"),""!==this.stroke&&(this.setOpacity("stroke"),this.strokeWidth=q.cssAttribute(t,"stroke-width")||"1",this.strokeLinecap=q.cssAttribute(t,"stroke-linecap",!0),this.strokeLinejoin=q.cssAttribute(t,"stroke-linejoin",!0),this.strokeMiterlimit=q.cssAttribute(t,"stroke-miterlimit",!0))}}],[{key:"getLine",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return 0===e&&0===t&&0===a&&0===n&&(arguments.length>4&&void 0!==arguments[4]&&arguments[4])?"":"M".concat(e,",").concat(t," L").concat(a,",").concat(n)}},{key:"getRect",value:function(e,t){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return e>0&&t>0||!(arguments.length>4&&void 0!==arguments[4]&&arguments[4])?"M".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,",").concat(a," h").concat(e," v").concat(t," h").concat(-e," Z"):""}},{key:"getPolyline",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(e=e instanceof SVGPointList?C.toPointList(e):e).length||!t?"M".concat(e.map(function(e){return"".concat(e.x,",").concat(e.y)}).join(" ")):""}},{key:"getPolygon",value:function(e){var t=this.getPolyline(e);return""!==t?t+" Z":""}},{key:"getCircle",value:function(e,t,a){return a>0||!(arguments.length>3&&void 0!==arguments[3]&&arguments[3])?this.getEllipse(e,t,a,a):""}},{key:"getEllipse",value:function(e,t,a,n){return a>0&&n>0||!(arguments.length>4&&void 0!==arguments[4]&&arguments[4])?"M".concat(e-a,",").concat(t," a").concat(a,",").concat(n,",0,1,0,").concat(2*a,",0 a").concat(a,",").concat(n,",0,1,0,-").concat(2*a,",0"):""}}]),e}(),W=squared.lib.util;function U(e,t,a,n,r,s,o,l){for(var i=((o+=l?-1:1)-(a+n*t))/n,u=-1,c=-1,h=0;h<r.length;h++){if(-1!==u&&i<r[h]){c=h;break}i>r[h]&&(u=h)}if(-1!==u&&-1!==c){var f=z(i,r[u],r[c],parseFloat(s[u]),parseFloat(s[c]));return e.set(o,{begin:a,duration:n,value:f}),o}return-1}function z(e,t,a,n,r){return n+(e-t)/(a-t)*(r-n)}function H(e,t,a){var n,r,s=e.entries(),o=Array.isArray(s),l=0;for(s=o?s:s[Symbol.iterator]();;){var i;if(o){if(l>=s.length)break;i=s[l++]}else{if((l=s.next()).done)break;i=l.value}var u=h(i,2),c=u[0],f=u[1];if(n&&a<c){r={time:c,value:f.value};break}a>c&&(n={time:c,value:f.value})}return!(!n||!r)&&(t.set(a,{value:z(a,n.time,r.time,n.value,r.value)}),!0)}function Z(e,t){var a=new Map,n=e.entries(),r=Array.isArray(n),s=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(s>=n.length)break;o=n[s++]}else{if((s=n.next()).done)break;o=s.value}var l=h(o,2),i=l[1],u=l[0]/t;if(u>0)for(var c=5;;c++){var f=parseFloat((""+u).substring(0,c));if(!a.has(f)){u=f;break}}a.set(u,i)}return a}function j(e,a,n,r,s,o){var l=[],i=function(){if(c){if(f>=u.length)return"break";v=u[f++]}else{if((f=u.next()).done)return"break";v=f.value}var t,a=h(v,2),i=a[0],b=a[1],y=[];if(r.forEach(function(t){b.has(t)?y.push(b.get(t)):s&&s[t]?y.push(s[t].value):null!==e.baseVal[t]&&y.push(e.baseVal[t])}),y.length!==r.length)return{v:void 0};if(o&&o.numberOfItems)switch(n){case"getLine":t=D.getPolyline(C.applyTransforms(o,function(e){return[{x:e[0],y:e[1]},{x:e[2],y:e[4]}]}(y),A(e.element)));break;case"getRect":t=D.getPolygon(C.applyTransforms(o,function(e){var t=e[0],a=e[1],n=e[2],r=e[3];return[{x:n,y:r},{x:n+t,y:r},{x:n+t,y:r+a},{x:n,y:r+a}]}(y),A(e.element)))}void 0===t&&(t=D[n].apply(null,y)),l.push({time:i,value:t})};var u=a.entries(),c=Array.isArray(u),f=0;e:for(u=c?u:u[Symbol.iterator]();;){var v,b=i();switch(b){case"break":break e;default:if("object"===t(b))return b.v}}return l}function Q(e,t,a){for(var n=new Map,r=Array.isArray(o=e),s=0,o=r?o:o[Symbol.iterator]();;){var l;if(r){if(s>=o.length)break;l=o[s++]}else{if((s=o.next()).done)break;l=s.value}var i=l,u=new Map;for(var c in t){var h=t[c].get(i);h&&u.set(c,h.value)}if(a)for(var f in a)!u.has(f)&&i>=a[f].time&&u.set(f,a[f].value);n.set(i,u)}return n}var J=function(){function e(t){if(r(this,e),this.element=t,this.name=C.setName(t),this.animate=this.animatable?e.toAnimateList(t):[],this.visible=R(t),this.drawable){var a=new D(t);a.d&&"none"!==a.d&&(this.path=a)}}return o(e,[{key:"synchronizePath",value:function(){var e=this.path;if(e&&this.animate.length){for(var t=this.element.tagName,a=[],n=Array.isArray(s=this.animate),r=0,s=n?s:s[Symbol.iterator]();;){var o;if(n){if(r>=s.length)break;o=s[r++]}else{if((r=s.next()).done)break;o=r.value}var l=o;if(l instanceof P&&l.keyTimes.length>1&&l.duration>0)switch(l.attributeName){case"r":case"cx":case"cy":if("circle"===t){a.push(l);break}case"rx":case"ry":"ellipse"===t&&a.push(l);break;case"x1":case"x2":case"y1":case"y2":"line"===t&&a.push(l);break;case"x":case"y":case"width":case"height":"rect"===t&&a.push(l)}}if(a.length>1||a.some(function(e){return e.begin.length>1})){var i={},u={},c={},v=[],b=[],y={},p=[],g=0,d=0;if(a.forEach(function(e){var t=e.attributeName;if(void 0===i[t]&&void 0===y[t]&&e.begin.length){var a=-1;if(-1===e.repeatCount){c[t]=new Map;for(var n=0;n<e.keyTimes.length;n++)c[t].set(e.keyTimes[n]*e.duration,{begin:0,duration:e.duration,value:parseFloat(e.values[n])});if(e.begin.some(function(e){return e>0})){i[t]=new Map;for(var r=0;r<e.begin.length;r++)for(var s=e.begin[r],o=void 0!==e.begin[r+1]?e.begin[r+1]:Number.MAX_VALUE,l=0;l<e.keyTimes.length;l++){var h=s+e.keyTimes[l]*e.duration;if(h>=o){var f=U(i[t],r,s,e.duration,e.keyTimes,e.values,o,!0);-1!==f&&(a=f);break}h>a&&(i[t].set(h,{begin:s,duration:e.duration,value:parseFloat(e.values[l])}),a=h)}}v.push(e)}else{var p=!1,g=!1;void 0===u[t]?u[t]=new Map:(a=W.maxArray(Array.from(u[t].keys())),p=!0);for(var d=0;d<e.begin.length;d++){var k=e.begin[d],A=void 0!==e.begin[d+1]?e.begin[d+1]:Number.MAX_VALUE,V=e.duration,x=e.repeatCount,S=V*x;if(k+S<=a)return;for(var w=Math.ceil(x),R=x-Math.floor(x),m=Math.floor(Math.max(0,a-k)/V);m<w;m++)for(var E=0;E<e.keyTimes.length;E++){var G=e.keyTimes[E],O=void 0,C=parseFloat(e.values[E]),N=!1;if(m===w-1&&R>0&&R>=G)for(var L=E+1;L<e.keyTimes.length;L++)if(R<e.keyTimes[L]){O=k+S,C=z(R,G,e.keyTimes[L],C,parseFloat(e.values[L])),N=!0;break}if(void 0===O)if((O=k+(G+m)*V)>=A&&(a=A,N=!0),p||N){if(!N&&k>=a)O=Math.max(k,a+1);else{if(!N&&O<a)continue;if(N||O!==a){var I=U(u[t],m,k,V,e.keyTimes,e.values,a,N);if(-1!==I&&(a=I,g=!0),N)break}else O=a+1}p=!1}else m>0&&0===E&&(O=Math.max(O,a+1));if(O>a&&(u[t].set(O,{begin:k,duration:V,value:C}),a=O,g=!0),N)break}}if(g){if(e.fillFreeze){var P=u[t].get(a);P&&(y[t]={time:a,value:P.value})}b.push(e)}}}}),b.length){for(var k in i)void 0===u[k]&&(u[k]=i[k],i[k]=void 0);var A=[];for(var x in u)A.push.apply(A,f(u[x].keys()));var S=W.maxArray(A);for(var w in u){var R=u[w],m=W.maxArray(Array.from(R.keys())),E=!1;if(i[w]){var G=i[w];if(m>=Array.from(G.keys())[0]){var O=G.entries(),C=Array.isArray(O),N=0;for(O=C?O:O[Symbol.iterator]();;){var L;if(C){if(N>=O.length)break;L=O[N++]}else{if((N=O.next()).done)break;L=N.value}var I=h(L,2),F=I[0],M=I[1];F+=R.has(F)?1:0,R.set(F,{value:M.value})}E=!0}else{var X=!1,B=G.entries(),q=Array.isArray(B),Y=0;for(B=q?B:B[Symbol.iterator]();;){var D;if(q){if(Y>=B.length)break;D=B[Y++]}else{if((Y=B.next()).done)break;D=Y.value}var J=h(D,2);M=J[1];if((F=J[0])>=m){if(!X){var K=m+1;F===m?F=K:H(G,R,K)&&A.push(K),X=!0}R.set(F,{value:M.value}),A.push(F),m=F,E=!0}}}}if(c[w]&&m<S){var $=m;do{var T=-1,_=c[w].entries(),ee=Array.isArray(_),te=0;for(_=ee?_:_[Symbol.iterator]();;){var ae;if(ee){if(te>=_.length)break;ae=_[te++]}else{if((te=_.next()).done)break;ae=te.value}var ne=h(ae,2);M=ne[1];T=$+(F=ne[0]),T+=R.has(T)?1:0,R.set(T,M),A.push(T)}$=T}while($<S);E=!0}E||void 0!==i[w]||void 0!==y[w]||null===e.baseVal[w]||R.set(m+1,{value:e.baseVal[w]})}var re=Array.from(new Set(A)).sort(function(e,t){return e<t?-1:1}),se={};for(var oe in u){for(var le=u[oe],ie=new Map,ue=Array.from(le.keys()).pop(),ce=1;ce<re.length;ce++){var he=re[ce];if(he<=ue){var fe=le.get(he);void 0===fe?H(le,ie,he):ie.set(he,fe)}}se[oe]=ie}g=re[re.length-1],p.push(Z(Q(re,se,y),g))}if(v.length){d=V(v.map(function(e){return e.duration}));var ve={},be=[];for(var ye in c){ve[ye]=new Map;var pe=0,ge=0;do{var de=c[ye].entries(),ke=Array.isArray(de),Ae=0;for(de=ke?de:de[Symbol.iterator]();;){var Ve;if(ke){if(Ae>=de.length)break;Ve=de[Ae++]}else{if((Ae=de.next()).done)break;Ve=Ae.value}var xe=h(Ve,2);F=xe[0];ve[ye].set(F+=(M=xe[1]).duration*ge,{value:M.value}),be.push(F),pe=F}ge++}while(pe<d)}for(var Se in be=Array.from(new Set(be)).sort(function(e,t){return e<t?-1:1}),ve)for(var we=ve[Se],Re=1;Re<be.length;Re++){var me=be[Re];we.has(me)||H(we,we,me)}p.push(Z(Q(be,ve),be[be.length-1]))}if(p.length){this.animate=this.animate.filter(function(e){return!a.includes(e)});for(var Ee=0;Ee<p.length;Ee++){var Ge=p[Ee],Oe=0===g||Ee>0?y:void 0,Ce=void 0;switch(t){case"circle":Ce=j(e,Ge,"getCircle",["cx","cy","r"],Oe);break;case"ellipse":Ce=j(e,Ge,"getEllipse",["cx","cy","rx","ry"],Oe);break;case"line":Ce=j(e,Ge,"getLine",["x1","y1","x2","y2"],Oe,this.transform);break;case"rect":Ce=j(e,Ge,"getRect",["width","height","x","y"],Oe,this.transform)}if(Ce){var Ne=0===Ee&&g>0,Le=new P(Ne?b[0].element:v[0].element,this.element);Le.attributeName="d",Ne?(Le.begin=[0],Le.duration=g,Le.repeatCount=0):(Le.begin=[g],Le.duration=d,Le.repeatCount=-1),Le.end.length=0,Le.keyTimes=Ce.map(function(e){return e.time}),Le.values=Ce.map(function(e){return""+e.value}),Le.from=Le.values[0],Le.to=Le.values[Le.values.length-1],Le.by="",this.animate.push(Le)}}}}}}},{key:"transform",get:function(){return this.element.transform.baseVal}},{key:"drawable",get:function(){return!0}},{key:"animatable",get:function(){return!0}},{key:"transformable",get:function(){return this.transform.numberOfItems>0}}],[{key:"toAnimateList",value:function(e){for(var t=[],a=0;a<e.children.length;a++){var n=e.children[a];n instanceof SVGAnimateTransformElement?t.push(new X(n,e)):n instanceof SVGAnimateMotionElement?t.push(new M(n,e)):n instanceof SVGAnimateElement?t.push(new P(n,e)):n instanceof SVGAnimationElement&&t.push(new L(n,e))}return t}}]),e}(),K=function(e){function t(e){var a;return r(this,t),(a=c(this,i(t).call(this))).element=e,a.visible=!0,a.name=C.setName(e),a.animate=a.animatable?J.toAnimateList(e):[],a.visible=R(e),a}return l(t,squared.lib.base.Container),o(t,[{key:"transform",get:function(){return this.element.transform.baseVal}},{key:"animatable",get:function(){return this.element instanceof SVGGElement}},{key:"transformable",get:function(){return this.element instanceof SVGGElement&&this.element.transform.baseVal.numberOfItems>0}}]),t}(),$=function(e){function t(e){var a;return r(this,t),(a=c(this,i(t).call(this,e))).element=e,a.x=e.x.baseVal.value,a.y=e.y.baseVal.value,a.width=e.width.baseVal.value,a.height=e.height.baseVal.value,a}return l(t,K),o(t,[{key:"animatable",get:function(){return!0}},{key:"transformable",get:function(){return this.transform.numberOfItems>0}}]),t}(),T=squared.lib.util,_=function(e){function t(e){var a;return r(this,t),(a=c(this,i(t).call(this,e))).element=e,a.uri="",a.x=e.x.baseVal.value,a.y=e.y.baseVal.value,a.width=e.width.baseVal.value,a.height=e.height.baseVal.value,a.uri=T.resolvePath(e.href.baseVal),a}return l(t,J),o(t,[{key:"externalize",value:function(){var e=this.element.transform.baseVal;if(e.numberOfItems){for(var t=this.x,a=this.y,n=e.numberOfItems-1;n>=0;n--){var r=e.getItem(n),s=r.matrix;switch(r.type){case SVGTransform.SVG_TRANSFORM_TRANSLATE:t+=s.e,a+=s.f;break;case SVGTransform.SVG_TRANSFORM_SCALE:t*=s.a,a*=s.d,this.width*=s.a,this.height*=s.d;break;case SVGTransform.SVG_TRANSFORM_ROTATE:t=x(s,t,t),a=S(s,a,a),s.a<0&&(t+=s.a*this.width),s.c<0&&(t+=s.c*this.width),s.b<0&&(a+=s.b*this.height),s.d<0&&(a+=s.d*this.height)}}this.x=t,this.y=a}}},{key:"drawable",get:function(){return!1}}]),t}(),ee=function(e){function t(e,a){var n;return r(this,t),(n=c(this,i(t).call(this,e))).element=e,a&&n.setPath(a),n}return l(t,$),o(t,[{key:"setPath",value:function(e){this.path=new D(this.element,e)}}]),t}(),te=squared.lib.dom,ae={util:m};e.Svg=function(e){function t(e){var a;return r(this,t),(a=c(this,i(t).call(this))).element=e,a.animatable=!0,a.transformable=!1,a.defs={clipPath:new Map,gradient:new Map},a._width=0,a._height=0,a._viewBoxWidth=0,a._viewBoxHeight=0,a._opacity=1,a.name=C.setName(e),a.animate=J.toAnimateList(e),a.visible=R(e),a.init(),a}return l(t,squared.lib.base.Container),o(t,[{key:"setDimensions",value:function(e,t){this._width=e,this._height=t}},{key:"setViewBox",value:function(e,t){this._viewBoxWidth=e,this._viewBoxHeight=t}},{key:"setOpacity",value:function(e){this._opacity=!isNaN(e=parseFloat(""+e))&&e<1?e:1}},{key:"init",value:function(){var e=this,t=this.element;if(this.setViewBox(t.viewBox.baseVal.width,t.viewBox.baseVal.height),this.setOpacity(te.cssAttribute(t,"opacity")),this.setDimensions(t.width.baseVal.value,t.height.baseVal.value),te.isUserAgent(16)){var a=t.getBoundingClientRect();a.width>this.width&&a.height>this.height&&this.setDimensions(a.width,a.height)}t.querySelectorAll("clipPath, linearGradient, radialGradient").forEach(function(t){if(t.id)if(t instanceof SVGClipPathElement){for(var a=new K(t),n=Array.from(t.children),r=0;r<n.length;r++){var s=n[r];if(d(s)){var o=new J(s);o.path&&a.append(o)}}a.length&&e.defs.clipPath.set(t.id,a)}else t instanceof SVGLinearGradientElement?e.defs.gradient.set("@".concat(t.id),{type:"linear",x1:t.x1.baseVal.value,x2:t.x2.baseVal.value,y1:t.y1.baseVal.value,y2:t.y2.baseVal.value,x1AsString:t.x1.baseVal.valueAsString,x2AsString:t.x2.baseVal.valueAsString,y1AsString:t.y1.baseVal.valueAsString,y2AsString:t.y2.baseVal.valueAsString,colorStop:C.createColorStops(t)}):t instanceof SVGRadialGradientElement&&e.defs.gradient.set("@".concat(t.id),{type:"radial",cx:t.cx.baseVal.value,cy:t.cy.baseVal.value,r:t.r.baseVal.value,cxAsString:t.cx.baseVal.valueAsString,cyAsString:t.cy.baseVal.valueAsString,rAsString:t.r.baseVal.valueAsString,fx:t.fx.baseVal.value,fy:t.fy.baseVal.value,fxAsString:t.fx.baseVal.valueAsString,fyAsString:t.fy.baseVal.valueAsString,colorStop:C.createColorStops(t)})});var n,r=new Map;function s(e){var t;d(e)?(t=new J(e),e.id&&t.path&&r.set("#".concat(e.id),t.path.d)):k(e)&&(t=new _(e)),n&&t&&n.append(t)}for(var o=0;o<t.children.length;o++){var l=t.children[o];if(l instanceof SVGSVGElement)n=new $(l),this.append(n);else if(l instanceof SVGGElement)n=new K(l),this.append(n);else{if(!(l instanceof SVGUseElement)){void 0===n&&(n=new K(t),this.append(n)),s(l);continue}n=new ee(l),this.append(n)}for(var i=0;i<l.children.length;i++)s(l.children[i]);n=void 0}this.each(function(e){if(e instanceof ee){var t=r.get(e.element.href.baseVal);t&&e.setPath(t)}}),this.retain(this.filter(function(e){return e.length>0||e instanceof ee&&void 0!==e.path}))}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"viewBoxWidth",get:function(){return this._viewBoxWidth}},{key:"viewBoxHeight",get:function(){return this._viewBoxHeight}},{key:"opacity",get:function(){return this._opacity}},{key:"transform",get:function(){return this.element.transform.baseVal}}]),t}(),e.SvgAnimate=P,e.SvgAnimateMotion=M,e.SvgAnimateTransform=X,e.SvgAnimation=L,e.SvgBuild=C,e.SvgElement=J,e.SvgGroup=K,e.SvgGroupViewBox=$,e.SvgImage=_,e.SvgPath=D,e.SvgUse=ee,e.lib=ae,Object.defineProperty(e,"__esModule",{value:!0})});
